var base_url='https://www.emailmeform.com/builder/';var site_url='https://www.emailmeform.com/builder';var assets_url='//assets.emailmeform.com/';function get_assets_url(uri){return assets_url+uri;};var internal_base_url='https://assets.emailmeform.com/builder/';var external_base_url='https://www.emailmeform.com/builder';var EMF_jQuery=jQuery;function apply_rules(){for(key in emf_group_to_field_rules_map){var field_rules=emf_group_to_field_rules_map[key];do_action(field_rules[0],eval_conditions(field_rules));}
for(key in emf_group_to_page_rules_for_confirmation_map){var page_rules=emf_group_to_page_rules_for_confirmation_map[key];toggle_captcha(eval_conditions(page_rules));}}
function eval_conditions(field_rules){var exp="";for(var i=0;i<field_rules.length;i++){if(i>0){exp+=field_rules[i]["AndOr"]=="1"?"&&":"||";}
exp+=eval_condition(field_rules[i])?"true":"false";}
return eval(exp);}
function eval_condition(field_rule){var result=false;var index=field_rule['ConditionFieldIndex'];var is_field_in_current_page=index>=emf_page_info.page_element_index_min&&index<=emf_page_info.page_element_index_max;var condition_field_value=null;if(is_field_in_current_page){var condition_field_get_value_js=emf_widgets[field_rule['ConditionFieldWidgetName']];if(condition_field_get_value_js){condition_field_value=condition_field_get_value_js(index);}}else{if(emf_index_to_value_map!=null){condition_field_value=emf_index_to_value_map[index];}}
var func=emf_condition_id_to_js_map[field_rule['Operation']];if(func){result=func(get_null_safe_string(condition_field_value),get_null_safe_string(field_rule['Value']));}
return result;}
function toggle_emf_element(element_obj,visible,switch_name){toggle_element_with_validation(element_obj,visible,switch_name);if(EMF_price.payment_enabled){EMF_price.calc_price_fields();}
post_message_for_frame_height(emf_form_visit_id);}
function do_action(field_rule,condition_result){var visible=(field_rule['ResultAction']=='1')==condition_result;var element_obj=$("#emf-li-"+field_rule['ResultContentIndex']);toggle_emf_element(element_obj,visible,'whole_element');}
function delete_file(element_name,hide_block){if(confirm("Do you really want delete this file?")){hide_block.hide();$('#'+element_name).show().attr('disabled',false).attr('class',$('#'+element_name).attr('temp_class'));}}
var emf_captcha_visible_by_rules=true;function toggle_captcha(visible){toggle_emf_element($('#emf-li-captcha, #emf-li-recaptcha'),visible);emf_captcha_visible_by_rules=visible;post_message_for_frame_height(emf_form_visit_id);}
function init_rules(){$(':input',$('#emf-form')).change(apply_rules);apply_rules();}
function do_smart_captcha(form_id){$('#emf-form').append("<input type='hidden' name='javascript_executed' value='true'>");$.ajax({url:get_external_site_url('forms/if_show_smart_captcha'),dataType:'jsonp',data:{form_id:form_id},success:function(response){var show_captcha=response;toggle_captcha(emf_captcha_visible_by_rules&&show_captcha);},error:function(XMLHttpRequest,textStatus,errorThrown){}});}
function set_readonly(message){$('#emf-form :input').attr("disabled","disabled");$("#emf-form").children().first().before("<div style='color:red;font-weight:bold;'>"+message+"</div>");}
function SessionTimeoutWarner(timeout_interval_in_seconds){var confirm_timer=null;var alert_timer=null;var self=this;this.show_confirm_dialog=function(){show_confirm_dialog("Session is about to timeout","Do you want to extend it and continue completing the form?",function(event){$.ajax({url:get_external_site_url('forms/keep_session_alive'),dataType:'jsonp',success:function(data){get_dialog(event.target).dialog("close");self.set_timers();},error:function(){alert('Extend session timeout error.')}})},null,{hide_close_button:true})};this.show_alert_dialog=function(){close_all_dialogs();show_alert("Your session is about to timeout","Please reload the page and start over.",{hide_close_button:true});};this.set_timers=function(){var confirm_timeout=Math.floor(timeout_interval_in_seconds*1000*0.95);var alert_timeout=timeout_interval_in_seconds*1000;clearTimeout(confirm_timer);clearTimeout(alert_timer);confirm_timer=setTimeout(this.show_confirm_dialog,confirm_timeout);alert_timer=setTimeout(this.show_alert_dialog,alert_timeout);}}
function is_cookie_disabled(){var name="emf_test_cookie";var value="OK";set_cookie(name,value);var result=get_cookie(name)!=value;set_cookie(name,"",-1);return result;}
function force_session_for_submit_form(){if(get_g_emf_session_id()){var url=$('#emf-form').attr('action');var parts=url.split('#');if(parts.length>0){parts[0]+="?PHPSESSID="+get_g_emf_session_id();}
var dest_url=parts.join('#');$('#emf-form').attr('action',dest_url);}}
function enable_session_when_cookie_disabled(){window['g_emf_session_id']='';if(is_cookie_disabled()){if(is_empty_str(get_url_parameter('PHPSESSID'))){$.ajax({url:get_external_site_url('forms/get_session_id'),dataType:'jsonp',data:{dummy:'dummy'},success:function(response){window['g_emf_session_id']=response;$('#captcha_image').css('visibility','hidden');$('#captcha_image').attr("src",$('#captcha_image').attr("src")+"?PHPSESSID="+g_emf_session_id);force_session_for_submit_form();},error:function(XMLHttpRequest,textStatus,errorThrown){alert('get_session_id error: '+textStatus+"\n"+errorThrown);}});}else{window['g_emf_session_id']=get_url_parameter('PHPSESSID');force_session_for_submit_form();}}}
var EMF_price={set_price_field:function(idx,fld_type){var field_options_map=EMF_price.price_fld_info.price_list;var fld_opt=null;if(field_options_map&&field_options_map['idx_'+idx]){fld_opt=field_options_map['idx_'+idx];}else{return false;}
var price=0.00;var fld_label=null;if(fld_type==EMF_price.FORM_FIELD_TYPE_DROPDOWN){var opt_idx=get_jquery_property($("#element_"+idx+":not([disabled])"),"selectedIndex");if(opt_idx>=0){if(fld_opt['fld_price_options']){price=fld_opt['fld_price_options']['opt_'+opt_idx];}
if(fld_opt['fld_defined_options']['opt_'+opt_idx]){fld_label=fld_opt['fld_defined_options']['opt_'+opt_idx]['option'];}}}else if(fld_type==EMF_price.FORM_FIELD_TYPE_MULTIPLE_CHOICE){var options=fld_opt['fld_price_options'];if(options){EMF_jQuery.each(options,function(opt_key,opt_price){var opt_idx=opt_key.split("_")[1];if(EMF_jQuery("#element_"+idx+"_"+opt_idx+":not([disabled])").is(":checked")){var is_other=parseInt(fld_opt['fld_defined_options']['opt_'+opt_idx]["is_other"],10);if(is_other==1){price=EMF_jQuery("input[name=element_"+idx+"_other]").val();fld_label=fld_opt['fld_defined_options']['opt_'+opt_idx]['option'];}else{price=opt_price;fld_label=fld_opt['fld_defined_options']['opt_'+opt_idx]['option'];}}});}}else if(fld_type==EMF_price.FORM_FIELD_TYPE_PRICE){var as_negative=typeof(fld_opt['fld_defined_options']['opt_0']['custom']['2'])!='undefined'&&fld_opt['fld_defined_options']['opt_0']['custom']['2']=='1';var price1=EMF_jQuery("#element_"+idx+"_1:not([disabled])").val();var price2=EMF_jQuery("#element_"+idx+"_2:not([disabled])").val();price=price1;if(price==""||isNaN(parseInt(price,10))){price="0";}
if(price2==""||isNaN(parseInt(price2,10))){price+=".00";}else{price+="."+price2;}
if(as_negative){price="-"+price;}}
var float_price=parseFloat(price);fld_opt['price']=float_price;if(fld_label!=null){fld_opt['fld_name']=fld_label;}},format_price:function(currency,price){var str=currency+new Number(Math.abs(price)).toFixed(2);if(price<0){str="<span style='color:#ee0000;white-space:nowrap;'>-"+str+"</span>";}
return str;},get_item_label:function(val){return val['fld_name'];},calc_price_fields:function(){var currency=EMF_price.price_fld_info['currency'];var fixed_price=EMF_price.price_fld_info['fixed_price'];var total_items=EMF_jQuery("#f"+EMF_price.form_id+"_total_items");total_items.html("");if(fixed_price!=0.0){total_items.append("<tr><th>"+EMF_price.price_fld_info['fixed_price_label']+"</th><td>"+EMF_price.format_price(currency,fixed_price)+"</td></tr>");}
var price_list=EMF_price.price_fld_info['price_list'];var totalPrice=fixed_price;if(emf_cart==null){emf_cart=new Array();}
if(price_list){var items_in_page=new Array();EMF_jQuery.each(price_list,function(){var val=this;var fld_type=val["fld_type"];var idx=val['idx'];if(idx<=emf_page_info.page_element_index_max&&idx>=emf_page_info.page_element_index_min){var label=null;var price=null;if(fld_type==EMF_price.FORM_FIELD_TYPE_CHECKBOX||fld_type==EMF_price.FORM_FIELD_TYPE_DEPRECATED_CHECKBOX){var fld_opt=EMF_price.price_fld_info['price_list']['idx_'+idx];$("input[name='element_"+idx+"[]']:checked:not([disabled])").each(function(){var id=$(this).attr("id");var opt_idx=id.split("_")[2];var fld_label=fld_opt['fld_defined_options']['opt_'+opt_idx]['option'];var price=fld_opt['fld_price_options']['opt_'+opt_idx];if(price==null||price==''){price=0.0;}
var float_price=parseFloat(price);var cart_item=new Object();cart_item['label']=fld_label;cart_item['price']=float_price;items_in_page.push(cart_item);});}else{EMF_price.set_price_field(idx,fld_type);var float_price=val['price'];if(float_price!=0.0){var cart_item=new Object();cart_item['label']=EMF_price.get_item_label(val);cart_item['price']=float_price;items_in_page.push(cart_item);}}}});for(var i=0;i<emf_page_info.current_page_index;i++){if(emf_cart[i]===undefined)
emf_cart[i]=null;}
emf_cart[emf_page_info.current_page_index]=items_in_page;}
$.each(emf_cart,function(index,items_in_page){if(items_in_page){$.each(items_in_page,function(index,item){if(typeof(item['label'])!='undefined'){total_items.append("<tr><th>"+item['label']+"</th><td>"+EMF_price.format_price(currency,item['price'])+"</td></tr>");totalPrice+=item['price'];}});}});EMF_jQuery("#f"+EMF_price.form_id+"_total_price").html(EMF_price.format_price(currency,totalPrice));set_form_hidden_field($("#emf-form"),"emf_cart",JSON.stringify(emf_cart));if(totalPrice<0){EMF_jQuery("#f"+EMF_price.form_id+"_price_error").html("NOTICE: You can't pay negative price.");}else{EMF_jQuery("#f"+EMF_price.form_id+"_price_error").html("");}
if(EMF_price.tax_enable&&totalPrice>0&&EMF_jQuery(EMF_price.address_field_ctrl_for_tax).val()!=''){var tax=0;var state=EMF_jQuery(EMF_price.address_field_ctrl_for_tax).val();if(EMF_price.sale_tax_rate_list['states_map'][state]){state=EMF_price.sale_tax_rate_list['states_map'][state];}
var rate=0;if(EMF_price.sale_tax_rate_list['states_rate'][state]){rate=parseFloat(EMF_price.sale_tax_rate_list['states_rate'][state]);tax=totalPrice*rate;}
tax=EMF_price.format_price(currency,tax);total_items.append("<tr><th>Sales Tax "+state+" "+(new Number(Math.abs(rate)*100).toFixed(2))+"%</th><td>"+tax+"</td></tr>");}
post_message_for_frame_height(emf_form_visit_id);}};function insert_obj_before_captcha_button(obj){$insertion_points=["#emf-li-recaptcha, #emf-li-captcha",".emf-li-field.emf-field-page_break","#emf-li-post-button"];$.each($insertion_points,function(index,item){if(EMF_jQuery(item).size()>0){EMF_jQuery(item).before(obj);return false;}});}
function init_payment(running_total_position){EMF_price.payment_enabled=true;if(running_total_position=='float_right'){var insertion_point=$("#emf-form ul");insertion_point.prepend("<li id='emf-li-total'></li>");$("#emf-li-total").prepend(EMF_jQuery(".emf-total"));$('#emf-form').addClass('emf-total-float-right');}else{var total_obj=EMF_jQuery("<li id='emf-li-total'></li>").prepend(EMF_jQuery(".emf-total"));insert_obj_before_captcha_button(total_obj);}
EMF_jQuery("div.emf-total").show();if(EMF_price.price_fld_info){EMF_price.calc_price_fields();var price_list=EMF_price.price_fld_info['price_list'];if(price_list){EMF_jQuery.each(price_list,function(idx,val){var fld_type=val["fld_type"];var price_fld_idx=val["idx"];if(fld_type==EMF_price.FORM_FIELD_TYPE_DROPDOWN){EMF_jQuery("#element_"+price_fld_idx).change(function(){EMF_price.calc_price_fields();});}else if(fld_type==EMF_price.FORM_FIELD_TYPE_MULTIPLE_CHOICE){EMF_jQuery("input[name=element_"+price_fld_idx+"]").click(function(){EMF_price.calc_price_fields();});if(val["fld_defined_options"]){EMF_jQuery.each(val["fld_defined_options"],function(opt_key,opt_val){var is_other=parseInt(opt_val['is_other'],10);if(is_other==1){EMF_jQuery("input[name=element_"+price_fld_idx+"_other]").change(function(){EMF_price.calc_price_fields();});}});}}else if(fld_type==EMF_price.FORM_FIELD_TYPE_CHECKBOX||fld_type==EMF_price.FORM_FIELD_TYPE_DEPRECATED_CHECKBOX){EMF_jQuery("input[name='element_"+price_fld_idx+"[]']").change(function(){EMF_price.calc_price_fields();});}else if(fld_type==EMF_price.FORM_FIELD_TYPE_PRICE){EMF_jQuery("#element_"+price_fld_idx+"_1,#element_"+price_fld_idx+"_2").blur(function(){EMF_price.calc_price_fields();});}});}}
EMF_jQuery(EMF_price.address_field_ctrl_for_tax).blur(function(){EMF_price.calc_price_fields();})
if(running_total_position=='float_right'){freeze_width($("#emf-li-total"));$("#emf-form ul").css('min-height',($(".emf-total").outerHeight()+35)+"px");$("#emf-li-total").stickyPanel({topPadding:10,savePanelSpace:true});}
function freeze_width(obj){obj.css('width',obj.width());obj.children().each(function(){freeze_width($(this));});}}
function detect_unsupported_browser(){$.ajax({url:get_external_site_url('forms/detect_unsupported_browser'),dataType:'jsonp',data:{dummy:'dummy'},success:function(response){var message=response;if(message){var message_container=$('#message_container, .emf-error-message');message_container.html(message+"<BR>"+message_container.html()).show();}}});}
function generate_css_for_emf_ad(){var url=$.url();var visible=(url.param('show_ad')||url.segment(2)!='embed');$('head').append('<style>#emf_advertisement{display:'+(visible?'block':'none')+'}</style>');}
function bind_event_for_check_sum(field_obj){EMF_jQuery('input[type=text]',field_obj).change(function(){var total=0;EMF_jQuery('input[type=text]',field_obj).each(function(){if(!isNaN(this.value)){var value=parseFloat(this.value);if(!isNaN(value)){total+=value;}}});EMF_jQuery('.emf-check-sum-indicator',field_obj).html(total);}).change();}
function calculate_score(){var result=g_emf_base_score;if(typeof emf_index_to_option_map!='undefined'){for(var index in emf_index_to_option_map){var value_score_map=emf_index_to_option_map[index];var value_arr=get_form_element_value_arr(null,$("#emf-li-"+index));$.each(value_arr,function(){if(value_score_map[this]!=null){var score=parseFloat(value_score_map[this]);if(!isNaN(score)){result+=score;}};})}}
$('.emf-score-value').html(result.toFixed(2));}
var g_emf_base_score=0;function init_for_calculate_score(base_score,customize_score_title,score_title){g_emf_base_score=base_score;var title=customize_score_title=="1"?score_title:g_emf_resources['js_score'];if(title==null){title="";}
var content="<li id=\"emf-score\">"+title+": <span class=\"emf-score-value\"></span>";insert_obj_before_captcha_button(EMF_jQuery(content));EMF_jQuery(':input',EMF_jQuery('#emf-form')).change(function(){calculate_score();});calculate_score();}
function randomize_field_content(){$('select[my_choice_order_type=random], div[my_choice_order_type=random]').each(function(){randomize_children($(this));});$('.emf-field-list[my_statement_order_type=random], .emf-field-grid[my_statement_order_type=random]').each(function(){randomize_table_rows($(this));});$('.emf-field-grid[my_choice_order_type=random]').each(function(){randomize_table_columns($(this));});}
function toggle_emf_pages(){var target=$('.emf-page-item:not(.emf-selected)');var toggler=$('.emf-steps-toggler');var status=toggler.attr('my_status');var OPENED='opened';var CLOSED='closed';var VISIBLE_CLASS='emf-page-item-visible-on-narrow-screen';if(is_empty_str(status)){status="closed";}
if(status==CLOSED){target.addClass(VISIBLE_CLASS);toggler.html('▼');toggler.attr('my_status',OPENED);}else{target.removeClass(VISIBLE_CLASS);toggler.html('▶');toggler.attr('my_status',CLOSED);}}
function localize_datepicker(){if(!g_emf_resources['js_calendar_prev']){return;}
var monthNames=[];var monthNamesShort=[];for(var i=0;i<12;i++){monthNames.push(g_emf_resources['js_calendar_month'+(i+1)]);monthNamesShort.push(g_emf_resources['js_calendar_month'+(i+1)+'_short']);}
var dayNames=[];var dayNamesShort=[];var dayNamesMin=[];for(var i=0;i<7;i++){dayNames.push(g_emf_resources['js_calendar_weekday'+(i+1)]);dayNamesShort.push(g_emf_resources['js_calendar_weekday'+(i+1)+'_short']);dayNamesMin.push(g_emf_resources['js_calendar_weekday'+(i+1)+'_min']);}
$.datepicker.regional['custom']={closeText:g_emf_resources['js_calendar_close'],prevText:g_emf_resources['js_calendar_prev'],nextText:g_emf_resources['js_calendar_next'],currentText:g_emf_resources['js_calendar_current'],monthNames:monthNames,monthNamesShort:monthNamesShort,dayNames:dayNames,dayNamesShort:dayNamesShort,dayNamesMin:dayNamesMin,weekHeader:g_emf_resources['js_calendar_week'],yearSuffix:g_emf_resources['js_calendar_year']};$.datepicker.setDefaults($.datepicker.regional['custom']);}
function build_datepicker(){EMF_jQuery('.datepicker').each(function(){var item=$(this);item.datepicker({yearRange:'-120:+20',showOn:'button',buttonImage:get_assets_url('images/calendar.png'),buttonImageOnly:true,onSelect:function(dateText,inst){var parts=parse_selected_date(dateText);EMF_jQuery('#'+inst.id+'year').val(parts['year']);EMF_jQuery('#'+inst.id+'year-mm').val(parts['month']);EMF_jQuery('#'+inst.id+'year-dd').val(parts['day']);EMF_jQuery('.'+inst.id+'yearformError').remove();EMF_jQuery('.'+inst.id+'year-mmformError').remove();EMF_jQuery('.'+inst.id+'year-ddformError').remove();EMF_jQuery('#'+inst.id+'year'+','+'#'+inst.id+'year-mm'+','+'#'+inst.id+'year-dd').change();},changeMonth:true,changeYear:true});var my_date_format=item.attr('my_date_format');if(!is_empty_str(my_date_format)){item.datepicker("option","dateFormat",my_date_format);}})
localize_datepicker();}
function locate_hidden_input_for_fancy_field(field_obj){var input_obj=$('input',field_obj);var target_ui_obj=$('.emf-signature',field_obj);input_obj.css({'position':'absolute'});input_obj.css('left',target_ui_obj.position().left);input_obj.css('top',target_ui_obj.position().top);input_obj.css('width',target_ui_obj.width());}
function toggle_signature(field_obj,if_display_existing_signature){toggle_element_with_validation($('.emf-existing-signature',field_obj),if_display_existing_signature,'signature');toggle_element_with_validation($('.emf-new-signature',field_obj),!if_display_existing_signature,'signature');locate_hidden_input_for_fancy_field(field_obj);}
function fix_dropdown_width_for_ie(){if(!$.browser.msie||$.browser.version>8){return;}
function fix_dropdown_ui(el){el.css("width","auto").css('max-width','none').css('position','absolute');el.next('.my_select_placeholder').show();}
function restore_dropdown_ui(el){el.css("width",el.data("my_origin_width")).css('max-width',el.data("my_origin_max_width")).css('position',el.data("my_origin_position"));el.next('.my_select_placeholder').hide();}
$("select").each(function(){var el=$(this);el.data("my_origin_width",el.outerWidth());el.data("my_origin_max_width",el.css('max_width'));el.data("my_origin_position",el.css('position'));el.data("my_dropdown_status","");$("<div class='my_select_placeholder' style='display:none'>").insertAfter(el).css("height",el.outerHeight()+"px");}).mouseenter(function(){var el=$(this);fix_dropdown_ui(el);}).bind("focus",function(){$(this).data("my_dropdown_status","editing");}).bind("blur",function(){var el=$(this);restore_dropdown_ui(el);el.data("my_dropdown_status","");}).bind("mouseout",function(){var el=$(this);if(el.data("my_dropdown_status")!="editing"){restore_dropdown_ui(el);}});}
function gather_referer_in_form(){var form=$('#emf-form');if($('input[name=http_referer]',form).length==0){form.append('<input type="hidden" name="http_referer">');$('input[name=http_referer]',form).val(document.referrer);}}
function check_document_height(callback,internal){if(internal==null){internal=500;}
var last_height=document.body.clientHeight;var new_height;var timer;(function run(){new_height=document.body.clientHeight;if(last_height!=new_height){callback();}
last_height=new_height;timer=setTimeout(run,internal);})();}
function fix_ios_safari_bug(){if(!$.browser.safari){return;}
check_document_height(function(){post_message_for_frame_height(emf_form_visit_id);});}
function get_validation_rule(caller){rulesParsing=$(caller).attr('class');rulesRegExp=/\[(.*)\]/;getRules=rulesRegExp.exec(rulesParsing);str=getRules[1];pattern=/\[|,|\]/;result=str.split(pattern);return result;}
function length_counter(control,type){var func=function(){var len=0;if(type==1){len=control.val().length;}else{len=count_words($(control).val());}
var rules=get_validation_rule(control);var start_length=null;var end_length=null;for(var i=0;i<rules.length;i++){if(rules[i]==(type==1?'length':'lengthWord')){start_length=eval(rules[i+1]);end_length=eval(rules[i+2]);}}
if(is_empty_str(start_length)&&is_empty_str(end_length)){return;}
var html=parse_resource_variables(get_resource_by_range("js_validation_length_range",start_length,end_length,len,g_emf_resources[type==1?'js_validation_length_unit_character':'js_validation_length_unit_word']),{current:len});var container=control.parents('.emf-li-field .emf-div-field');if($('.emf-div-instruction',container).length==0){container.append("<div class='emf-div-instruction'></div>");}
if($('.emf-div-instruction .counter',container).length==0){$('.emf-div-instruction',container).append("<div class='counter'><div>");}
$('.emf-div-instruction .counter',container).html(html);}
control.bind('keyup',func).bind('blur',func);func();}
function get_resource_by_range(resource_prefix,start_value,end_value,curr_value,unit_resource_key){var resource_key="";if(start_value!=null&&end_value==null){resource_key=resource_prefix+"_min";}else if(start_value==null&&end_value!=null){resource_key=resource_prefix+"_max";}else{resource_key=resource_prefix+"_min_max";}
var params={min:start_value,max:end_value,current:curr_value,length_unit:unit_resource_key};var result=parse_resource_variables(g_emf_resources[resource_key],params);return result;}
function get_base_url_by_form_action(){var action=$('#emf-form').attr('action');var reg=/http(s)?:\/\/[^\/]*\/[^\/]*\//g;var matches=reg.exec(action);var result=matches[0];if(!result){result=base_url;}
return result;}
$(function(){fix_dropdown_width_for_ie();fix_ios_safari_bug();gather_referer_in_form();});;(function($){$.fn.validationEngine=function(settings){if($.validationEngineLanguage){allRules=$.validationEngineLanguage.allRules;}else{$.validationEngine.debug("Validation engine rules are not loaded check your external file");}
settings=jQuery.extend({allrules:allRules,validationEventTriggers:"focusout",inlineValidation:true,returnIsValid:false,liveEvent:false,unbindEngine:true,ajaxSubmit:false,scroll:true,promptPosition:"topRight",success:false,beforeSuccess:function(){},failure:function(){}},settings);$.validationEngine.settings=settings;if(typeof($.validationEngine.ajaxValidArray)=="undefined")
$.validationEngine.ajaxValidArray=new Array();if(settings.inlineValidation==true){if(!settings.returnIsValid){allowReturnIsvalid=false;if(settings.liveEvent){$(this).find("[class*=validate][type!=checkbox]").live(settings.validationEventTriggers,function(caller){_inlinEvent(this);})
$(this).find("[class*=validate][type=checkbox]").live("click",function(caller){_inlinEvent(this);})}else{$(this).find("[class*=validate]").not("[type=checkbox]").bind(settings.validationEventTriggers,function(caller){_inlinEvent(this);})
$(this).find("[class*=validate][type=checkbox]").bind("click",function(caller){_inlinEvent(this);})}
firstvalid=false;}
function _inlinEvent(caller){$.validationEngine.settings=settings;if($.validationEngine.intercept==false||!$.validationEngine.intercept){$.validationEngine.onSubmitValid=false;$.validationEngine.loadValidation(caller);}else{$.validationEngine.intercept=false;}}}
if(settings.returnIsValid){if($.validationEngine.submitValidation(this,settings)){return false;}else{return true;}}
$(this).bind("submit",function(event){$.validationEngine.onSubmitValid=true;$.validationEngine.settings=settings;if($.validationEngine.submitValidation(this,settings)==false){if($.validationEngine.submitForm(this,settings)==true){event.stopImmediatePropagation();return false;}}else{settings.failure&&settings.failure();event.stopImmediatePropagation();return false;}})};var PROMPT_OPACITY=0.87;$.validationEngine={defaultSetting:function(caller){if($.validationEngineLanguage){allRules=$.validationEngineLanguage.allRules;}else{$.validationEngine.debug("Validation engine rules are not loaded check your external file");}
settings={allrules:allRules,validationEventTriggers:"blur",inlineValidation:true,returnIsValid:false,scroll:true,unbindEngine:true,ajaxSubmit:false,promptPosition:"topRight",success:false,failure:function(){}}
$.validationEngine.settings=settings;},loadValidation:function(caller){if(!$.validationEngine.settings){$.validationEngine.defaultSetting()}
rulesParsing=$(caller).attr('class');rulesRegExp=/\[(.*)\]/;getRules=rulesRegExp.exec(rulesParsing);str=getRules[1];pattern=/\[|,|\]/;result=str.split(pattern);var validateCalll=$.validationEngine.validateCall(caller,result)
return validateCalll;},validateCall:function(caller,rules){var promptTextArr=[];caller=caller;ajaxValidate=false;var callerName=$(caller).attr("name");$.validationEngine.isError=false;$.validationEngine.showTriangle=true;callerType=get_jquery_property(caller,"type");for(i=0;i<rules.length;i++){switch(rules[i]){case"optional":if(!$(caller).val()){$.validationEngine.closePrompt(caller);return $.validationEngine.isError;}
break;case"required":_required(caller,rules);break;case"custom":_customRegex(caller,rules,i);break;case"exemptString":_exemptString(caller,rules,i);break;case"ajax":if(!$.validationEngine.onSubmitValid){_ajax(caller,rules,i);};break;case"length":_length(caller,rules,i);break;case"lengthWord":_lengthWord(caller,rules,i);break;case"lengthValue":_lengthValue(caller,rules,i);break;case"integerAndDecimal":_integerAndDecimal(caller,rules,i);break;case"maxCheckbox":_maxCheckbox(caller,rules,i);groupname=$(caller).attr("name");caller=$("input[name='"+groupname+"']");break;case"minCheckbox":_minCheckbox(caller,rules,i);groupname=$(caller).attr("name");caller=$("input[name='"+groupname+"']");break;case"minSelect":_minSelect(caller,rules,i);break;case"confirm":_confirm(caller,rules,i);break;case"funcCall":_funcCall(caller,rules,i);break;default:;};};radioHack();var promptText=getPromptTextByArr(promptTextArr);if($.validationEngine.isError==true){linkTofield=$.validationEngine.linkTofield(caller);($("div."+linkTofield).size()==0)?$.validationEngine.buildPrompt(caller,promptText,"error"):$.validationEngine.updatePromptText(caller,promptText);$.validationEngine.updatePromptText(caller,promptText);}else{$.validationEngine.closePrompt(caller);}
function radioHack(){if($("input[name='"+callerName+"']").size()>1&&(callerType=="radio"||callerType=="checkbox")){caller=$("input[name='"+callerName+"'][type!=hidden]:first");$.validationEngine.showTriangle=true;}}
function getPromptTextByArr(promptTextArr){var result="";for(var i=0;i<promptTextArr.length;i++){if(!is_empty_str(promptTextArr)){result+="* "+promptTextArr[i]+"<BR>";}}
return result;}
function _required(caller,rules){callerType=get_jquery_property(caller,"type");if(callerType=="text"||callerType=="password"||callerType=="textarea"||callerType=="file"){if(!$(caller).val()){$.validationEngine.isError=true;promptTextArr.push($.validationEngine.settings.allrules[rules[i]].alertText);}}
if(callerType=="radio"||callerType=="checkbox"){callerName=$(caller).attr("name");if($("input[name='"+callerName+"']:checked").size()==0){$.validationEngine.isError=true;if($("input[name='"+callerName+"']").size()==1){promptTextArr.push($.validationEngine.settings.allrules[rules[i]].alertTextCheckbox);}else{promptTextArr.push($.validationEngine.settings.allrules[rules[i]].alertTextCheckboxMultiple);}}}
if(callerType=="select-one"){if(!$(caller).val()){$.validationEngine.isError=true;promptTextArr.push($.validationEngine.settings.allrules[rules[i]].alertText);}}
if(callerType=="select-multiple"){if(!$(caller).find("option:selected").val()){$.validationEngine.isError=true;promptTextArr.push($.validationEngine.settings.allrules[rules[i]].alertText);}}}
function _customRegex(caller,rules,position){customRule=rules[position+1];if(customRule&&$.validationEngine.settings.allrules[customRule]){pattern=eval($.validationEngine.settings.allrules[customRule].regex);if(!pattern.test($(caller).attr('value'))){$.validationEngine.isError=true;promptTextArr.push($.validationEngine.settings.allrules[customRule].alertText);}}}
function _exemptString(caller,rules,position){customString=rules[position+1];if(customString==$(caller).attr('value')){$.validationEngine.isError=true;promptTextArr.push($.validationEngine.settings.allrules['required'].alertText);}}
function _funcCall(caller,rules,position){customRule=rules[position+1];params=rules.slice(position+2);funce=$.validationEngine.settings.allrules[customRule].fname;var fn=window[funce];if(typeof(fn)==='function'){var fn_result=fn(caller,params);var is_error=false;var alert_text=$.validationEngine.settings.allrules[customRule].alertText;;if(typeof fn_result==='object'){is_error=fn_result['is_error'];if(fn_result['message']){alert_text=fn_result['message'];}}else{is_error=fn_result;}
if(is_error){$.validationEngine.isError=true;promptTextArr.push(alert_text);}}}
function _ajax(caller,rules,position){customAjaxRule=rules[position+1];postfile=$.validationEngine.settings.allrules[customAjaxRule].file;fieldValue=$(caller).val();ajaxCaller=caller;fieldId=$.validationEngine.getMandatoryId(caller);ajaxValidate=true;ajaxisError=$.validationEngine.isError;if($.validationEngine.settings.allrules[customAjaxRule].extraData){var tempExtraData=$.validationEngine.settings.allrules[customAjaxRule].extraData;if(tempExtraData instanceof Function){extraData=tempExtraData();}else{extraData=tempExtraData;}}else{extraData="";}
if(!ajaxisError){$.ajax({type:"POST",url:postfile,async:true,data:"validateValue="+fieldValue+"&validateId="+fieldId+"&validateError="+customAjaxRule+"&"+extraData,beforeSend:function(){if($.validationEngine.settings.allrules[customAjaxRule].alertTextLoad){if(!$("div."+fieldId+"formError")[0]){return $.validationEngine.buildPrompt(ajaxCaller,$.validationEngine.settings.allrules[customAjaxRule].alertTextLoad,"load");}else{$.validationEngine.updatePromptText(ajaxCaller,$.validationEngine.settings.allrules[customAjaxRule].alertTextLoad,"load");}}},error:function(data,transport){$.validationEngine.debug("error in the ajax (_ajax): "+data.status+" "+transport)},success:function(data){data=eval("("+data+")");ajaxisError=data.jsonValidateReturn[2];customAjaxRule=data.jsonValidateReturn[1];ajaxCaller=$("#"+data.jsonValidateReturn[0])[0];fieldId=ajaxCaller;ajaxErrorLength=$.validationEngine.ajaxValidArray.length;existInarray=false;if(ajaxisError=="false"){_checkInArray(false)
if(!existInarray){$.validationEngine.ajaxValidArray[ajaxErrorLength]=new Array(2);$.validationEngine.ajaxValidArray[ajaxErrorLength][0]=fieldId;$.validationEngine.ajaxValidArray[ajaxErrorLength][1]=false;existInarray=false;}
$.validationEngine.ajaxValid=false;promptTextArr.push($.validationEngine.settings.allrules[customAjaxRule].alertText);var promptText=getPromptTextByArr(promptTextArr);$.validationEngine.updatePromptText(ajaxCaller,promptText,"",true);}else{_checkInArray(true);$.validationEngine.ajaxValid=true;if($.validationEngine.settings.allrules[customAjaxRule].alertTextOk){$.validationEngine.updatePromptText(ajaxCaller,$.validationEngine.settings.allrules[customAjaxRule].alertTextOk,"pass",true);}else{ajaxValidate=false;$.validationEngine.closePrompt(ajaxCaller);}}
function _checkInArray(validate){for(x=0;x<ajaxErrorLength;x++){if($.validationEngine.ajaxValidArray[x][0]==fieldId){$.validationEngine.ajaxValidArray[x][1]=validate;existInarray=true;}}}}});}}
function _confirm(caller,rules,position){confirmField=rules[position+1];msg_order=rules[position+2];if($(caller).attr('value')!=$("#"+confirmField).attr('value')){$.validationEngine.isError=true;switch(msg_order){case"2":promptTextArr.push($.validationEngine.settings.allrules["confirm"].alertText2);break;case"3":promptTextArr.push($.validationEngine.settings.allrules["confirm"].alertText3);break;default:promptTextArr.push($.validationEngine.settings.allrules["confirm"].alertText);break;}}}
function _length(caller,rules,position){startLength=eval(rules[position+1]);endLength=eval(rules[position+2]);feildLength=$(caller).attr('value').length;if(feildLength<startLength||feildLength>endLength){$.validationEngine.isError=true;var alertText=_getAlertTextByRange("length",startLength,endLength,feildLength);promptTextArr.push(alertText);}}
function _lengthWord(caller,rules,position){startLength=eval(rules[position+1]);endLength=eval(rules[position+2]);feildLength=count_words($(caller).attr('value'));if(feildLength<startLength||feildLength>endLength){$.validationEngine.isError=true;var alertText=_getAlertTextByRange("lengthWord",startLength,endLength,feildLength);promptTextArr.push(alertText);}}
function _lengthValue(caller,rules,position){startValue=eval(rules[position+1]);endValue=eval(rules[position+2]);fieldValue=$.trim($(caller).attr('value'));if(fieldValue<startValue||fieldValue>endValue||isNaN(fieldValue)){$.validationEngine.isError=true;var alertText=_getAlertTextByRange("lengthValue",startValue,endValue,fieldValue);promptTextArr.push(alertText);}}
function _getAlertTextByRange(ruleName,startValue,endValue,currentValue){var alertText="";if(startValue!=null&&endValue==null){alertText=$.validationEngine.settings.allrules[ruleName].alertTextRangeMin;}else if(startValue==null&&endValue!=null){alertText=$.validationEngine.settings.allrules[ruleName].alertTextRangeMax;}else{alertText=$.validationEngine.settings.allrules[ruleName].alertTextRangeMinMax;}
var params=null;if(ruleName=="lengthValue"){params={min:startValue,max:endValue};}else{params={min:startValue,max:endValue,current:currentValue,length_unit:$.validationEngine.settings.allrules[ruleName].lengthUnit};}
var result=parse_resource_variables(alertText,params);return result;}
function _integerAndDecimal(caller,rules,position){startValue=eval(rules[position+1]);endValue=eval(rules[position+2]);inputs=$(':input[name='+escape_jquery_selector($(caller).attr('name'))+']');intValue=$.trim(inputs.eq(0).val());decimalValue=$.trim(inputs.eq(1).val());if(is_empty_str(intValue)){intValue=0;}
if(is_empty_str(decimalValue)){decimalValue=0;}
fieldValue=parseFloat(intValue+'.'+decimalValue);if(fieldValue<startValue||fieldValue>endValue||isNaN(fieldValue)){$.validationEngine.isError=true;promptTextArr.push(parse_resource_variables($.validationEngine.settings.allrules["lengthValue"].alertText,{min:startValue,max:endValue}));}else{$.each(inputs,function(){$.validationEngine.closePrompt(this);});}}
function _maxCheckbox(caller,rules,position){nbCheck=eval(rules[position+1]);groupname=$(caller).attr("name");groupSize=$("input[name='"+groupname+"']:checked").size();if(groupSize>nbCheck){$.validationEngine.showTriangle=false;$.validationEngine.isError=true;promptTextArr.push(parse_resource_variables($.validationEngine.settings.allrules["maxCheckbox"].alertText,{max:nbCheck}));}}
function _minCheckbox(caller,rules,position){nbCheck=eval(rules[position+1]);groupname=$(caller).attr("name");groupSize=$("input[name='"+groupname+"']:checked").size();if(groupSize<nbCheck){$.validationEngine.isError=true;$.validationEngine.showTriangle=false;promptTextArr.push(parse_resource_variables($.validationEngine.settings.allrules["minCheckbox"].alertText,{min:nbCheck}));}}
function _minSelect(caller,rules,position){nbCheck=eval(rules[position+1]);id_name=$.validationEngine.getMandatoryId(caller);groupSize=$("select[id='"+id_name+"'] option:selected").size();if(groupSize<nbCheck){$.validationEngine.isError=true;$.validationEngine.showTriangle=false;promptTextArr.push(parse_resource_variables($.validationEngine.settings.allrules["minCheckbox"].alertText,{min:nbCheck}));}}
return($.validationEngine.isError)?$.validationEngine.isError:false;},submitForm:function(caller){if($.validationEngine.settings.ajaxSubmit){if($.validationEngine.settings.ajaxSubmitExtraData){extraData=$.validationEngine.settings.ajaxSubmitExtraData;}else{extraData="";}
$.ajax({type:"POST",url:$.validationEngine.settings.ajaxSubmitFile,async:true,data:$(caller).serialize()+"&"+extraData,error:function(data,transport){$.validationEngine.debug("error in the ajax (submitForm): "+data.status+" "+transport)},success:function(data){if(data=="true"){$(caller).css("opacity",1)
$(caller).animate({opacity:0,height:0},function(){$(caller).css("display","none");$(caller).before("<div class='ajaxSubmit'>"+$.validationEngine.settings.ajaxSubmitMessage+"</div>");$.validationEngine.closePrompt(".formError",true);$(".ajaxSubmit").show("slow");if($.validationEngine.settings.success){$.validationEngine.settings.success&&$.validationEngine.settings.success();return false;}})}else{data=eval("("+data+")");if(!data.jsonValidateReturn){$.validationEngine.debug("you are not going into the success fonction and jsonValidateReturn return nothing");}
errorNumber=data.jsonValidateReturn.length
for(index=0;index<errorNumber;index++){fieldId=data.jsonValidateReturn[index][0];promptError=data.jsonValidateReturn[index][1];type=data.jsonValidateReturn[index][2];$.validationEngine.buildPrompt(fieldId,promptError,type);}}}})
return true;}
if(!$.validationEngine.settings.beforeSuccess()){if($.validationEngine.settings.success){if($.validationEngine.settings.unbindEngine){$(caller).unbind("submit")}
$.validationEngine.settings.success&&$.validationEngine.settings.success();return true;}}else{return true;}
return false;},buildPrompt:function(caller,promptText,type,ajaxed){if(!$.validationEngine.settings){$.validationEngine.defaultSetting()}
deleteItself="."+$.validationEngine.getMandatoryId(caller)+"formError"
if($(deleteItself)[0]){$(deleteItself).stop();$(deleteItself).remove();}
var divFormError=document.createElement('div');var formErrorContent=document.createElement('div');linkTofield=$.validationEngine.linkTofield(caller)
$(divFormError).addClass("formError")
if(type=="pass"){$(divFormError).addClass("greenPopup")}
if(type=="load"){$(divFormError).addClass("blackPopup")}
if(ajaxed){$(divFormError).addClass("ajaxed")}
$(divFormError).addClass(linkTofield);$(formErrorContent).addClass("formErrorContent");$("body").append(divFormError);$(divFormError).append(formErrorContent);if($.validationEngine.showTriangle!=false){var arrow=document.createElement('div');$(arrow).addClass("formErrorArrow");$(divFormError).append(arrow);if($.validationEngine.settings.promptPosition=="bottomLeft"||$.validationEngine.settings.promptPosition=="bottomRight"){$(arrow).addClass("formErrorArrowBottom")
$(arrow).html('<div class="line1"><!-- --></div><div class="line2"><!-- --></div><div class="line3"><!-- --></div><div class="line4"><!-- --></div><div class="line5"><!-- --></div><div class="line6"><!-- --></div><div class="line7"><!-- --></div><div class="line8"><!-- --></div><div class="line9"><!-- --></div><div class="line10"><!-- --></div>');}
if($.validationEngine.settings.promptPosition=="topLeft"||$.validationEngine.settings.promptPosition=="topRight"){$(divFormError).append(arrow);$(arrow).html('<div class="line10"><!-- --></div><div class="line9"><!-- --></div><div class="line8"><!-- --></div><div class="line7"><!-- --></div><div class="line6"><!-- --></div><div class="line5"><!-- --></div><div class="line4"><!-- --></div><div class="line3"><!-- --></div><div class="line2"><!-- --></div><div class="line1"><!-- --></div>');}}
$(formErrorContent).html(promptText)
callerTopPosition=$(caller).offset().top;callerleftPosition=$(caller).offset().left;callerWidth=$(caller).width();inputHeight=$(divFormError).height();var offset=null;if($.validationEngine.settings.promptPosition=="topRight"){var minWidthOfPrompt=130;var maxLeft=$(document.body).width()-minWidthOfPrompt;var targetLeftPosition=callerleftPosition+callerWidth-30;if(targetLeftPosition>maxLeft){callerleftPosition=maxLeft;offset=targetLeftPosition-maxLeft;}else{callerleftPosition+=callerWidth-30;}
callerTopPosition+=-inputHeight-10;}
if($.validationEngine.settings.promptPosition=="topLeft"){callerTopPosition+=-inputHeight-10;}
if($.validationEngine.settings.promptPosition=="centerRight"){callerleftPosition+=callerWidth+13;}
if($.validationEngine.settings.promptPosition=="bottomLeft"){callerHeight=$(caller).height();callerleftPosition=callerleftPosition;callerTopPosition=callerTopPosition+callerHeight+15;}
if($.validationEngine.settings.promptPosition=="bottomRight"){callerHeight=$(caller).height();callerleftPosition+=callerWidth-30;callerTopPosition+=callerHeight+15;}
$(divFormError).css({top:callerTopPosition,left:callerleftPosition,opacity:0});if(offset){var maxArrowOffset=$(divFormError).width()-45;var arrowObj=$('.formErrorArrow',$(divFormError));var arrowLeft=(arrowObj.position().left+Math.min(offset,maxArrowOffset))+"px";arrowObj.css({left:arrowLeft});}
$(divFormError).click(function(){$(this).remove();});return $(divFormError).animate({"opacity":PROMPT_OPACITY},function(){return true;});},updatePromptText:function(caller,promptText,type,ajaxed){linkTofield=$.validationEngine.linkTofield(caller);var updateThisPrompt="."+linkTofield;if(type=="pass"){$(updateThisPrompt).addClass("greenPopup")}else{$(updateThisPrompt).removeClass("greenPopup")};if(type=="load"){$(updateThisPrompt).addClass("blackPopup")}else{$(updateThisPrompt).removeClass("blackPopup")};if(ajaxed){$(updateThisPrompt).addClass("ajaxed")}else{$(updateThisPrompt).removeClass("ajaxed")};$(updateThisPrompt).find(".formErrorContent").html(promptText);callerTopPosition=$(caller).offset().top;inputHeight=$(updateThisPrompt).height();if($.validationEngine.settings.promptPosition=="bottomLeft"||$.validationEngine.settings.promptPosition=="bottomRight"){callerHeight=$(caller).height();callerTopPosition=callerTopPosition+callerHeight+15;}
if($.validationEngine.settings.promptPosition=="centerRight"){callerleftPosition+=callerWidth+13;}
if($.validationEngine.settings.promptPosition=="topLeft"||$.validationEngine.settings.promptPosition=="topRight"){callerTopPosition=callerTopPosition-inputHeight-10;}
$(updateThisPrompt).animate({top:callerTopPosition,"opacity":PROMPT_OPACITY});},getMandatoryId:function(caller){var id=$(caller).attr("id");if(is_empty_str(id)){$(caller).attr("id","ValidationEngineAutoId_"+get_next_unique_id("ValidationEngineAutoId"));}
id=$(caller).attr("id");return id;},linkTofield:function(caller){linkTofield=$.validationEngine.getMandatoryId(caller)+"formError";linkTofield=linkTofield.replace(/\[/g,"");linkTofield=linkTofield.replace(/\]/g,"");return linkTofield;},closePrompt:function(caller,outside){if(!$.validationEngine.settings){$.validationEngine.defaultSetting()}
if(outside){$(caller).fadeTo("fast",0,function(){$(caller).remove();});return false;}
if(typeof(ajaxValidate)=='undefined'){ajaxValidate=false}
if(!ajaxValidate){linkTofield=$.validationEngine.linkTofield(caller);closingPrompt="."+linkTofield;$(closingPrompt).fadeTo("fast",0,function(){$(closingPrompt).remove();});}},debug:function(error){},submitValidation:function(caller){var stopForm=false;$.validationEngine.ajaxValid=true;$(caller).find(".formError").remove();var toValidateSize=$(caller).find("[class*=validate]").size();$(caller).find("[class*=validate]").each(function(){linkTofield=$.validationEngine.linkTofield(this);if(!$("."+linkTofield).hasClass("ajaxed")){var validationPass=$.validationEngine.loadValidation(this);return(validationPass)?stopForm=true:"";};});ajaxErrorLength=$.validationEngine.ajaxValidArray.length;for(x=0;x<ajaxErrorLength;x++){if($.validationEngine.ajaxValidArray[x][1]==false){$.validationEngine.ajaxValid=false;}}
if(stopForm||!$.validationEngine.ajaxValid){if($.validationEngine.settings.scroll){destination=$(".formError:not('.greenPopup'):first").offset().top;$(".formError:not('.greenPopup')").each(function(){testDestination=$(this).offset().top;if(destination>testDestination){destination=$(this).offset().top;}})
$("html:not(:animated),body:not(:animated)").animate({scrollTop:destination},1100);if(typeof post_message_for_scroll_to_error!='undefined'){if(typeof emf_form_visit_id!='undefined'){post_message_for_scroll_to_error(emf_form_visit_id);}else{post_message_for_scroll_to_error();}}}
return true;}else{return false;}}}})(jQuery);;var EMF_jQuery=jQuery;(function($){$.fn.validationEngineLanguage=function(){};$.validationEngineLanguage={newLang:function(){$.validationEngineLanguage.allRules={"required":{"regex":"none","alertText":g_emf_resources['js_validation_required'],"alertTextCheckboxMultiple":g_emf_resources['js_validation_required_select_multiple'],"alertTextCheckbox":g_emf_resources['js_validation_required_checkbox']},"length":{"regex":"none","alertTextRangeMinMax":g_emf_resources['js_validation_length_range_min_max'],"alertTextRangeMin":g_emf_resources['js_validation_length_range_min'],"alertTextRangeMax":g_emf_resources['js_validation_length_range_max'],"lengthUnit":g_emf_resources['js_validation_length_unit_character']},"lengthWord":{"regex":"none","alertTextRangeMinMax":g_emf_resources['js_validation_length_range_min_max'],"alertTextRangeMin":g_emf_resources['js_validation_length_range_min'],"alertTextRangeMax":g_emf_resources['js_validation_length_range_max'],"lengthUnit":g_emf_resources['js_validation_length_unit_word']},"lengthValue":{"regex":"none","alertTextRangeMinMax":g_emf_resources['js_validation_number_range_min_max'],"alertTextRangeMin":g_emf_resources['js_validation_number_range_min'],"alertTextRangeMax":g_emf_resources['js_validation_number_range_max']},"maxCheckbox":{"regex":"none","alertText":g_emf_resources['js_validation_max_checkbox']},"minCheckbox":{"regex":"none","alertText":g_emf_resources['js_validation_min_checkbox']},"confirm":{"regex":"none","alertText":g_emf_resources['js_validation_confirm'],"alertText2":g_emf_resources['js_validation_confirm2'],"alertText3":g_emf_resources['js_validation_confirm3']},"telephone":{"regex":"/^[0-9\-\(\)\+\ ]+$/","alertText":g_emf_resources['js_validation_telephone']},"email":{"regex":"/^[a-zA-Z0-9.!#$%&'*+-/=?\\^_`{|}~-]+\\@([a-zA-Z0-9\\-]+\\.)+[a-zA-Z0-9]{2,}$/","alertText":g_emf_resources['js_validation_email']},"url":{"regex":/^((https?|ftp):\/\/)?(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,"alertText":g_emf_resources['js_validation_url']},"general_letter_number":{"regex":"/^[a-zA-Z0-9-_]*$/","alertText":g_emf_resources['js_validation_general_letter_number']},"date":{"regex":"/^[0-9]{4}\-\[0-9]{1,2}\-\[0-9]{1,2}$/","alertText":g_emf_resources['js_validation_date']},"onlyNumber":{"regex":"/^[0-9\ ]+$/","alertText":g_emf_resources['js_validation_number_only']},"numberWithSign":{"regex":"/^[0-9\ \+\-]+$/","alertText":g_emf_resources['js_validation_number_with_sign']},"extNumber":{"regex":"/^[0-9,\.\ ]+$/","alertText":g_emf_resources['js_validation_ext_number']},"numberPercentSign":{"regex":"/^[0-9,\.%]+$/","alertText":g_emf_resources['js_validation_number_percent_sign']},"noSpecialCaracters":{"regex":"/^[0-9a-zA-Z]+$/","alertText":g_emf_resources['js_validation_no_special_chars']},"noSpecialCaractersEx":{"regex":/^[0-9a-zA-Z\ \-\&\']+$/,"alertText":g_emf_resources['js_validation_no_special_chars_ex']},"ajaxPassword":{"file":get_site_url('account/check_password'),"extraData":"Password="+$('#Password').val(),"alertTextOk":"Old Password is correct","alertTextLoad":"Loading, please wait","alertText":"Old Password is wrong"},"onlyLetter":{"regex":"/^[a-zA-Z\ \']+$/","alertText":g_emf_resources['js_validation_letter_only']},"ajaxUsername":{"file":get_site_url('account/check_user'),"extraData":"Username="+$('#Username').val(),"alertTextOk":"This user is available","alertTextLoad":"Loading, please wait","alertText":"This user is already taken"},"ajaxEmail":{"file":get_site_url('account/check_email'),"extraData":"ContactEmail="+$('#ContactEmail').val(),"alertTextOk":"This email is available","alertTextLoad":"Loading, please wait","alertText":"This email is already taken"},"NameEmail":{"fname":"NameEmail","alertText":"Invalid email address"},"valid_captcha":{"fname":"valid_captcha","alertText":g_emf_resources['js_validation_captcha']},"url_ex":{"fname":"url_ex","alertText":g_emf_resources['js_validation_url_ex']},"check_file_error":{"fname":"check_file_error","alertText":g_emf_resources['js_validation_check_file_error']},"min_max":{"fname":"validate_min_max","alertText":""},"validate_gateway":{"fname":"validate_gateway","alertText":""},"val_not_free_plan":{"fname":"val_not_free_plan","alertText":""},"required_buyer_if_paypal":{"fname":"required_buyer_if_paypal","alertText":""},"non_negative_integer":{"regex":"/^(0|([1-9][0-9]*))$/","alertText":"Must be an integer number"},"unique_field_value":{"fname":"unique_field_value","alertText":"This value already exists."},"check_sum":{"fname":"check_sum","alertText":""},"ajaxMailChimpAPIKey":{"file":get_site_url('manager/validate_mail_chimp_api_key'),"extraData":"Username="+$('#Username').val(),"alertTextOk":"This user is available","alertTextLoad":"Loading, please wait","alertText":"This user is already taken"},"required_by_attr_flag":{"fname":"required_by_attr_flag","alertText":""}}}}})(jQuery);EMF_jQuery(document).ready(function(){EMF_jQuery.validationEngineLanguage.newLang();});;function show_dialog(id,options){var modal=false;var width='auto';var height='auto';var resizable=false;var title='';var hide_close_button=false;var close_on_escape=false;var fire_first_button_on_enter=false;if(typeof(options)!='undefined'&&options){if(options['modal']==true){modal=true;}
if(options['width']){width=options['width'];}
if(options['height']){height=options['height'];}
if(options['resizable']==true){resizable=options['resizable'];}
if(options['title']){title=options['title'];}
if(options['hide_close_button']){hide_close_button=options['hide_close_button'];}
if(typeof(options['closeOnEscape'])=='undefined'){close_on_escape=!hide_close_button;}else{close_on_escape=options['closeOnEscape'];}
if(typeof(options['fireFirstButtonOnEnter'])=='undefined'){fire_first_button_on_enter=false;}else{fire_first_button_on_enter=options['fireFirstButtonOnEnter'];}}
$("#"+id).dialog({title:title,modal:modal,resizable:resizable,width:width,height:height,dialogClass:'emf_dialog',closeOnEscape:close_on_escape,close:function(event,ui){hide_error_on_dialog(this);}});if(hide_close_button){$("#"+id).parents('.ui-dialog').find('.ui-dialog-titlebar-close').hide();}
if(fire_first_button_on_enter){$("#"+id).parents('.ui-dialog').keydown(function(event){event.stopPropagation();if(event.keyCode==$.ui.keyCode.ENTER){$("#"+id+" .TB_content_button img:first").click();}});}}
function rand_id(){var id=""+Math.random();return"id_"+id.substr(2);}
function debug_log(msg){}
function create_dialog(title,html_content,options){if(typeof(options)=='undefined'||options==null){options={};}
var custom_id=null;var enable_show_dialog=true;custom_id=options['custom_id'];if(options['hide_after_create']){enable_show_dialog=false;}
var id;var found_dialog=false;if(custom_id){if($("#"+custom_id).length>0){found_dialog=true;}
id=custom_id;}else{id=rand_id();}
if(found_dialog){var title_html="";if(title){title_html="<h2>"+title+"</h2>";}
$("#"+id+" .TB_content_caption").html(title_html+"\n"+(html_content?html_content:""));}else{var title_html="";if(title){title_html="<h2>"+title+"</h2>";}
var html="<div id='"+id+"' class='thickbox' style='display:none'><div class='TB_content'>\n"
+"<div class='TB_content_caption'>"+title_html+"\n"+(html_content?html_content:"")
+"<div class='TB_inline_error'></div></div>\n"
+"<input type='button' style='display:none;' class='thickbox' id='"+id+"_button'>"
+"</div>";$(document.body).append(html);}
if(options['image_buttons']){create_image_buttons(id,options['image_buttons']);}
options['image_buttons']=null;if(options['text_buttons']){create_text_buttons(id,options['text_buttons']);}
options['text_buttons']=null;if(options['list_buttons']){create_list_buttons(id,options['list_buttons']);}
options['list_buttons']=null;if(enable_show_dialog){show_dialog(id,options);}
return id;}
function show_error_on_dialog(err,id){var sel;if(id){sel="#"+id+" .TB_inline_error";}else{sel=".emf_dialog .TB_inline_error";}
$(sel).html(err).show();}
function hide_error_on_dialog(dialog){if(dialog){$(dialog).find(".TB_inline_error").html("").hide();}else{$(".emf_dialog .TB_inline_error").html("").hide();}}
function create_list_buttons(id,btns){if(btns.length>0){var create_btns=$("<div class='TB_content_button' style='margin: 0px auto 0px; text-align: center;'>\n<ul class='ul-lists'></ul></div>\n");var lists=create_btns.find(".ul-lists");for(var i=0;i<btns.length;i++){var btn=btns[i];if(btn['html']){var create_btn=$("<li class='anchor'><b class='list_icon_"+(i+1)+"'>"+btn['html']+"</b></li>");create_btn.click(btn['click']);lists.append(create_btn);}}
$("#"+id+" .TB_content").append(create_btns);}}
function create_text_buttons(id,btns){if(btns.length>0){var create_btns=$("<div class='TB_content_button' style='margin: 25px auto 0px; text-align: center;'>\n</div>\n");for(var i=0;i<btns.length;i++){var btn=btns[i];if(btn['text']){var create_btn=$("<button class='ui-button  ui-widget ui-state-default ui-corner-all ui-button-text-only ui-button-text'><span class='ui-button-text'>"+btn['text']+"</span></button>");create_btn.click(btn['click']);create_btns.append(create_btn);}}
$("#"+id+" .TB_content_caption").append(create_btns);}}
function create_image_buttons(id,btns){if(btns.length>0){var create_btns=$("<div class='TB_content_button' style='margin: 25px auto 0px; text-align: center;'>\n</div>\n");for(var i=0;i<btns.length;i++){var btn=btns[i];if(btn['image']){var create_btn=$("<img style='cursor:pointer;' src='"+btn['image']+"' >\n");create_btn.click(btn['click']);create_btns.append(create_btn);}}
$("#"+id+" .TB_content_caption").append(create_btns);}}
function get_dialog(ctrl){var jq_ctrl=$(ctrl);if(jq_ctrl.hasClass(".ui-dialog-content")){return jq_ctrl;}else{return jq_ctrl.parents("div.thickbox");}}
function show_dialog_with_button_list(list_buttons,options,title){if(typeof(options)=='undefined'||options==null){options={};}
options['list_buttons']=list_buttons;options['modal']=true;title=title||null;create_dialog(title,null,options);}
function show_dialog_with_text_buttons(title,html_content,text_buttons,options){if(typeof(options)=='undefined'||options==null){options={};}
options['text_buttons']=text_buttons;create_dialog(title,html_content,options);}
function show_dialog_with_image_buttons(title,html_content,image_buttons,options){if(typeof(options)=='undefined'||options==null){options={};}
options['image_buttons']=image_buttons;return create_dialog(title,html_content,options);}
function show_alert(title,html_content,options){if(typeof(options)=='undefined'||options==null){options={};}
if(options['width']==null){options['width']=500;}
options['image_buttons']=[{'image':get_assets_url('images/dialog-box-button-close.png'),click:function(){get_dialog(this).dialog("close");}}];options['modal']=true;return create_dialog(title,html_content,options);}
function show_error_for_public(title,html_content,options){html_content+="<BR><BR>EmailMeForm is an online webform and survey builder tool.";if(typeof(options)=='undefined'||options==null){options={};}
if(options['width']==null){options['width']=500;}
options['image_buttons']=[{'image':get_assets_url('images/dialog-box-button-learn-more.png'),click:function(){window.location.href=get_site_url('');}}];options['modal']=true;options['hide_close_button']=true;create_dialog(title,html_content,options);}
function show_confirm(title,html_content,image_buttons,options){if(typeof(options)=='undefined'||options==null){options={};}
if(options['width']==null){options['width']=500;}
if(options['modal']!=true&&options['modal']!=false){options['modal']=true;}
return show_dialog_with_image_buttons(title,html_content,image_buttons,options);}
function show_confirm_dialog(title,html_content,yes_function,no_function,options){if(no_function==null){no_function=function(){get_dialog(this).dialog("close");}}
return show_confirm(title,html_content,[{image:get_assets_url('images/dialog-box-button-yes.png'),click:yes_function},{image:get_assets_url('images/dialog-box-button-no.png'),click:no_function}],options);}
function show_confirm_deletion_dialog(entity_name,entity_instance_name,yes_function,no_function,options){return show_confirm_dialog('Please Confirm','Are you sure you want to delete the '+entity_name+' "'+get_safe_html(entity_instance_name)+'"?',yes_function,no_function,options);}
function show_custom_upgrade_dialog(title,html_content,is_top_plan,next_plan_id,options_height){var options={width:500,modal:true};if(!(typeof(options_height)=='undefined'||options_height==null)){options['height']=options_height;}
options['image_buttons']=[is_top_plan?{image:get_assets_url('images/dialog-box-button-contact-us.png'),click:function(){go_url_self(base_url+'onlineform/sendfeedback_logged/Accounts and Billing');}}:{image:get_assets_url('images/dialog-box-button-upgrade.png'),click:function(){if(next_plan_id){go_url_self(base_url+'pay/plan/'+next_plan_id);}else{go_url_self(base_url+'account');}}},{image:get_assets_url('images/dialog-box-button-close.png'),click:function(){get_dialog(this).dialog("close");}}];create_dialog(title,html_content,options);}
function show_upgrade_dialog(html_content,entity_name,is_top_plan,next_plan_id,is_demo){if(typeof is_demo=='undefined'){is_demo=false;}
var options={width:500,modal:true};var title=capitalize_first_char(entity_name)+' Limit Reached';html_content+=" ";html_content+=is_top_plan?'If you need to create additional '+entity_name+', please contact Accounts and Billing to further discuss your organization\'s needs.':is_demo?'Higher tiered plans have increased '+entity_name+' limits.':'Please upgrade your plan if you need to create additional '+entity_name+'.';if(is_demo){options['image_buttons']=[{image:get_assets_url('images/dialog-box-button-close.png'),click:function(){get_dialog(this).dialog("close");}}];}else{options['image_buttons']=[is_top_plan?{image:get_assets_url('images/dialog-box-button-contact-us.png'),click:function(){go_url_self(base_url+'onlineform/sendfeedback_logged/Accounts and Billing');}}:{image:get_assets_url('images/dialog-box-button-upgrade.png'),click:function(){if(next_plan_id){go_url_self(base_url+'pay/plan/'+next_plan_id);}else{go_url_self(base_url+'account');}}},{image:get_assets_url('images/dialog-box-button-close.png'),click:function(){get_dialog(this).dialog("close");}}];}
create_dialog(title,html_content,options);}
function show_custom_plan_feature_dialog(which_plan,is_top_plan,next_plan_id){show_custom_upgrade_dialog(which_plan+" Plan Feature","In order to access this feature, you must upgrade your EmailMeForm plan.",is_top_plan,next_plan_id);}
function show_pro_plan_feature_dialog(){var pro_plan_id=3;show_custom_plan_feature_dialog("Pro",false,pro_plan_id);}
function show_paid_plan_feature_dialog(){var plus_plan_id=1;show_custom_plan_feature_dialog("Paid",false,plus_plan_id);}
function show_common_upgrade_dialog(entity_name,is_top_plan,next_plan_id){var message=is_top_plan?'You have reached the maximum number of '+entity_name+' that you can create with your plan.':'You have reached the maximum number of '+entity_name+' that you can create with your plan.';show_upgrade_dialog('You have reached the maximum number of '+entity_name+' that you can create with your plan.',entity_name,is_top_plan,next_plan_id);}
function go_url_blank(url){window.open(url);}
function go_url_self(url){window.location.href=url;}
function close_dialog(id){var dialog=null;if(typeof(id)=='object'){dialog=get_dialog(id);}else{dialog=$("#"+id);}
dialog.dialog("close");}
function close_container_dialog(control){get_dialog(control).dialog("close");}
function extract_parameters(paramStr){var vars=[],hash;if(paramStr){var hashes=paramStr.slice(paramStr.indexOf('?')+1).split('&');for(var i=0;i<hashes.length;i++){hash=hashes[i].split('=');vars.push(hash[0]);vars[hash[0]]=hash[1];}}
return vars;}
function convert_to_real(p,max){if(p.substr(p.length-1,1)=='%'){var n=p.substr(0,p.length-1);if(!isNaN(n)){var n=parseInt(n,10);p=Math.round(n/100*max);}}
return p;}
function is_percent(p){return p.substr(p.length-1,1)=='%'&&!isNaN(p.substr(0,p.length-1));}
function reset_width_height_for_iframe(ctrl){var a=$(ctrl).attr("href")||$(ctrl).attr("alt");var params=extract_parameters(a);var id=params['inlineId'];if($("#"+id).find("iframe").length>0){var options=params;if(options['height']){if(isNaN(options['height'])){var h=options['height'];if(is_percent(h)){options['height']=convert_to_real(h,$(window).height());}}else{options['height']=parseInt(options['height'],10)+30;}
$("#"+id+" .TB_content").css("height",options['height']-55);$("#"+id+" .TB_content_caption").css("height",options['height']-55);}}}
function init_dialog(ctrl){$(ctrl).each(function(){reset_width_height_for_iframe(this);});$(ctrl).unbind("click");$(ctrl).click(function(){var t=this.title||this.name||null;var a=this.href||this.alt;var params=extract_parameters(a);var id=params['inlineId'];var options=params;if(options['height']){if(isNaN(options['height'])){var h=options['height'];if(is_percent(h)){options['height']=convert_to_real(h,$(window).height());}}else{options['height']=parseInt(options['height'],10)+30;}}
if(options['width']){if(isNaN(options['width'])){var w=options['width'];if(is_percent(w)){options['width']=convert_to_real(w,$(window).width());}}else{options['width']=parseInt(options['width'],10)+39;}}
if(t){options['title']=t;}
if(options['modal']!=false&&options['modal']!=true){options['modal']=true;}
show_dialog(id,options);this.blur();return false;});}
function close_all_dialogs(){$(".ui-dialog-content").dialog("close");}
function tb_init(ctrl){init_dialog(ctrl);}
function tb_remove(){close_all_dialogs();}
function show_upgrade_dialog_for_high_plan_feature(upgrade_url,title,content){if(title==null){title='Paid Plan Feature!';}
if(content==null){content='In order to access this feature, you must upgrade your EmailMeForm plan.';}
return show_dialog_with_image_buttons(title,content,[{'image':get_assets_url('images/dialog-box-button-close.png'),click:function(){get_dialog(this).dialog("close");}},{'image':get_assets_url('images/dialog-box-button-upgrade.png'),click:function(){window.location.href=upgrade_url;}}],{modal:true});}
$(document).ready(function(){init_dialog('a.thickbox, area.thickbox, input.thickbox');});;
/*!
 * jQuery corner plugin: simple corner rounding
 * Examples and documentation at: http://jquery.malsup.com/corner/
 * version 2.09 (11-MAR-2010)
 * Requires jQuery v1.3.2 or later
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Authors: Dave Methvin and Mike Alsup
 */
;(function($){var style=document.createElement('div').style;var moz=style['MozBorderRadius']!==undefined;var webkit=style['WebkitBorderRadius']!==undefined;var radius=style['borderRadius']!==undefined||style['BorderRadius']!==undefined;var mode=document.documentMode||0;var noBottomFold=$.browser.msie&&(($.browser.version<8&&!mode)||mode<8);var expr=$.browser.msie&&(function(){var div=document.createElement('div');try{div.style.setExpression('width','0+0');div.style.removeExpression('width');}
catch(e){return false;}
return true;})();function sz(el,p){return parseInt($.css(el,p))||0;};function hex2(s){var s=parseInt(s).toString(16);return(s.length<2)?'0'+s:s;};function gpc(node){while(node){var v=$.css(node,'backgroundColor');if(v&&v!='transparent'&&v!='rgba(0, 0, 0, 0)'){if(v.indexOf('rgb')>=0){var rgb=v.match(/\d+/g);return'#'+hex2(rgb[0])+hex2(rgb[1])+hex2(rgb[2]);}
return v;}
node=node.parentNode;}
return'#ffffff';};function getWidth(fx,i,width){switch(fx){case'round':return Math.round(width*(1-Math.cos(Math.asin(i/width))));case'cool':return Math.round(width*(1+Math.cos(Math.asin(i/width))));case'sharp':return Math.round(width*(1-Math.cos(Math.acos(i/width))));case'bite':return Math.round(width*(Math.cos(Math.asin((width-i-1)/width))));case'slide':return Math.round(width*(Math.atan2(i,width/i)));case'jut':return Math.round(width*(Math.atan2(width,(width-i-1))));case'curl':return Math.round(width*(Math.atan(i)));case'tear':return Math.round(width*(Math.cos(i)));case'wicked':return Math.round(width*(Math.tan(i)));case'long':return Math.round(width*(Math.sqrt(i)));case'sculpt':return Math.round(width*(Math.log((width-i-1),width)));case'dogfold':case'dog':return(i&1)?(i+1):width;case'dog2':return(i&2)?(i+1):width;case'dog3':return(i&3)?(i+1):width;case'fray':return(i%2)*width;case'notch':return width;case'bevelfold':case'bevel':return i+1;}};$.fn.corner=function(options){if(this.length==0){if(!$.isReady&&this.selector){var s=this.selector,c=this.context;$(function(){$(s,c).corner(options);});}
return this;}
return this.each(function(index){var $this=$(this);var o=[$this.attr($.fn.corner.defaults.metaAttr)||'',options||''].join(' ').toLowerCase();var keep=/keep/.test(o);var cc=((o.match(/cc:(#[0-9a-f]+)/)||[])[1]);var sc=((o.match(/sc:(#[0-9a-f]+)/)||[])[1]);var width=parseInt((o.match(/(\d+)px/)||[])[1])||10;var re=/round|bevelfold|bevel|notch|bite|cool|sharp|slide|jut|curl|tear|fray|wicked|sculpt|long|dog3|dog2|dogfold|dog/;var fx=((o.match(re)||['round'])[0]);var fold=/dogfold|bevelfold/.test(o);var edges={T:0,B:1};var opts={TL:/top|tl|left/.test(o),TR:/top|tr|right/.test(o),BL:/bottom|bl|left/.test(o),BR:/bottom|br|right/.test(o)};if(!opts.TL&&!opts.TR&&!opts.BL&&!opts.BR)
opts={TL:1,TR:1,BL:1,BR:1};if($.fn.corner.defaults.useNative&&fx=='round'&&(radius||moz||webkit)&&!cc&&!sc){if(opts.TL)
$this.css(radius?'border-top-left-radius':moz?'-moz-border-radius-topleft':'-webkit-border-top-left-radius',width+'px');if(opts.TR)
$this.css(radius?'border-top-right-radius':moz?'-moz-border-radius-topright':'-webkit-border-top-right-radius',width+'px');if(opts.BL)
$this.css(radius?'border-bottom-left-radius':moz?'-moz-border-radius-bottomleft':'-webkit-border-bottom-left-radius',width+'px');if(opts.BR)
$this.css(radius?'border-bottom-right-radius':moz?'-moz-border-radius-bottomright':'-webkit-border-bottom-right-radius',width+'px');return;}
var strip=document.createElement('div');$(strip).css({overflow:'hidden',height:'1px',minHeight:'1px',fontSize:'1px',backgroundColor:sc||'transparent',borderStyle:'solid'});var pad={T:parseInt($.css(this,'paddingTop'))||0,R:parseInt($.css(this,'paddingRight'))||0,B:parseInt($.css(this,'paddingBottom'))||0,L:parseInt($.css(this,'paddingLeft'))||0};if(typeof this.style.zoom!=undefined)this.style.zoom=1;if(!keep)this.style.border='none';strip.style.borderColor=cc||gpc(this.parentNode);var cssHeight=$(this).outerHeight();for(var j in edges){var bot=edges[j];if((bot&&(opts.BL||opts.BR))||(!bot&&(opts.TL||opts.TR))){strip.style.borderStyle='none '+(opts[j+'R']?'solid':'none')+' none '+(opts[j+'L']?'solid':'none');var d=document.createElement('div');$(d).addClass('jquery-corner');var ds=d.style;bot?this.appendChild(d):this.insertBefore(d,this.firstChild);if(bot&&cssHeight!='auto'){if($.css(this,'position')=='static')
this.style.position='relative';ds.position='absolute';ds.bottom=ds.left=ds.padding=ds.margin='0';if(expr)
ds.setExpression('width','this.parentNode.offsetWidth');else
ds.width='100%';}
else if(!bot&&$.browser.msie){if($.css(this,'position')=='static')
this.style.position='relative';ds.position='absolute';ds.top=ds.left=ds.right=ds.padding=ds.margin='0';if(expr){var bw=sz(this,'borderLeftWidth')+sz(this,'borderRightWidth');ds.setExpression('width','this.parentNode.offsetWidth - '+bw+'+ "px"');}
else
ds.width='100%';}
else{ds.position='relative';ds.margin=!bot?'-'+pad.T+'px -'+pad.R+'px '+(pad.T-width)+'px -'+pad.L+'px':(pad.B-width)+'px -'+pad.R+'px -'+pad.B+'px -'+pad.L+'px';}
for(var i=0;i<width;i++){var w=Math.max(0,getWidth(fx,i,width));var e=strip.cloneNode(false);e.style.borderWidth='0 '+(opts[j+'R']?w:0)+'px 0 '+(opts[j+'L']?w:0)+'px';bot?d.appendChild(e):d.insertBefore(e,d.firstChild);}
if(fold&&$.support.boxModel){if(bot&&noBottomFold)continue;for(var c in opts){if(!opts[c])continue;if(bot&&(c=='TL'||c=='TR'))continue;if(!bot&&(c=='BL'||c=='BR'))continue;var common={position:'absolute',border:'none',margin:0,padding:0,overflow:'hidden',backgroundColor:strip.style.borderColor};var $horz=$('<div/>').css(common).css({width:width+'px',height:'1px'});switch(c){case'TL':$horz.css({bottom:0,left:0});break;case'TR':$horz.css({bottom:0,right:0});break;case'BL':$horz.css({top:0,left:0});break;case'BR':$horz.css({top:0,right:0});break;}
d.appendChild($horz[0]);var $vert=$('<div/>').css(common).css({top:0,bottom:0,width:'1px',height:width+'px'});switch(c){case'TL':$vert.css({left:width});break;case'TR':$vert.css({right:width});break;case'BL':$vert.css({left:width});break;case'BR':$vert.css({right:width});break;}
d.appendChild($vert[0]);}}}}});};$.fn.uncorner=function(){if(radius||moz||webkit)
this.css(radius?'border-radius':moz?'-moz-border-radius':'-webkit-border-radius',0);$('div.jquery-corner',this).remove();return this;};$.fn.corner.defaults={useNative:true,metaAttr:'data-corner'};})(jQuery);;(function(b){b.fn.extend({counter:function(a){a=b.extend({},{type:"char",count:"down",goal:140},a);var d=false;return this.each(function(){function e(c){if(typeof a.type==="string")switch(a.type){case"char":if(a.count==="down"){g=" character(s) left";return a.goal-c}else if(a.count==="up"){g=" characters ("+a.goal+" max)";return c}break;case"word":if(a.count==="down"){g=" word(s) left";return a.goal-c}else if(a.count==="up"){g=" words ("+a.goal+" max)";return c}break;default:}}var g,f=b(this);b('<div id="'+this.id+'_counter"><span>'+e(b(f).val().length)+"</span>"+g+"</div>").insertAfter(f);var i=b("#"+this.id+"_counter span");f.bind("keyup click blur focus change paste",function(c){switch(a.type){case"char":c=b(f).val().length;break;case"word":c=f.val()===""?0:b.trim(f.val()).replace(/\s+/g," ").split(" ").length;break;default:}switch(a.count){case"up":if(e(c)>=a.goal&&a.type==="char"){b(this).val(b(this).val().substring(0,a.goal));d=true;break}if(e(c)===a.goal&&a.type==="word"){d=true;break}else if(e(c)>a.goal&&a.type==="word"){b(this).val("");i.text("0");d=true;break}break;case"down":if(e(c)<=0&&a.type==="char"){b(this).val(b(this).val().substring(0,a.goal));d=true;break}if(e(c)===0&&a.type==="word")d=true;else if(e(c)<0&&a.type==="word"){b(this).val("");d=true;break}break;default:}f.keydown(function(h){if(d){this.focus();if(h.keyCode!==46&&h.keyCode!==8)if(b(this).val().length>a.goal&&a.type==="char"){b(this).val(b(this).val().substring(0,a.goal));return false}else return h.keyCode!==32&&h.keyCode!==8&&a.type==="word"?true:false;else{d=false;return true}}});i.text(e(c))})})}})})(jQuery);;var hexcase=0;var b64pad="";var chrsz=8;function hex_md5(s){return binl2hex(core_md5(str2binl(s),s.length*chrsz));}
function b64_md5(s){return binl2b64(core_md5(str2binl(s),s.length*chrsz));}
function str_md5(s){return binl2str(core_md5(str2binl(s),s.length*chrsz));}
function hex_hmac_md5(key,data){return binl2hex(core_hmac_md5(key,data));}
function b64_hmac_md5(key,data){return binl2b64(core_hmac_md5(key,data));}
function str_hmac_md5(key,data){return binl2str(core_hmac_md5(key,data));}
function md5_vm_test()
{return hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72";}
function core_md5(x,len)
{x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16)
{var olda=a;var oldb=b;var oldc=c;var oldd=d;a=md5_ff(a,b,c,d,x[i+0],7,-680876936);d=md5_ff(d,a,b,c,x[i+1],12,-389564586);c=md5_ff(c,d,a,b,x[i+2],17,606105819);b=md5_ff(b,c,d,a,x[i+3],22,-1044525330);a=md5_ff(a,b,c,d,x[i+4],7,-176418897);d=md5_ff(d,a,b,c,x[i+5],12,1200080426);c=md5_ff(c,d,a,b,x[i+6],17,-1473231341);b=md5_ff(b,c,d,a,x[i+7],22,-45705983);a=md5_ff(a,b,c,d,x[i+8],7,1770035416);d=md5_ff(d,a,b,c,x[i+9],12,-1958414417);c=md5_ff(c,d,a,b,x[i+10],17,-42063);b=md5_ff(b,c,d,a,x[i+11],22,-1990404162);a=md5_ff(a,b,c,d,x[i+12],7,1804603682);d=md5_ff(d,a,b,c,x[i+13],12,-40341101);c=md5_ff(c,d,a,b,x[i+14],17,-1502002290);b=md5_ff(b,c,d,a,x[i+15],22,1236535329);a=md5_gg(a,b,c,d,x[i+1],5,-165796510);d=md5_gg(d,a,b,c,x[i+6],9,-1069501632);c=md5_gg(c,d,a,b,x[i+11],14,643717713);b=md5_gg(b,c,d,a,x[i+0],20,-373897302);a=md5_gg(a,b,c,d,x[i+5],5,-701558691);d=md5_gg(d,a,b,c,x[i+10],9,38016083);c=md5_gg(c,d,a,b,x[i+15],14,-660478335);b=md5_gg(b,c,d,a,x[i+4],20,-405537848);a=md5_gg(a,b,c,d,x[i+9],5,568446438);d=md5_gg(d,a,b,c,x[i+14],9,-1019803690);c=md5_gg(c,d,a,b,x[i+3],14,-187363961);b=md5_gg(b,c,d,a,x[i+8],20,1163531501);a=md5_gg(a,b,c,d,x[i+13],5,-1444681467);d=md5_gg(d,a,b,c,x[i+2],9,-51403784);c=md5_gg(c,d,a,b,x[i+7],14,1735328473);b=md5_gg(b,c,d,a,x[i+12],20,-1926607734);a=md5_hh(a,b,c,d,x[i+5],4,-378558);d=md5_hh(d,a,b,c,x[i+8],11,-2022574463);c=md5_hh(c,d,a,b,x[i+11],16,1839030562);b=md5_hh(b,c,d,a,x[i+14],23,-35309556);a=md5_hh(a,b,c,d,x[i+1],4,-1530992060);d=md5_hh(d,a,b,c,x[i+4],11,1272893353);c=md5_hh(c,d,a,b,x[i+7],16,-155497632);b=md5_hh(b,c,d,a,x[i+10],23,-1094730640);a=md5_hh(a,b,c,d,x[i+13],4,681279174);d=md5_hh(d,a,b,c,x[i+0],11,-358537222);c=md5_hh(c,d,a,b,x[i+3],16,-722521979);b=md5_hh(b,c,d,a,x[i+6],23,76029189);a=md5_hh(a,b,c,d,x[i+9],4,-640364487);d=md5_hh(d,a,b,c,x[i+12],11,-421815835);c=md5_hh(c,d,a,b,x[i+15],16,530742520);b=md5_hh(b,c,d,a,x[i+2],23,-995338651);a=md5_ii(a,b,c,d,x[i+0],6,-198630844);d=md5_ii(d,a,b,c,x[i+7],10,1126891415);c=md5_ii(c,d,a,b,x[i+14],15,-1416354905);b=md5_ii(b,c,d,a,x[i+5],21,-57434055);a=md5_ii(a,b,c,d,x[i+12],6,1700485571);d=md5_ii(d,a,b,c,x[i+3],10,-1894986606);c=md5_ii(c,d,a,b,x[i+10],15,-1051523);b=md5_ii(b,c,d,a,x[i+1],21,-2054922799);a=md5_ii(a,b,c,d,x[i+8],6,1873313359);d=md5_ii(d,a,b,c,x[i+15],10,-30611744);c=md5_ii(c,d,a,b,x[i+6],15,-1560198380);b=md5_ii(b,c,d,a,x[i+13],21,1309151649);a=md5_ii(a,b,c,d,x[i+4],6,-145523070);d=md5_ii(d,a,b,c,x[i+11],10,-1120210379);c=md5_ii(c,d,a,b,x[i+2],15,718787259);b=md5_ii(b,c,d,a,x[i+9],21,-343485551);a=safe_add(a,olda);b=safe_add(b,oldb);c=safe_add(c,oldc);d=safe_add(d,oldd);}
return Array(a,b,c,d);}
function md5_cmn(q,a,b,x,s,t)
{return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b);}
function md5_ff(a,b,c,d,x,s,t)
{return md5_cmn((b&c)|((~b)&d),a,b,x,s,t);}
function md5_gg(a,b,c,d,x,s,t)
{return md5_cmn((b&d)|(c&(~d)),a,b,x,s,t);}
function md5_hh(a,b,c,d,x,s,t)
{return md5_cmn(b^c^d,a,b,x,s,t);}
function md5_ii(a,b,c,d,x,s,t)
{return md5_cmn(c^(b|(~d)),a,b,x,s,t);}
function core_hmac_md5(key,data)
{var bkey=str2binl(key);if(bkey.length>16)bkey=core_md5(bkey,key.length*chrsz);var ipad=Array(16),opad=Array(16);for(var i=0;i<16;i++)
{ipad[i]=bkey[i]^0x36363636;opad[i]=bkey[i]^0x5C5C5C5C;}
var hash=core_md5(ipad.concat(str2binl(data)),512+data.length*chrsz);return core_md5(opad.concat(hash),512+128);}
function safe_add(x,y)
{var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);}
function bit_rol(num,cnt)
{return(num<<cnt)|(num>>>(32-cnt));}
function str2binl(str)
{var bin=Array();var mask=(1<<chrsz)-1;for(var i=0;i<str.length*chrsz;i+=chrsz)
bin[i>>5]|=(str.charCodeAt(i/chrsz)&mask)<<(i%32);return bin;}
function binl2str(bin)
{var str="";var mask=(1<<chrsz)-1;for(var i=0;i<bin.length*32;i+=chrsz)
str+=String.fromCharCode((bin[i>>5]>>>(i%32))&mask);return str;}
function binl2hex(binarray)
{var hex_tab=hexcase?"0123456789ABCDEF":"0123456789abcdef";var str="";for(var i=0;i<binarray.length*4;i++)
{str+=hex_tab.charAt((binarray[i>>2]>>((i%4)*8+4))&0xF)+
hex_tab.charAt((binarray[i>>2]>>((i%4)*8))&0xF);}
return str;}
function binl2b64(binarray)
{var tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str="";for(var i=0;i<binarray.length*4;i+=3)
{var triplet=(((binarray[i>>2]>>8*(i%4))&0xFF)<<16)|(((binarray[i+1>>2]>>8*((i+1)%4))&0xFF)<<8)|((binarray[i+2>>2]>>8*((i+2)%4))&0xFF);for(var j=0;j<4;j++)
{if(i*8+j*6>binarray.length*32)str+=b64pad;else str+=tab.charAt((triplet>>6*(3-j))&0x3F);}}
return str;};function upload_file_with_progress(widget_obj,form_id,field_id,email_visit_id,allowed_file_ext_arr,max_size){var file_input=$('input[type=file]',widget_obj);var files=new Array();if(file_input[0].files){$.each(file_input[0].files,function(index,item){files.push({"name":item.name,"size":item.size});});}else{files.push({"name":file_input.val().split('\\').pop().split('/').pop(),"size":null});}
var errors=new Array();var max_size_in_byte=get_byte_length(max_size);$.each(files,function(index,item){var filename=item['name'];if(!is_allowed_file(filename,allowed_file_ext_arr)){var error=parse_resource_variables(g_emf_resources['js_validation_ext_filename2'],{filename:filename,allowed_types:allowed_file_ext_arr.join(", ")});errors.push(error);}
var size=item['size'];if(size!==null&&max_size_in_byte>0&&size>max_size_in_byte){var error=parse_resource_variables(g_emf_resources['js_validation_max_filesize2'],{filename:filename,max:max_size});errors.push(error);}});if(errors.length>0){alert(errors.join("\n"));return;}
if(support_html5_upload()){$.each(file_input[0].files,function(index,file){new FileUploadProgress(widget_obj,form_id,field_id,email_visit_id,allowed_file_ext_arr,max_size).upload_file_with_html5(file);});}else{new FileUploadProgress(widget_obj,form_id,field_id,email_visit_id,allowed_file_ext_arr,max_size).upload_file();}}
function FileUploadProgress(widget_obj,form_id,field_id,email_visit_id,allowed_file_ext_arr,max_size){var file_input=$('input[type=file]',widget_obj);var filename_input=$('input[type=hidden]',widget_obj);var files_container=$('.emf-upload-files-container',widget_obj);var pbar;var file_item_obj;var iframe_obj;var xhr;var previous_progress;var finished;var canceled;var start_time;var debug=false;var log_id='emf-log-textarea';var log=$('#'+log_id);var self=this;var temp_base_url=get_base_url_by_form_action();var get_progress_url=temp_base_url+'forms/get_upload_progress';var get_unique_id_url=temp_base_url+'forms/get_unique_id';var get_upload_error_url=temp_base_url+'forms/get_upload_error';var upload_url=temp_base_url+'forms/upload/'+form_id+"/"+field_id;var delete_file_url=temp_base_url+'forms/delete_file_by_uid';var uid_field_name='UPLOAD_IDENTIFIER';var file_input_name='file_data';var current_uid=null;this.log=function(message){if(debug){console.debug(message);}};this.upload_file_with_html5=function(file){$.ajax({type:'GET',url:get_unique_id_url,dataType:'jsonp',data:{PHPSESSID:get_g_emf_session_id()},cache:false,success:function(data){var uid=data;self.current_uid=uid;finished=false;self.update_ongoing_count(1);file_item_obj=self.add_file(file['name'],true,uid);var pbar_class='emf-upload-progress-bar';pbar=$('.'+pbar_class,file_item_obj);if(pbar.length==0){file_item_obj.append('<div class="'+pbar_class+'"></div>');}
pbar=$('.'+pbar_class,file_item_obj);pbar.show().progressbar();pbar.progressbar('value',0);var form_data=new FormData();form_data.append(uid_field_name,uid);form_data.append(file_input_name,file);xhr=new XMLHttpRequest();xhr.open('POST',upload_url+"/"+uid+"?PHPSESSID="+get_g_emf_session_id(),true);xhr.withCredentials=true;xhr.upload.onprogress=function(e){if(e.lengthComputable){var value=(e.loaded/e.total)*100;pbar.progressbar('value',value);}};xhr.onload=function(e){finished=true;pbar.progressbar('value',100);if(debug){self.log(uid+' Upload Complete. time cost:'+(new Date().getTime()-start_time));}
self.get_upload_error(uid);};xhr.onerror=function(e){self.update_ongoing_count(-1);self.show_error('Error occurs while uploading.');};xhr.onabort=function(e){self.log('Aborted.');};xhr.send(form_data);}});};this.upload_file=function(){var filename=file_input.val().split('\\').pop().split('/').pop();$(document.body).append("<form method='post' enctype='multipart/form-data'></form>");var form_obj=$("form:last");form_obj.hide();form_obj.append('<input type="hidden" name="'+uid_field_name+'" value="">');file_input.prev().after(file_input.clone());form_obj.append(file_input);file_input.attr("name",file_input_name);form_obj.submit(function(){start_time=new Date().getTime();previous_progress=0;finished=false;self.update_ongoing_count(1);$.ajax({type:'GET',url:get_unique_id_url,dataType:'jsonp',data:{PHPSESSID:get_g_emf_session_id()},cache:false,success:function(data){var uid=data;self.current_uid=uid;file_item_obj=self.add_file(filename,true,uid);var pbar_class='emf-upload-progress-bar';pbar=$('.'+pbar_class,file_item_obj);if(pbar.length==0){file_item_obj.append('<div class="'+pbar_class+'"></div>');}
pbar=$('.'+pbar_class,file_item_obj);pbar.show().progressbar();pbar.progressbar('value',0);$('input[name='+uid_field_name+']',form_obj).val(uid);form_obj.attr('action',upload_url+"/"+uid);var iframe_name='emf-upload-frame-'+uid;$(document.body).append('<iframe style="display:none;" name="'+iframe_name+'"></iframe>');iframe_obj=$('iframe[name='+iframe_name+']');form_obj.attr('target',iframe_name);iframe_obj.unbind('load').bind('load',function(){if(canceled){self.log('Upload Canceled. time cost:'+(new Date().getTime()-start_time));}else{finished=true;pbar.progressbar('value',100);if(debug){self.log(uid+' Upload Complete. time cost:'+(new Date().getTime()-start_time));}
self.get_upload_error(uid);}});form_obj[0].submit();setTimeout(function(){self.update_progress(uid);},500);}});return false;});form_obj.submit();};this.update_progress=function(uid){if(debug){self.log(uid+' update progress:');}
var time=new Date().getTime();$.ajax({type:'GET',url:get_progress_url,dataType:'jsonp',cache:false,data:{'UPLOAD_IDENTIFIER':uid,PHPSESSID:get_g_emf_session_id()},success:function(data){if(debug){self.log(uid+' progress:'+(data));}
if(finished){return;}
var progress=parseInt(data,10);if(previous_progress>0&&progress==0){progress=100;finished=true;}
pbar.progressbar('value',progress);previous_progress=progress;if(debug){self.log(uid+' query progress time cost:'+(new Date().getTime()-time))}
if(!finished){setTimeout(function(){self.update_progress(uid);},500);}}});};this.show_error=function(error){pbar.hide();var control=$('.emf-upload-control',file_item_obj);$('.emf-upload-status',file_item_obj).html("Error: "+error);self.remove_filename(control);control.html(g_emf_resources['js_file_upload_close']).unbind('click').click(function(){self.remove_file(control);});};this.get_upload_error=function(uid){$.ajax({type:'GET',dataType:'jsonp',url:get_upload_error_url+'/'+uid,data:{PHPSESSID:get_g_emf_session_id()},cache:false,success:function(data){var error=data;if(error){self.show_error(error);}else{pbar.hide();var control=$('.emf-upload-control',file_item_obj);control.html(g_emf_resources['js_file_upload_delete']).unbind('click').click(function(){self.remove_file_and_filename(control);});}
if(debug){self.log('status:'+(error==''?'success':error));}
self.update_ongoing_count(-1);post_message_for_frame_height(emf_form_visit_id);}});};this.cancel_upload=function(src_control){finished=true;canceled=true;self.update_ongoing_count(-1);if(xhr!=null){xhr.abort();}else{iframe_obj.attr('src','');}
self.remove_file_and_filename(src_control);};this.is_cloud_file=function(filename){return filename.match(/^https?:\/\//);};this.add_file=function(filename,is_uploading,uid,add_uid){is_uploading=is_uploading==null?false:is_uploading;add_uid=add_uid==null?false:add_uid;self.current_uid=uid;files_container.append("<div class='emf-upload-progress'></div>");var file_item=$('.emf-upload-progress:last',files_container);file_item.append("<a href='javascript:void(0)' class='emf-upload-control'></a>");var control=$('.emf-upload-control',file_item);control.html(is_uploading?g_emf_resources['js_file_upload_cancel']:g_emf_resources['js_file_upload_delete']);control.unbind('click').click(function(){is_uploading?self.cancel_upload(control):self.remove_file_and_filename(control);});var display_filename='';if(this.is_cloud_file(filename)){display_filename="<a href='"+filename+"' target='_blank'>"+filename+"</a>";}else{display_filename=filename;}
file_item.append("<div class='emf-upload-file'>"+display_filename+"</div>");file_item.append("<div class='emf-upload-status'></div>");filename_input.val((filename_input.val().length>0?filename_input.val()+"\n":"")+filename+(is_uploading||add_uid?"\t"+uid:""));post_message_for_frame_height(emf_form_visit_id);return file_item;};this.remove_file_and_filename=function(src_control){if(confirm("Do you really want delete this file ?")){var url=delete_file_url+'/'+self.current_uid;self.log("url:"+url);self.remove_filename(src_control);self.remove_file(src_control);$.ajax({type:'GET',dataType:'jsonp',url:url,data:{PHPSESSID:get_g_emf_session_id()},cache:false,success:function(result){self.log(result);}});}},this.remove_filename=function(src_control){var file_item_obj=src_control.parents('.emf-upload-progress');var index=file_item_obj.index();var str_arr=filename_input.val().split("\n");str_arr.splice(index,1)[0];filename_input.val(str_arr.join("\n"));},this.remove_file=function(src_control){var file_item_obj=src_control.parents('.emf-upload-progress');file_item_obj.remove();post_message_for_frame_height(emf_form_visit_id);},this.update_ongoing_count=function(operand){var form_obj=widget_obj.parents('form');var count_attr="emf-upload-progress-ongoing-count";var count=form_obj.attr(count_attr);count=count==null?0:parseInt(count,10);var original_count=count;count+=operand;form_obj.attr(count_attr,count);$('input[type=submit], button[type=submit]',form_obj).attr("disabled",count>0);self.log('ongiong count:'+count+", operand:"+operand+":"+original_count);}};var empty_string="";function refresh_current_page(clear_browser_cache){if(clear_browser_cache==null){clear_browser_cache=false;}
if(clear_browser_cache){window.location.reload();}else{window.location.href=window.location.href;}}
function show_message(msg){alert(msg);}
function set_void(){return void(0);}
function only_allow_enter_number(obj){if(isNaN(obj.value)){obj.value=empty_string;}}
function hide_element_by_css(element){$("#"+element).css("display","none");}
function show_element_by_css(element){$("#"+element).css("display","block");}
function fix_base_site_url(){if("https:"==document.location.protocol){base_url=base_url.replace('http://','https://');site_url=site_url.replace('http://','https://');internal_base_url=internal_base_url.replace('http://','https://');external_base_url=external_base_url.replace('http://','https://');}else{base_url=base_url.replace('https://','http://');site_url=site_url.replace('https://','http://');internal_base_url=internal_base_url.replace('https://','http://');external_base_url=external_base_url.replace('https://','http://');}}
function get_url_by_base_url(temp_base_url,uri,ssl){fix_base_site_url();var url=temp_base_url;var result=ssl==1?url.replace('http://','https://'):url;return result+'/'+uri;}
function get_site_url(uri,ssl){return get_url_by_base_url(site_url,uri,ssl);}
function get_internal_site_url(uri,ssl){return get_url_by_base_url(internal_base_url,uri,ssl);}
function get_external_site_url(uri,ssl){return get_url_by_base_url(external_base_url,uri,ssl);}
function set_json_undefined_as_blank(json){$.each(json,function(i,n){if(n==null){json[i]='';}});}
function clear_and_set_value(obj,value){$(obj).val(empty_string);$(obj).val(value);}
function is_url(str,ignore_default){str=$.trim(str);if(ignore_default==true){if(str==''||str=='http://'||str=='https://'){return true;}}
if(str!=''){var strRegex=/^((https?|ftp):\/\/)?(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;var re=new RegExp(strRegex);return re.test(str);}}
function is_email(str){if(str!=''){var strRegex=/^[0-9a-zA-Z_\-\+\.]+@[0-9a-zA-Z_\-]+(\.[0-9a-zA-Z_\-]+)*$/;var re=new RegExp(strRegex);return re.test(str);}}
function set_corner(){}
function set_tooltips(di){$(".emf-tooltip").each(function(){var item=$(this);item.tooltip({items:"[title],[rel]",position:{my:"left+15 center",at:"right bottom"},content:!is_empty_str(item.attr('rel'))?item.attr('rel'):item.attr('title'),close:function(event,ui){ui.tooltip.click(function(){$(this).stop(true).fadeTo(400,1);},function(){$(this).fadeOut("400",function(){$(this).remove();})});}});});}
function show_tooltip(a){if($("#emf-tooltip").length){hide_tooltip("#emf-tooltip")}
var style='display: none;text-align:left;'
if(a.id){style=style+'top:250px;left:550px;';}
var t=a.title;var bottom_close='',top_close='';if(t==''){bottom_close='<br><b style="text-align:right;cursor:pointer;padding-left:4px;padding-right:4px;">Close</b>';top_close='';}else{top_close="<td width='1%' style='cursor:pointer;padding-right:4px;'>X</td>";bottom_close='';}
var b="<table onclick=\"hide_tooltip(this);return false;\" id=\"emf-tooltip\" style=\""
+style+"\"><tr><td width='99%'>"+"<b>"+a.title+"</b></td>"+top_close+"</tr>"
+"<tr><td colspan='2'><em>"+(a.rel).replace('<','&lt;')
+"</em>"+bottom_close+"</td></tr></table>";$(b).insertAfter(a).show("fast");}
function hide_tooltip(a){$(a).fadeOut("fast",function(){$(this).remove();})}
function FormDataGuarder(getDataStringCallBack,bindOnBeforeUnloadEvent){var myThis=this;this.ignored=false;if(typeof bindOnBeforeUnloadEvent=='undefined'){bindOnBeforeUnloadEvent=true;}
function getDesc(dataObj){var result="";if(dataObj!=null){for(name in dataObj){result+=name+":"+dataObj[name]+"\n";}}
return result;}
function getValueOfControl(control){var result=null;if(control.tagName.toLowerCase()=='input'&&(control.type=='radio'||control.type=='checkbox')){if(control.checked==true){result=control.value;}}else{result=control.value;}
return result;}
function hasChanges(){var result=false;var currFormData=getDataStringCallBack();result=previousData!=currFormData;return result;}
function cloneObject(obj){var result=null;if(obj!=null){result=new Object();for(name in obj){result[name]=obj[name];}}
return result;}
function checkUnSavedChanges(e){if(!myThis.ignored&&hasChanges()){return"YOU HAVEN'T SAVED YET AND YOU'LL BE ABANDONING YOUR CHANGES.";}}
this.checkUnSavedChanges=checkUnSavedChanges;var previousData=getDataStringCallBack();if(bindOnBeforeUnloadEvent){window.onbeforeunload=checkUnSavedChanges;}}
function closeAllValidationPrompt(){close_validation_prompt();}
function validateForm(form_id){return $("#"+form_id).validationEngine({scroll:false,returnIsValid:true});}
function isEmail(email){var left_bracket_pos=email.indexOf('<');var right_bracket_pos=email.indexOf('>');if((left_bracket_pos!==-1)&&(right_bracket_pos!==-1)){var new_email=email.substr(left_bracket_pos+1,right_bracket_pos-left_bracket_pos-1);}else{var new_email=email;}
var email_regex=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return email_regex.test(new_email);}
var captcha_code_md5='';function valid_captcha(){var temp_code=$.trim($('#captcha_code').val());return hex_md5(temp_code.toLowerCase())!=captcha_code_md5;}
function get_valid_captcha(){var temp_base_url=get_base_url_by_form_action();$.ajax({url:get_url_by_base_url(temp_base_url,'forms/check_captcha_code_by_jsonp'),dataType:'jsonp',data:{captcha_code:'',PHPSESSID:get_g_emf_session_id()},success:function(response){response=response||{};captcha_code_md5=response.code;},error:function(XMLHttpRequest,textStatus,errorThrown){alert("Error occurs when get captcha: "+textStatus);}});}
function on_captcha_image_load(){$('#captcha_image').css('visibility','visible');get_valid_captcha();}
function force_cookie_for_captcha(){$(document.body).append('<iframe id="emf_safari_session_iframe" name="emf_safari_session_iframe" src="'+get_site_url('forms/force_safari_cookies')+'" style="display:none;"></iframe>'
+'<form id="emf_safari_session_form" enctype="application/x-www-form-urlencoded" action="'+get_site_url('forms/force_safari_cookies')+'" target="emf_safari_session_iframe" method="post"></form>');$('#emf_safari_session_iframe').bind('load',function(){if($(this.contentWindow.document.body).html()=='POST'){$('#captcha_code_refresh').click();}});$('#emf_safari_session_form').submit();}
function in_array(v,a){return jQuery.inArray(v,a)>=0;}
function url_ex(caller,p){var ignore=true;if(p){ignore=p[0]!='required'}
return!is_url($(caller).val(),ignore);}
function validate_min_max(caller){var result={is_error:false,message:''};var container=$(caller).parents('.emf-element-range');var min_obj=container.find('input[property=range_min]');var max_obj=container.find('input[property=range_max]');var min_value=parseInt(min_obj.val());var max_value=parseInt(max_obj.val());if(min_value&&max_value){if(min_value>max_value){result.is_error=true;result.message='* The maximum value must be equal or greater than the minimum value';}}
if(result.is_error==false){$.each([min_obj,max_obj],function(){$.validationEngine.closePrompt(this);});}
return result;}
function escape_html_tag(html){if(html==null){return html;}
html=html.replace(/</g,'&lt;');html=html.replace(/>/g,'&gt;');return html;}
function escape_script_tag(html){if(html==null){return html;}
html=html.replace(/<script/gi,'&lt;script');html=html.replace(/<\/script/gi,'&lt;/script');return html;}
function escape_jquery_selector(str){if(str){return str.replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,'\\$1')}else{return str;}}
function get_safe_html(html){if(html==null){return null;}
var temp=typeof html;html=html.toString();html=html.replace(/</g,'&lt;');html=html.replace(/>/g,'&gt;');html=html.replace(/"/g,'&quot;');html=html.replace(/'/g,'&apos;');return html;}
function array_remove(arr,to_remove_arr){if(arr==null||to_remove_arr==null){return arr;}
var result=new Array();for(var i=0;i<arr.length;i++){if(jQuery.inArray(arr[i],to_remove_arr)==-1){result[result.length]=arr[i];}}
return result;}
function show_choice(src_element){var tab_index=-1;var count=0;$(src_element).parent().find(src_element.tagName).each(function(){if(src_element==this){tab_index=count;return false;}
count++;});$(src_element).parent().find('.emf-my-choices').each(function(index,value){$(this).find('input,select,textarea').attr('disabled',tab_index!=index);$(this).toggle(tab_index==index);});}
var my_events_listeners=new Object();function fire_my_event(event){var stop_on_first_error=true;var listeners=my_events_listeners[event];var result=new Array();if(listeners!=null){for(var i=0;i<listeners.length;i++){var error=listeners[i].apply(null,arguments);if(error){result[result.length]=error;}
if(stop_on_first_error&&error){break;}}}
return result;}
function add_my_listener(event,func){var listeners=my_events_listeners[event];if(listeners==null){listeners=[];my_events_listeners[event]=listeners;}
listeners.push(func);}
function clone(obj){var result=jQuery.extend(true,{},obj);return result;}
function plain_to_html(v){return v.replace(/</gi,'&lt;').replace(/>/gi,'&gt;');}
function html_to_plain(v){return v.replace(/&lt;/gi,'<').replace(/&gt;/gi,'>').replace(/&quot;/gi,'"').replace(/&amp;/gi,'&');}
function set_form_hidden_field(form_obj,name,value){if($('input[name='+name+']',form_obj).length==0){$(form_obj).append("<input type='hidden' name='"+name+"'>");}
$('input[name='+name+']',form_obj).val(value);}
function submit_form(form,fire_onsubmit){fire_onsubmit=fire_onsubmit==null?false:fire_onsubmit;if(fire_onsubmit&&form.onsubmit!=null&&form.onsubmit()){form.submit();}else{form.submit();}}
function highlight_field(li_obj,not_focus){var editable=$(li_obj).hasClass("data_container");if(editable){var class_name='highlight-field';$(li_obj).parent('ul').find('li').removeClass(class_name);$(li_obj).addClass(class_name);}}
function highlight_field_on_focus(){highlight_field($(this).parents('li')[0],true);}
function highlight_field_on_mousedown(event){var not_focus=false;if(event.target&&event.target.tagName){not_focus=$.inArray(event.target.tagName.toLowerCase(),['input','textarea','select'])>-1;}
highlight_field(this,not_focus);}
function log_for_debug(msg){var id="log_for_debug_div";var obj=null;if($("#"+id).length==0){obj=$(document.body).append("<div id='"+id+"' style='border:1px solid gray;margin:10px;'></div>");}
obj=$("#"+id);obj.html(obj.html()+"<BR>"+msg);}
function get_frame_height(adjust_height){var scroll_height=get_scroll_height();var client_height=get_client_height();var result;if(scroll_height===undefined){result="100%";}else if(Math.abs(scroll_height-client_height)>0){result=scroll_height;if(adjust_height){result+=adjust_height;}
result+="px";}
return result;};function get_scroll_height(){var height;var margin=$(document.body).outerHeight(true)-$(document.body).outerHeight();try{if(document.body){if(document.body.scrollHeight){height=document.body.scrollHeight;}else if(document.body.offsetHeight){height=document.body.offsetHeight;}
height+=margin;}else if(document.documentElement&&document.documentElement.scrollHeight){height=document.documentElement.scrollHeight;}else if(document.height){height=document.height;}}catch(e){alert('error:'+e)}
return height;};function get_client_height(){var height=0;try{if(window.innerHeight){height=window.innerHeight-18;}else if((document.documentElement)&&(document.documentElement.clientHeight)){height=document.documentElement.clientHeight;}else if((document.body)&&(document.body.clientHeight)){height=document.body.clientHeight;}}catch(e){}
return height;};function get_frame_width(adjust_width){var scroll_width=get_scroll_width();var client_width=get_client_width();var result;if(scroll_width===undefined){result="100%";}else if(Math.abs(scroll_width-client_width)>0){result=scroll_width;if(adjust_width){result+=adjust_width;}
result+="px";}
return result;};function get_scroll_width(){var width;var margin=$(document.body).outerWidth(true)-$(document.body).outerWidth();try{if(document.documentElement&&document.documentElement.scrollWidth){width=document.documentElement.scrollWidth;}else if(document.width){width=document.width;}else if(document.body){if(document.body.scrollWidth){width=document.body.scrollWidth;}else if(document.body.offsetWidth){width=document.body.offsetWidth;}
width+=margin;}}catch(e){alert('error:'+e)}
return width;};function get_client_width(){var width=0;try{if(window.innerWidth){width=window.innerWidth-18;}else if((document.documentElement)&&(document.documentElement.clientWidth)){width=document.documentElement.clientWidth;}else if((document.body)&&(document.body.clientWidth)){width=document.body.clientWidth;}}catch(e){}
return width;};function show_element_of_group(display_obj,group_obj){group_obj.css('display','none').find(':input').attr('disabled','disabled');group_obj.filter(':input').attr('disabled','disabled');display_obj.css('display','block').find(':input').removeAttr('disabled');display_obj.filter(':input').removeAttr('disabled');}
function get_null_safe_string(str){return(str==null||typeof str=='undefined')?"":str;}
function get_validation_class(element){var result='';var control_obj=$(element);var class_str=control_obj.attr('class');if(class_str){var reg_exp=/(validate\[.*\])/;var reg_exp_result=reg_exp.exec(class_str);if(reg_exp_result&&reg_exp_result.length>=2){result=reg_exp_result[1];}}
return result;}
function close_validation_prompt(animation){if(typeof animation=='undefined'){animation=true;}
if(animation){$.validationEngine.closePrompt(".formError",animation);}else{$(".formError").remove();}}
function has_property(obj){var result=false;for(key in obj){result=true;break;}
return result;}
function get_current_url_without_hash(){var url=document.location.href.replace(/#.*$/,'');return url;}
function post_message_for_frame_height(id){var parent_url=decodeURIComponent(document.location.hash.replace(/^#/,''));var frame_height=get_frame_height();var temp_id="";if(typeof id!='undefined'){temp_id=id;}
var message="resize"+","+frame_height+","+temp_id;if(!frame_height){setTimeout(function(){post_message_for_frame_height(id);},500);}else{XD.postMessage(message,parent_url,parent);}}
function post_message_for_scroll_to_error(id){if(!$.validationEngine.settings.scroll){return;}
var parent_url=decodeURIComponent(document.location.hash.replace(/^#/,''));var destination=$(".formError:not('.greenPopup'):first").offset().top;$(".formError:not('.greenPopup')").each(function(){testDestination=$(this).offset().top;if(destination>testDestination){destination=$(this).offset().top;}})
var message="scroll_to"+","+destination+","+(typeof id=='undefined'?"":id);if(typeof XD!='undefined'){XD.postMessage(message,parent_url,parent);}}
function post_message_for_frame_dimension(id){var frame_width=get_frame_width();var frame_height=get_frame_height();if(!frame_width||!frame_height){setTimeout(function(){post_message_for_frame_dimension(id)},500);}else{var parent_url=decodeURIComponent(document.location.hash.replace(/^#/,''));XD.postMessage(id+","+frame_width+","+frame_height,parent_url,parent);}}
function post_message_for_scroll(id){var frame_width=get_frame_width();var frame_height=get_frame_height();var parent_url=decodeURIComponent(document.location.hash.replace(/^#/,''));XD.postMessage(id+","+frame_width+","+frame_height,parent_url,parent);}
function show_thick_box(button_id){$('#'+button_id).click();set_corner();$('#TB_ajaxContent .TB_content .TB_content_button').css({"margin":"30px auto 0 auto","text-align":"center"});}
function is_scrolled_into_view(elem){var doc_view_top=$(window).scrollTop(),doc_view_bottom=doc_view_top+$(window).height(),element_top=$(elem).offset().top,element_bottom=element_top+$(elem).height();return element_top>=doc_view_top&&element_bottom<=doc_view_bottom;}
function has_margin_to_view_bottom(elem,margin){var doc_view_top=$(window).scrollTop(),doc_view_bottom=doc_view_top+$(window).height(),element_top=$(elem).offset().top,element_bottom=element_top+$(elem).height();return element_bottom+margin<=doc_view_bottom;}
function has_margin_to_view_top(elem,margin){var doc_view_top=$(window).scrollTop(),doc_view_bottom=doc_view_top+$(window).height(),element_top=$(elem).offset().top,element_bottom=element_top+$(elem).height();return element_top-margin>=doc_view_top;}
function get_url_parameter(param_name){var search_string=window.location.search.substring(1);var params=search_string.split("&");for(var i=0;i<params.length;i++){var val=params[i].split("=");if(val[0]==param_name){return unescape(val[1]);}}
return null;}
function trim_quote_blank(str){var result=$.trim(str);if(result!=null&&result.length>=2){quote_chars=['"',"'"];$.each(quote_chars,function(){if(result.charAt(0)==this&&result.charAt(result.length-1)==this){result=result.substr(1,result.length-2);return false;};});}
return result;}
function get_css_map(css_str){var result={};if(css_str){var attributes=css_str.split(";");for(var i=0;i<attributes.length;i++){var val=attributes[i].split(":");if(val==null){val='';}
var name=$.trim(val[0].toLowerCase());if(name){result[name]=trim_quote_blank(val[1]);}}}
return result;}
function expand_border_css(css_map){var border=get_null_safe_string(css_map['border']);var border_parts=border.split(' ');if(border_parts&&border_parts.length>=3){if(is_empty_str(css_map['border-width'])){css_map['border-width']=border_parts[0];}
if(is_empty_str(css_map['border-style'])){css_map['border-style']=border_parts[1];}
if(is_empty_str(css_map['border-color'])){var value=border_parts.slice(2).join(' ');css_map['border-color']=value;}}
return css_map;}
function get_css_attribute(css_str,param_name){var css_map=get_css_map(css_str);param_name=param_name.toLowerCase();return typeof css_map[param_name]=='undefined'?null:css_map[param_name];}
function select_item_in_group(selected_item_obj,group_selector,selected_class){selected_class=selected_class==null?"selected":selected_class;$(group_selector).removeClass(selected_class);$(selected_item_obj).addClass(selected_class);}
function select_item_in_group_by_index(selected_index,group_selector,selected_class){select_item_in_group($(group_selector).eq(selected_index),group_selector,selected_class);}
function is_empty_str(str){return typeof str=='undefined'||str===null||str==='';}
function is_empty_mysql_date(mysql_date_str){return is_empty_str(mysql_date_str)||mysql_date_str=='0000-00-00 00:00:00';}
function left_trim_char(str,to_trim_char){if(str==null){return null;}
var result='';var i;for(i=0;i<str.length;i++){var char=str.charAt(i);if(char!=to_trim_char){break;}}
result=str.substr(i);return result;}
function left_pad_char(str,to_pad_char,target_str_length){str=str==null?"":str;var result=str;for(var i=0;i<target_str_length-str.length;i++){result=to_pad_char+result;}
return result;}
function nl2br(value){if(value){return value.replace(/\n/g,"<br/>");}else{return value;}}
function show_ckeditor(editor_obj,properties){editor_obj.each(function(){var id=$(this).attr("id");var name=$(this).attr("name");var instance_id=id?id:name;if(CKEDITOR.instances[instance_id]){CKEDITOR.instances[instance_id].destroy();}});editor_obj.ckeditor(function(){},properties);}
function is_allowed_file(filename,allowed_file_ext_arr){var result=true;if(!allowed_file_ext_arr){return result;}
allowed_file_ext_arr=trim_array(allowed_file_ext_arr);var parts=filename.split('.');var extension=null;if(parts.length>1){extension=parts.pop();}
if(!extension){result=false;}else{result=$.inArray(extension.toLowerCase(),allowed_file_ext_arr)>-1;}
return result;}
function check_file_error(caller,params){var is_error=false;var message="";var allowed_file_ext_arr=null;if(params&&params[0]){allowed_file_ext_arr=params[0].split("|");}
if(allowed_file_ext_arr&&allowed_file_ext_arr!='null'&&!/^[0-9]+M$/.exec(allowed_file_ext_arr)){var file_type_desc=allowed_file_ext_arr.join(", ");var is_error=!is_allowed_file($(caller).val(),allowed_file_ext_arr);if(is_error){message+=(message?"<BR>":"")+parse_resource_variables(g_emf_resources['js_validation_ext_filename'],{allowed_types:file_type_desc});}}
var max_size=null;var max_size_in_byte=null;if(params&&params[1]){max_size=params[1];var max_size_in_byte=get_byte_length(max_size);}
if(caller.files&&max_size_in_byte>0){for(var i=0;i<caller.files.length;i++){var file=caller.files[i];if(file.size>max_size_in_byte){is_error=true;message+=(message?"<BR>":"")+parse_resource_variables(g_emf_resources['js_validation_max_filesize'],{max:max_size});break;}}}
return{"is_error":is_error,"message":message};}
function get_byte_length(length_str){var str=$.trim(length_str.toUpperCase());var unit=str.substr(str.length-1);var times=1;switch(unit){case'B':times=1;break;case'K':times=1024;break;case'M':times=1024*1024;break;case'G':times=1024*1024*1024;break;default:times=0;}
nubmer=str.substr(0,str.length-1);result=nubmer*times;return result;}
function support_html5_upload(){var result=false;try{result=FormData!=null;}catch(E){}
return result;}
function do_smart_captcha_for_login(form_obj){$('#my-recaptcha-container').hide();form_obj.append("<input type='hidden' name='javascript_executed' value='true'>");$.ajax({url:get_site_url('authenticator/if_show_smart_captcha'),dataType:'jsonp',data:{dummy:'dummy'},success:function(response){var show_captcha=response;$('#my-recaptcha-container').toggle(show_captcha);},error:function(XMLHttpRequest,textStatus,errorThrown){}});}
function capitalize_first_char(str){if(str==null){return str;}
var result=str.slice(0,1).toUpperCase()+str.slice(1,str.length);return result;}
function get_jquery_property(element,name){return $(element).prop?$(element).prop(name):$(element).attr(name);}
function get_cookie(c_name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++){x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==c_name){return unescape(y);}}}
function set_cookie(c_name,value,exdays){var exdate=new Date();exdate.setDate(exdate.getDate()+exdays);var c_value=escape(value)+((exdays==null)?"":"; expires="+exdate.toUTCString());document.cookie=c_name+"="+c_value;}
function unique_field_value(caller,params){var group=$(caller).attr("group");var is_error=false;if(group){$(caller).parents("form").find('[group='+group+']:input').each(function(){if(caller!=this&&$(caller).val()!==""&&$(caller).val()===$(this).val()){is_error=true;return false;}});}
return is_error;}
function get_domain_url(append_last_slash){if(typeof append_last_slash=='undefined'){append_last_slash=true;}
var re=new RegExp("^http[s]?://[^/]+"+(append_last_slash?"/":""));var matches=re.exec(base_url);var result=null;if(matches){result=matches[0];}
return result;}
function get_url_path(){var re=new RegExp("^http[s]?://.+/");var matches=re.exec(window.location.href);var result=null;if(matches){result=matches[0];}
return result;}
function get_https_url(relative_url){var result=null;if(is_empty_str(relative_url)){return null;}
var temp_base_url=null;if(relative_url.indexOf('/')==0){temp_base_url=get_domain_url(false);}else{temp_base_url=get_url_path();}
result=temp_base_url.replace(new RegExp("^http://","i"),"https://")+relative_url;return result;}
function has_url_protocol_part(url){var re=new RegExp("^(https?|ftp)://","i");return re.test(url);}
function get_host_by_url(url){var re=new RegExp("^http[s]?://([^/]+)");var matches=re.exec(url);var result=null;if(matches){result=matches[1];}
return result;}
function is_cloud_file(filename){return!is_empty_str(filename)?new RegExp("^https?://","i").test(filename):false;}
function emf_grid_formatter(cell_value,options,row_object){if(typeof cell_value=='undefined'||is_empty_str(cell_value)){return"";}
var delimiter="<br \/>";var parts=cell_value.split(delimiter);var is_cloud_file_value=false;var files=new Array();$.each(parts,function(){var href=has_url_protocol_part(this)?this:("http://"+this);files.push(is_cloud_file(this)?("<a class='emf-grid-data-link' href='"+href+"' target='_blank'>"+this+"</a>\n"):this);is_cloud_file_value=is_cloud_file_value||is_cloud_file(this);});var result=is_cloud_file_value?files.join(""):cell_value;return result;}
function validate_gateway(caller,params){var is_error=false;var message="";if($(caller).val()=="0"){is_error=true;message="please choose gateway type";}
return{"is_error":is_error,"message":message};}
function val_not_free_plan(caller,params){var is_error=false;var message="";if($(caller).val()=="0"){is_error=true;message="can't choose FREE plan.";}
return{"is_error":is_error,"message":message};}
function required_buyer_if_paypal(caller,params){var is_error=false;var message="";if($("#gateway_type").val()=="2"&&$(caller).val()==""){is_error=true;message="paypal buyer is required for PAYPAL gateway.";}
return{"is_error":is_error,"message":message};}
function fix_jquery_bug_on_ie_style(){if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined;},set:function(elem,value){return(elem.style.cssText=value+"");}};}}
function do_general_smart_captcha(smart_captcha_url,form_obj){$('#my-recaptcha-container').hide();form_obj.append("<input type='hidden' name='javascript_executed' value='true'>");$.ajax({url:get_site_url(smart_captcha_url),dataType:'jsonp',data:{dummy:'dummy'},success:function(response){var show_captcha=response;$('#my-recaptcha-container').toggle(show_captcha);},error:function(XMLHttpRequest,textStatus,errorThrown){}});}
function makeObjectsOpaqueForDialog(){var elementToAppend=document.createElement('param');elementToAppend.setAttribute('name','wmode');elementToAppend.setAttribute('value','opaque');var objects=document.getElementsByTagName('object');for(var i=0;i<objects.length;i++){var newObject=objects[i].cloneNode(true);elementToAppend=elementToAppend.cloneNode(true);newObject.appendChild(elementToAppend);objects[i].parentNode.replaceChild(newObject,objects[i]);}}
function pad_str(str,length,pad_str){if(str==null||length==null||length<=str.length){return str;}
str+="";var result=str;var pad_times=length-str.length;for(var i=0;i<pad_times;i++){result=pad_str+result;}
return result;}
function get_form_element_value_arr(additional_selector,container_obj){additional_selector=additional_selector==null?"":additional_selector;var result=[];$(':input'+additional_selector+':not(:disabled)',container_obj).filter(':not([type=radio]):not([type=checkbox]):not(select[multiple]), [type=radio]:checked, [type=checkbox]:checked').map(function(){result.push($(this).val());});$('select[multiple]'+additional_selector+':not(:disabled) option:selected',container_obj).map(function(){result.push($(this).val());});return result;}
var g_unique_id_map=new Array();function get_next_unique_id(key){if(g_unique_id_map[key]==null){g_unique_id_map[key]=0;}
return g_unique_id_map[key]++;}
function check_sum(caller,params){var result={is_error:false,message:''};var container=$(caller).parents(".emf-li-field");var sum=null;$("input",container).each(function(){var value_str=$.trim($(this).val());if(!is_empty_str(value_str)){var value=parseFloat($.trim($(this).val()));if(isNaN(value)){sum=null;return false;}else{sum+=value;}}});var target_sum=params[0];if(sum!=target_sum){result.is_error=true;var not_applicable=parse_resource_variables(g_emf_resources['js_validation_not_applicable']);result.message=parse_resource_variables(g_emf_resources['js_validation_check_sum'],{target_sum:target_sum,current_sum:(sum==null?not_applicable:sum)});}
if(result.is_error==false){$.each($("input",container),function(){$.validationEngine.closePrompt(this);});}
return result;}
function parse_selected_date(date_text){if(is_empty_str(date_text)){date_text="";}
var is_mm_dd_format=true;var result=new Object();var parts=date_text.split('/');result['day']=$.trim(parts[is_mm_dd_format?1:0]);result['month']=$.trim(parts[is_mm_dd_format?0:1]);result['year']=$.trim(parts[2]);return result;}
function visit_tree_node_recursively(node,callback_for_node){if(typeof node['level']=='undefined'){node['level']=1;}
if(callback_for_node){callback_for_node(node);}
var children=node['children'];if(children&&!$.isArray(children)){for(key in children){visit_tree_node_recursively({name:key,children:children[key],level:node['level']+1},callback_for_node);}}}
function visit_tree_in_level_order(node,callback){var queue=new Array();node['level']=1;queue.push(node);while(queue.length>0){var temp_node=queue.shift();if(callback){callback(temp_node);}
var children=temp_node['children'];if(children&&!$.isArray(children)){for(key in children){queue.push({name:key,children:children[key],level:temp_node['level']+1});}}}}
function get_options_html_for_node(node,add_blank_option){var options=get_object_keys(node);if(options.length>0&&add_blank_option){options=[""].concat(options);}
var option_html="";for(var i=0;i<options.length;i++){option_html+="<option value='"+get_safe_html(options[i])+"'>"+get_safe_html(options[i])+"</option>\n";}
return option_html;}
function get_object_keys(obj){var result=[];for(var key in obj){result.push(key);}
return result;}
function reorder_obj_properties(obj,order){var keys=get_object_keys(obj);if(order=='alphabetical'){keys.sort();}else if(order=='random'){keys.sort(sort_with_random_order);}
var result={};$.each(keys,function(){result[this]=obj[this];});return result;}
function sort_with_random_order(element_1,element_2){var result=0;var obj1=$(element_1);var obj2=$(element_2);if(obj1.attr('my_order_property')=='first'||obj2.attr('my_order_property')=='last'){result=-1;}else if(obj1.attr('my_order_property')=='last'||obj2.attr('my_order_property')=='first'){result=1;}else{result=Math.random()>0.5?1:-1;}
return result;}
function get_level_count_of_tree(option_tree){var level_count=0;visit_tree_in_level_order({name:'root',children:option_tree},function(node){level_count=Math.max(node['level'],level_count);});return level_count-1;}
function build_drill_down_widget(container,option_tree,init_params,option_order,widget_type){if(typeof init_params=='undefined'){init_params=null;}
if(typeof option_order=='undefined'){option_order=null;}
if(typeof widget_type=='undefined'){widget_type='dropdown';}
var add_blank_option=widget_type=='dropdown';var level_count=get_level_count_of_tree(option_tree);var str='';var result="";for(var i=0;i<level_count;i++){result+="<select size='"+(widget_type=='dropdown'?1:4)+"'></select>";}
container.html(result);var first_level_options=reorder_obj_properties(option_tree,option_order);container.find('select:first').html(get_options_html_for_node(first_level_options,add_blank_option));container.find('select').change(function(){if(!$(this).next()){return;}
$(this).nextAll().html('');var curr_node=option_tree;var prev_selects=$(this).prevAll();for(var i=prev_selects.length-1;i>-1;i--){var value=$(prev_selects[i]).val();if(value==null||curr_node[value]==null){break;}
curr_node=curr_node[value];}
var options=curr_node[$(this).val()];options=reorder_obj_properties(options,option_order);$(this).next().html(get_options_html_for_node(options,add_blank_option));});if(init_params!=null){container.find('select').each(function(index,item){var params=init_params[index];var self=this;if(typeof params!='undefined'){var map_attrs=['class','name','id'];$.each(map_attrs,function(index,item){if(typeof params[item]!='undefined'){$(self).attr(item,params[item]);}});if(typeof params['value']!='undefined'){$(this).val(params['value']).change();}}});}}
function randomize_children(obj){var children=obj.children();var temp_property_name='_temp_property_for_random_order_selected';children.each(function(){this[temp_property_name]=$(this).attr('selected');});children.detach();children.sort(sort_with_random_order);obj.append(children);$.each(children,function(){if(this[temp_property_name]){$(this).attr('selected',this[temp_property_name]);}});}
function randomize_table_rows(table_obj){var tr_arr=table_obj.find('tbody').children();tr_arr.detach();tr_arr.sort(sort_with_random_order);var row_count=1;tr_arr.each(function(){$(this).removeClass("emf-banding-odd").removeClass("emf-banding-even").addClass(row_count%2==0?"emf-banding-even":"emf-banding-odd");row_count++;});table_obj.append(tr_arr);}
function randomize_table_columns(table_obj){var head_row=table_obj.find('thead tr');var head_tds=head_row.children();var index_property='_temp_property_for_index';$.each(head_tds,function(index,item){this[index_property]=index;})
head_tds.sort(sort_with_random_order);head_tds.detach();head_row.append(head_tds);var index_conversion_map=[];$.each(head_tds,function(index,item){index_conversion_map[item[index_property]]=index;});var body_row=table_obj.find('tbody tr');body_row.each(function(){var children=$(this).children();children.sort(function(element1,element2){var obj1=$(element1);var obj2=$(element2);return index_conversion_map[obj1.index()]-index_conversion_map[obj2.index()];});children.detach();$(this).append(children);});}
function DebugTimer(){var start_time=new Date().getTime();var temp_time=start_time;var markers=[];this.mark=function(label){if(typeof label=='undefined'){label="";}
markers.push({label:label,time:new Date().getTime()-temp_time});temp_time=new Date().getTime();}
this.list=function(){var str="";var total=0;$.each(markers,function(){str+=this.label+": "+this.time+"\n";total+=this.time;});str+="total: "+total;return str;}}
function show_operation_ongoing_dialog(title){if(typeof title=='undefined'){title='Operation Ongoing';}
var id='operation_ongoing_dialog';if($('#'+id).length==0){var html='<div id="'+id+'">'+'<div>'+' <p>'+get_safe_html(title)+'...</p>'+' <img src="'+get_assets_url('images/loadingAnimation.gif')+'" />'+'</div>'+'</div>';$(document.body).append(html);}
$('#'+id).show();}
function hide_operation_ongoing_dialog(){var id='operation_ongoing_dialog';$('#'+id).hide();}
function add_javascript_field(form_obj){form_obj.append("<input type='hidden' name='javascript_executed' value='true'>");}
function prevent_duplicate_submission(form_obj){form_obj.submit(function(){var property_name='emf_submitting_time';var submitting_time=form_obj.attr(property_name);var INTERVAL=10*1000;if(submitting_time!=null){var waited_time=new Date().getTime()-submitting_time;if(waited_time<INTERVAL){var rest_time=Math.round((INTERVAL-waited_time)/1000);alert("Form data is being submitted, please wait. If there is a problem with the submission, please try again in "+rest_time+" seconds.");return false;}}
form_obj.attr(property_name,new Date().getTime());return true;});}
function bind_auto_cursor(input_objs){input_objs.keyup(function(event){var key_str=String.fromCharCode(event.keyCode);var is_word_character=key_str.match(/\w/);if(!is_word_character){return;}
var maxlength=$(this).attr('maxlength');if(!isNaN(maxlength)){maxlength=parseInt(maxlength);}
if(this.value.length==maxlength){var current_element=this;var current_index=null;input_objs.each(function(index,item){if(item==current_element){current_index=index;return false;}});input_objs.eq(current_index+1).focus();}});}
function get_property_count(obj){var count=0;for(var key in obj){count++;}
return count;}
function fix_check_box_on_change_event(){$('input[type=checkbox]').click(function(){$(this).trigger('change')});}
function toggle_element_with_validation(element_obj,visible,switch_name,ignore_switch,ignore_disabled_attr){if(switch_name==null){switch_name='my_default_switch';}
if(ignore_switch==null){ignore_switch=false;}
if(ignore_disabled_attr==null){ignore_disabled_attr=false;}
element_obj.toggle(visible);var condition=":input:not([type=button])";var input_objs=$.merge(element_obj.filter(condition),$(condition,element_obj));var switch_property="my_switches";input_objs.each(function(index,element){var element_visible;if(ignore_switch){element_visible=visible;if(element_visible&&$(element).filter(':visible').length==0){return;}}else{element_visible=true;if(element[switch_property]==null){element[switch_property]={};}
element[switch_property][switch_name]=visible;for(var key in element[switch_property]){element_visible=element_visible&&element[switch_property][key];}}
if(!element_visible){if(!ignore_disabled_attr){if($(element).attr('temp_disabled')==null){$(element).attr('temp_disabled',$(element).attr('disabled')=='disabled'?"1":"0");}
$(element).attr('disabled','disabled');}
$(element).filter('[class*=validate]').each(function(index2,element2){var validation_class=get_validation_class(element2);$(element2).attr('temp_validation_def',get_validation_class(element2)).removeClass(validation_class);});}else{if(!ignore_disabled_attr){if($(element).attr('temp_disabled')=="1"){$(element).attr('disabled','disabled');}else if(!$(element).is('input[type="file"]')||$(element).is(':visible')){$(element).removeAttr('disabled');}}
$(element).filter('[temp_validation_def]').each(function(index2,element2){var temp_validation_def=$(element2).attr("temp_validation_def");if(temp_validation_def){$(element2).addClass(temp_validation_def);}});}});if(!visible){close_validation_prompt();}}
function toggle_element_disabled(element_obj,disabled){if(element_obj.is(':input')){element_obj.attr('disabled',disabled);}
element_obj.find(':input').attr('disabled',disabled);element_obj.find(':input').each(function(){element_obj.find('label[for='+$(this).attr('id')+']').toggleClass('disabled',disabled);})}
function required_by_attr_flag(caller,params){var is_error=false;var message="";var check_required=$(caller).attr("requiredflag")=='true';if(check_required&&$(caller).val()==''){message="* This field is required";is_error=true;}
return{"is_error":is_error,"message":message};}
function parse_resource_variables(template,name_value_map){var result="";if(!is_empty_str(template)){for(var i=0;i<template.length;){var match_result=false;if(template[i]=='{'){curr_template=template.substr(i);var regExp=/^{([^}]*)}/;var match_result=curr_template.match(regExp);if(match_result){var parsed=true;if(typeof name_value_map[match_result[1]]!='undefined'){parsed_str=name_value_map[match_result[1]];}else{parsed=false;}
if(!parsed){parsed_str=match_result[0];}
result+=parsed_str;i+=match_result[0].length;}}
if(!match_result){result+=template[i];i++;}}}
return result;}
function get_css_demension_exp(value){var result=null;if(value==null){result=null;}else{result=value+(isNaN(value)?"":"px");}
return result;}
function sort_obj(obj){var sorted_keys=new Array();var result={};for(var key in obj){sorted_keys.push(key);}
sorted_keys.sort();for(var i in sorted_keys){result[sorted_keys[i]]=obj[sorted_keys[i]];}
return result;}
function trim_array(arr){if(arr==null){return null;}
var result=[];$.each(arr,function(index,item){result.push($.trim(item));});return result;}
function get_g_emf_session_id(){return typeof g_emf_session_id=='undefined'?"":g_emf_session_id;}
function set_dropdown_value_supporting_option_deleted(select_obj,value){var is_value_in_options=false;select_obj.find('option').each(function(){if(value==this.value){is_value_in_options=true;return false;}});if(!is_value_in_options){select_obj.html(select_obj.html()+"<option value='"+value+"' my_property='deleted_option'>(OPTION DELETED)</option>");select_obj.change(function(){select_obj.toggleClass("select_with_deleted_option",select_obj.find('option:selected').attr('my_property')=='deleted_option');});}
select_obj.val(value).trigger('change');}
function count_words(str){str=$.trim(str);var len=0;if(!is_empty_str(str)){var parts=str.match(/\S+\s*/g);len=parts.length;}
return len;};var XD=function(){var interval_id,last_hash,cache_bust=1,attached_callback,window=this;return{postMessage:function(message,target_url,target){var match=target_url.match(new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi));if(!match){return;}target=target||parent;if(window['postMessage']){target['postMessage'](message,target_url.replace(/([^:]+:\/\/[^\/]+).*/,'$1'))}else if(target_url){target.location=target_url.replace(/#.*$/,'')+'#'+(+new Date)+(cache_bust++)+'&'+message}},receiveMessage:function(callback,source_origin){if(window['postMessage']){if(callback){attached_callback=function(e){if((typeof source_origin==='string'&&e.origin!==source_origin)||(Object.prototype.toString.call(source_origin)==="[object Function]"&&source_origin(e.origin)===!1)){return!1}callback(e)}}if(window['addEventListener']){window[callback?'addEventListener':'removeEventListener']('message',attached_callback,!1)}else{window[callback?'attachEvent':'detachEvent']('onmessage',attached_callback)}}else{interval_id&&clearInterval(interval_id);interval_id=null;if(callback){interval_id=setInterval(function(){var hash=document.location.hash,re=/^#?\d+&/;if(hash!==last_hash&&re.test(hash)){last_hash=hash;callback({data:hash.replace(re,'')})}},100)}}}}}();;(function($,document,window){var
defaults={transition:"elastic",speed:300,width:false,initialWidth:"600",innerWidth:false,maxWidth:false,height:false,initialHeight:"450",innerHeight:false,maxHeight:false,scalePhotos:true,scrolling:true,inline:false,html:false,iframe:false,fastIframe:true,photo:false,href:false,title:false,rel:false,opacity:0.9,preloading:true,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:false,returnFocus:true,loop:true,slideshow:false,slideshowAuto:true,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:false,onLoad:false,onComplete:false,onCleanup:false,onClosed:false,overlayClose:true,escKey:true,arrowKey:true,top:false,bottom:false,left:false,right:false,fixed:false,data:false},colorbox='colorbox',prefix='cbox',boxElement=prefix+'Element',event_open=prefix+'_open',event_load=prefix+'_load',event_complete=prefix+'_complete',event_cleanup=prefix+'_cleanup',event_closed=prefix+'_closed',event_purge=prefix+'_purge',isIE=$.browser.msie&&!$.support.opacity,isIE6=isIE&&$.browser.version<7,event_ie6=prefix+'_IE6',$overlay,$box,$wrap,$content,$topBorder,$leftBorder,$rightBorder,$bottomBorder,$related,$window,$loaded,$loadingBay,$loadingOverlay,$title,$current,$slideshow,$next,$prev,$close,$groupControls,settings,interfaceHeight,interfaceWidth,loadedHeight,loadedWidth,element,index,photo,open,active,closing,handler,loadingTimer,publicMethod;function $div(id,cssText,div){div=document.createElement('div');if(id){div.id=prefix+id;}
div.style.cssText=cssText||'';return $(div);}
function setSize(size,dimension){return Math.round((/%/.test(size)?((dimension==='x'?$window.width():$window.height())/100):1)*parseInt(size,10));}
function isImage(url){return settings.photo||/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i.test(url);}
function makeSettings(i){settings=$.extend({},$.data(element,colorbox));for(i in settings){if($.isFunction(settings[i])&&i.substring(0,2)!=='on'){settings[i]=settings[i].call(element);}}
settings.rel=settings.rel||element.rel||'nofollow';settings.href=settings.href||$(element).attr('href');settings.title=settings.title||element.title;if(typeof settings.href==="string"){settings.href=$.trim(settings.href);}}
function trigger(event,callback){if(callback){callback.call(element);}
$.event.trigger(event);}
function slideshow(){var
timeOut,className=prefix+"Slideshow_",click="click."+prefix,start,stop,clear;if(settings.slideshow&&$related[1]){start=function(){$slideshow.text(settings.slideshowStop).unbind(click).bind(event_complete,function(){if(index<$related.length-1||settings.loop){timeOut=setTimeout(publicMethod.next,settings.slideshowSpeed);}}).bind(event_load,function(){clearTimeout(timeOut);}).one(click+' '+event_cleanup,stop);$box.removeClass(className+"off").addClass(className+"on");timeOut=setTimeout(publicMethod.next,settings.slideshowSpeed);};stop=function(){clearTimeout(timeOut);$slideshow.text(settings.slideshowStart).unbind([event_complete,event_load,event_cleanup,click].join(' ')).one(click,start);$box.removeClass(className+"on").addClass(className+"off");};if(settings.slideshowAuto){start();}else{stop();}}else{$box.removeClass(className+"off "+className+"on");}}
function launch(target){if(!closing){element=target;makeSettings();$related=$(element);index=0;if(settings.rel!=='nofollow'){$related=$('.'+boxElement).filter(function(){var relRelated=$.data(this,colorbox).rel||this.rel;return(relRelated===settings.rel);});index=$related.index(element);if(index===-1){$related=$related.add(element);index=$related.length-1;}}
if(!open){open=active=true;$box.show();if(settings.returnFocus){try{element.blur();$(element).one(event_closed,function(){try{this.focus();}catch(e){}});}catch(e){}}
$overlay.css({"opacity":+settings.opacity,"cursor":settings.overlayClose?"pointer":"auto"}).show();settings.w=setSize(settings.initialWidth,'x');settings.h=setSize(settings.initialHeight,'y');publicMethod.position();if(isIE6){$window.bind('resize.'+event_ie6+' scroll.'+event_ie6,function(){$overlay.css({width:$window.width(),height:$window.height(),top:$window.scrollTop(),left:$window.scrollLeft()});}).trigger('resize.'+event_ie6);}
trigger(event_open,settings.onOpen);$groupControls.add($title).hide();$close.html(settings.close).show();}
publicMethod.load(true);}}
publicMethod=$.fn[colorbox]=$[colorbox]=function(options,callback){var $this=this;options=options||{};if(!$this[0]){if($this.selector){return $this;}
$this=$('<a/>');options.open=true;}
if(callback){options.onComplete=callback;}
$this.each(function(){$.data(this,colorbox,$.extend({},$.data(this,colorbox)||defaults,options));$(this).addClass(boxElement);});if(($.isFunction(options.open)&&options.open.call($this))||options.open){launch($this[0]);}
return $this;};publicMethod.init=function(){$window=$(window);$box=$div().attr({id:colorbox,'class':isIE?prefix+(isIE6?'IE6':'IE'):''});$overlay=$div("Overlay",isIE6?'position:absolute':'').hide();$wrap=$div("Wrapper");$content=$div("Content").append($loaded=$div("LoadedContent",'width:0; height:0; overflow:hidden'),$loadingOverlay=$div("LoadingOverlay").add($div("LoadingGraphic")),$title=$div("Title"),$current=$div("Current"),$next=$div("Next"),$prev=$div("Previous"),$slideshow=$div("Slideshow").bind(event_open,slideshow),$close=$div("Close"));$wrap.append($div().append($div("TopLeft"),$topBorder=$div("TopCenter"),$div("TopRight")),$div(false,'clear:left').append($leftBorder=$div("MiddleLeft"),$content,$rightBorder=$div("MiddleRight")),$div(false,'clear:left').append($div("BottomLeft"),$bottomBorder=$div("BottomCenter"),$div("BottomRight"))).children().children().css({'float':'left'});$loadingBay=$div(false,'position:absolute; width:9999px; visibility:hidden; display:none');$('body').prepend($overlay,$box.append($wrap,$loadingBay));$content.children().hover(function(){$(this).addClass('hover');},function(){$(this).removeClass('hover');}).addClass('hover');interfaceHeight=$topBorder.height()+$bottomBorder.height()+$content.outerHeight(true)-$content.height();interfaceWidth=$leftBorder.width()+$rightBorder.width()+$content.outerWidth(true)-$content.width();loadedHeight=$loaded.outerHeight(true);loadedWidth=$loaded.outerWidth(true);$box.css({"padding-bottom":interfaceHeight,"padding-right":interfaceWidth}).hide();$next.click(function(){publicMethod.next();});$prev.click(function(){publicMethod.prev();});$close.click(function(){publicMethod.close();});$groupControls=$next.add($prev).add($current).add($slideshow);$content.children().removeClass('hover');$overlay.click(function(){if(settings.overlayClose){publicMethod.close();}});$(document).bind('keydown.'+prefix,function(e){var key=e.keyCode;if(open&&settings.escKey&&key===27){e.preventDefault();publicMethod.close();}
if(open&&settings.arrowKey&&$related[1]){if(key===37){e.preventDefault();$prev.click();}else if(key===39){e.preventDefault();$next.click();}}});};publicMethod.remove=function(){$box.add($overlay).remove();$('.'+boxElement).removeData(colorbox).removeClass(boxElement);};publicMethod.position=function(speed,loadedCallback){var top=0,left=0;$window.unbind('resize.'+prefix);$box.hide();if(settings.fixed&&!isIE6){$box.css({position:'fixed'});}else{top=$window.scrollTop();left=$window.scrollLeft();$box.css({position:'absolute'});}
if(settings.right!==false){left+=Math.max($window.width()-settings.w-loadedWidth-interfaceWidth-setSize(settings.right,'x'),0);}else if(settings.left!==false){left+=setSize(settings.left,'x');}else{left+=Math.round(Math.max($window.width()-settings.w-loadedWidth-interfaceWidth,0)/2);}
if(settings.bottom!==false){top+=Math.max(document.documentElement.clientHeight-settings.h-loadedHeight-interfaceHeight-setSize(settings.bottom,'y'),0);}else if(settings.top!==false){top+=setSize(settings.top,'y');}else{top+=Math.round(Math.max(document.documentElement.clientHeight-settings.h-loadedHeight-interfaceHeight,0)/2);}
$box.show();speed=($box.width()===settings.w+loadedWidth&&$box.height()===settings.h+loadedHeight)?0:speed||0;$wrap[0].style.width=$wrap[0].style.height="9999px";function modalDimensions(that){$topBorder[0].style.width=$bottomBorder[0].style.width=$content[0].style.width=that.style.width;$loadingOverlay[0].style.height=$loadingOverlay[1].style.height=$content[0].style.height=$leftBorder[0].style.height=$rightBorder[0].style.height=that.style.height;}
$box.dequeue().animate({width:settings.w+loadedWidth,height:settings.h+loadedHeight,top:top,left:left},{duration:speed,complete:function(){modalDimensions(this);active=false;$wrap[0].style.width=(settings.w+loadedWidth+interfaceWidth)+"px";$wrap[0].style.height=(settings.h+loadedHeight+interfaceHeight)+"px";if(loadedCallback){loadedCallback();}
setTimeout(function(){$window.bind('resize.'+prefix,publicMethod.position);},1);},step:function(){modalDimensions(this);}});};publicMethod.resize=function(options){if(open){options=options||{};if(options.width){settings.w=setSize(options.width,'x')-loadedWidth-interfaceWidth;}
if(options.innerWidth){settings.w=setSize(options.innerWidth,'x');}
$loaded.css({width:settings.w});if(options.height){settings.h=setSize(options.height,'y')-loadedHeight-interfaceHeight;}
if(options.innerHeight){settings.h=setSize(options.innerHeight,'y');}
if(!options.innerHeight&&!options.height){var $child=$loaded.wrapInner("<div style='overflow:auto'></div>").children();settings.h=$child.height();$child.replaceWith($child.children());}
$loaded.css({height:settings.h});publicMethod.position(settings.transition==="none"?0:settings.speed);}};publicMethod.prep=function(object){if(!open){return;}
var callback,speed=settings.transition==="none"?0:settings.speed;$loaded.remove();$loaded=$div('LoadedContent').append(object);function getWidth(){settings.w=settings.w||$loaded.width();settings.w=settings.mw&&settings.mw<settings.w?settings.mw:settings.w;return settings.w;}
function getHeight(){settings.h=settings.h||$loaded.height();settings.h=settings.mh&&settings.mh<settings.h?settings.mh:settings.h;return settings.h;}
$loaded.hide().appendTo($loadingBay.show()).css({width:getWidth(),overflow:settings.scrolling?'auto':'hidden'}).css({height:getHeight()}).prependTo($content);$loadingBay.hide();$(photo).css({'float':'none'});if(isIE6){$('select').not($box.find('select')).filter(function(){return this.style.visibility!=='hidden';}).css({'visibility':'hidden'}).one(event_cleanup,function(){this.style.visibility='inherit';});}
callback=function(){var prev,prevSrc,next,nextSrc,total=$related.length,iframe,complete;if(!open){return;}
function removeFilter(){if(isIE){$box[0].style.removeAttribute('filter');}}
complete=function(){clearTimeout(loadingTimer);$loadingOverlay.hide();trigger(event_complete,settings.onComplete);};if(isIE){if(photo){$loaded.fadeIn(100);}}
$title.html(settings.title).add($loaded).show();if(total>1){if(typeof settings.current==="string"){$current.html(settings.current.replace('{current}',index+1).replace('{total}',total)).show();}
$next[(settings.loop||index<total-1)?"show":"hide"]().html(settings.next);$prev[(settings.loop||index)?"show":"hide"]().html(settings.previous);prev=index?$related[index-1]:$related[total-1];next=index<total-1?$related[index+1]:$related[0];if(settings.slideshow){$slideshow.show();}
if(settings.preloading){nextSrc=$.data(next,colorbox).href||next.href;prevSrc=$.data(prev,colorbox).href||prev.href;nextSrc=$.isFunction(nextSrc)?nextSrc.call(next):nextSrc;prevSrc=$.isFunction(prevSrc)?prevSrc.call(prev):prevSrc;if(isImage(nextSrc)){$('<img/>')[0].src=nextSrc;}
if(isImage(prevSrc)){$('<img/>')[0].src=prevSrc;}}}else{$groupControls.hide();}
if(settings.iframe){iframe=$('<iframe/>').addClass(prefix+'Iframe')[0];if(settings.fastIframe){complete();}else{$(iframe).one('load',complete);}
iframe.name=prefix+(+new Date());iframe.src=settings.href;if(!settings.scrolling){iframe.scrolling="no";}
if(isIE){iframe.frameBorder=0;iframe.allowTransparency="true";}
$(iframe).appendTo($loaded).one(event_purge,function(){iframe.src="//about:blank";});}else{complete();}
if(settings.transition==='fade'){$box.fadeTo(speed,1,removeFilter);}else{removeFilter();}};if(settings.transition==='fade'){$box.fadeTo(speed,0,function(){publicMethod.position(0,callback);});}else{publicMethod.position(speed,callback);}};publicMethod.load=function(launched){var href,setResize,prep=publicMethod.prep;active=true;photo=false;element=$related[index];if(!launched){makeSettings();}
trigger(event_purge);trigger(event_load,settings.onLoad);settings.h=settings.height?setSize(settings.height,'y')-loadedHeight-interfaceHeight:settings.innerHeight&&setSize(settings.innerHeight,'y');settings.w=settings.width?setSize(settings.width,'x')-loadedWidth-interfaceWidth:settings.innerWidth&&setSize(settings.innerWidth,'x');settings.mw=settings.w;settings.mh=settings.h;if(settings.maxWidth){settings.mw=setSize(settings.maxWidth,'x')-loadedWidth-interfaceWidth;settings.mw=settings.w&&settings.w<settings.mw?settings.w:settings.mw;}
if(settings.maxHeight){settings.mh=setSize(settings.maxHeight,'y')-loadedHeight-interfaceHeight;settings.mh=settings.h&&settings.h<settings.mh?settings.h:settings.mh;}
href=settings.href;loadingTimer=setTimeout(function(){$loadingOverlay.show();},100);if(settings.inline){$div().hide().insertBefore($(href)[0]).one(event_purge,function(){$(this).replaceWith($loaded.children());});prep($(href));}else if(settings.iframe){prep(" ");}else if(settings.html){prep(settings.html);}else if(isImage(href)){$(photo=new Image()).addClass(prefix+'Photo').error(function(){settings.title=false;prep($div('Error').text('This image could not be loaded'));}).load(function(){var percent;photo.onload=null;if(settings.scalePhotos){setResize=function(){photo.height-=photo.height*percent;photo.width-=photo.width*percent;};if(settings.mw&&photo.width>settings.mw){percent=(photo.width-settings.mw)/photo.width;setResize();}
if(settings.mh&&photo.height>settings.mh){percent=(photo.height-settings.mh)/photo.height;setResize();}}
if(settings.h){photo.style.marginTop=Math.max(settings.h-photo.height,0)/2+'px';}
if($related[1]&&(index<$related.length-1||settings.loop)){photo.style.cursor='pointer';photo.onclick=function(){publicMethod.next();};}
if(isIE){photo.style.msInterpolationMode='bicubic';}
setTimeout(function(){prep(photo);},1);});setTimeout(function(){photo.src=href;},1);}else if(href){$loadingBay.load(href,settings.data,function(data,status,xhr){prep(status==='error'?$div('Error').text('Request unsuccessful: '+xhr.statusText):$(this).contents());});}};publicMethod.next=function(){if(!active&&$related[1]&&(index<$related.length-1||settings.loop)){index=index<$related.length-1?index+1:0;publicMethod.load();}};publicMethod.prev=function(){if(!active&&$related[1]&&(index||settings.loop)){index=index?index-1:$related.length-1;publicMethod.load();}};publicMethod.close=function(){if(open&&!closing){closing=true;open=false;trigger(event_cleanup,settings.onCleanup);$window.unbind('.'+prefix+' .'+event_ie6);$overlay.fadeTo(200,0);$box.stop().fadeTo(300,0,function(){$box.add($overlay).css({'opacity':1,cursor:'auto'}).hide();trigger(event_purge);$loaded.remove();setTimeout(function(){closing=false;trigger(event_closed,settings.onClosed);},1);});}};publicMethod.element=function(){return $(element);};publicMethod.settings=defaults;handler=function(e){if(!((e.button!==0&&typeof e.button!=='undefined')||e.ctrlKey||e.shiftKey||e.altKey)){e.preventDefault();launch(this);}};if($.fn.delegate){$(document).delegate('.'+boxElement,'click',handler);}else{$('.'+boxElement).live('click',handler);}
$(publicMethod.init);}(jQuery,document,this));;(function(a){a.fn.stickyPanel=function(c){var c=a.extend({},a.fn.stickyPanel.defaults,c);return this.each(function(){a(window).bind("scroll.stickyPanel",{selected:a(this),options:c},b)})};function b(d){var i=d.data.selected;var g=d.data.options;var l=navigator.userAgent.toLowerCase().indexOf("mobile")>0;var c=a(window).height();var e=i.outerHeight(true);var h=a(document).scrollTop();if(!l&&h<=a(document).height()-c&&h>i.offset().top-g.topPadding){var k=0;if(g.topPadding!="undefined"){k=k+g.topPadding}var p=i.offset().left;i.data("PanelsTop",i.offset().top-k);if(g.savePanelSpace==true){var n=i.outerWidth(true);var f=i.css("float");var m=i.css("display");var j=Math.ceil(Math.random()*9999);i.data("PanelSpaceID","stickyPanelSpace"+j);i.before("<div id='"+i.data("PanelSpaceID")+"' style='width:"+n+"px;height:"+e+"px;float:"+f+";display:"+m+";'>&nbsp;</div>")}if(g.afterDetachCSSClass!=""){i.addClass(g.afterDetachCSSClass)}i.data("Original_Inline_CSS",(!i.attr("style")?"":i.attr("style")));i.css({margin:0,left:p,top:k,position:"fixed"})}if(h<=i.data("PanelsTop")&&i.css("top")!="auto"){if(g.savePanelSpace==true){a("#"+i.data("PanelSpaceID")).remove()}i.attr("style",i.data("Original_Inline_CSS"));if(g.afterDetachCSSClass!=""){i.removeClass(g.afterDetachCSSClass)}}}a.fn.stickyPanel.defaults={topPadding:0,afterDetachCSSClass:"",savePanelSpace:false}})(jQuery);;var JSON={copyright:"(c)2005 JSON.org",license:"http://www.crockford.com/JSON/license.html",stringify:function(v){var a=[];function e(s){a[a.length]=s;}
function g(x){var c,i,l,v;switch(typeof x){case"object":if(x){if(x instanceof Array){e("[");l=a.length;for(i=0;i<x.length;i+=1){v=x[i];if(typeof v!="undefined"&&typeof v!="function"){if(l<a.length){e(",");}
g(v);}}
e("]");return;}else{if(typeof x.toString!="undefined"){e("{");l=a.length;for(i in x){v=x[i];if(x.hasOwnProperty(i)&&typeof v!="undefined"&&typeof v!="function"){if(l<a.length){e(",");}
g(i);e(":");g(v);}}
return e("}");}}}
e("null");return;case"number":e(isFinite(x)?+x:"null");return;case"string":l=x.length;e("\"");for(i=0;i<l;i+=1){c=x.charAt(i);if(c>=" "){if(c=="\\"||c=="\""){e("\\");}
e(c);}else{switch(c){case"\b":e("\\b");break;case"\f":e("\\f");break;case"\n":e("\\n");break;case"\r":e("\\r");break;case"\t":e("\\t");break;default:c=c.charCodeAt();e("\\u00"+Math.floor(c/16).toString(16)
+(c%16).toString(16));}}}
e("\"");return;case"boolean":e(String(x));return;default:e("null");return;}}
g(v);return a.join("");},parse:function(_6){var p=/^\s*(([,:{}\[\]])|"(\\.|[^\x00-\x1f"\\])*"|-?\d+(\.\d*)?([eE][+-]?\d+)?|true|false|null)\s*/,token,operator;function error(m,t){throw{name:"JSONError",message:m,text:t||operator||token};}
function next(b){if(b&&b!=operator){error("Expected '"+b+"'");}
if(_6){var t=p.exec(_6);if(t){if(t[2]){token=null;operator=t[2];}else{operator=null;try{token=eval(t[1]);}catch(e){error("Bad token",t[1]);}}
_6=_6.substring(t[0].length);}else{error("Unrecognized token",_6);}}else{token=operator=undefined;}}
function val(){var k,o;switch(operator){case"{":next("{");o={};if(operator!="}"){for(;;){if(operator||typeof token!="string"){error("Missing key");}
k=token;next();next(":");o[k]=val();if(operator!=","){break;}
next(",");}}
next("}");return o;case"[":next("[");o=[];if(operator!="]"){for(;;){o.push(val());if(operator!=","){break;}
next(",");}}
next("]");return o;default:if(operator!==null){error("Missing value");}
k=token;next();return k;}}
next();return val();}};;;if(window.jQuery)(function($){if($.browser.msie)try{document.execCommand("BackgroundImageCache",false,true)}catch(e){};$.fn.rating=function(options){if(this.length==0)return this;if(typeof arguments[0]=='string'){if(this.length>1){var args=arguments;return this.each(function(){$.fn.rating.apply($(this),args);});};$.fn.rating[arguments[0]].apply(this,$.makeArray(arguments).slice(1)||[]);return this;};var options=$.extend({},$.fn.rating.options,options||{});$.fn.rating.calls++;this.not('.star-rating-applied').addClass('star-rating-applied').each(function(){var control,input=$(this);var eid=(this.name||'unnamed-rating').replace(/\[|\]/g,'_').replace(/^\_+|\_+$/g,'');var context=$(this.form||document.body);var raters=context.data('rating');if(!raters||raters.call!=$.fn.rating.calls)raters={count:0,call:$.fn.rating.calls};var rater=raters[eid];if(rater)control=rater.data('rating');if(rater&&control)
control.count++;else{control=$.extend({},options||{},($.metadata?input.metadata():($.meta?input.data():null))||{},{count:0,stars:[],inputs:[]});control.serial=raters.count++;rater=$('<span class="star-rating-control"/>');input.before(rater);rater.addClass('rating-to-be-drawn');if(input.attr('disabled')||input.hasClass('disabled'))control.readOnly=true;if(input.hasClass('required'))control.required=true;rater.append(control.cancel=$('<div class="rating-cancel"><a title="'+control.cancel+'">'+control.cancelValue+'</a></div>').mouseover(function(){$(this).rating('drain');$(this).addClass('star-rating-hover');}).mouseout(function(){$(this).rating('draw');$(this).removeClass('star-rating-hover');}).click(function(){$(this).rating('select');}).data('rating',control));};var star=$('<div class="star-rating rater-'+control.serial+'"><a title="'+(this.title||this.value)+'">'+this.value+'</a></div>');rater.append(star);if(this.id)star.attr('id',this.id);if(this.className)star.addClass(this.className);if(control.half)control.split=2;if(typeof control.split=='number'&&control.split>0){var stw=($.fn.width?star.width():0)||control.starWidth;var spi=(control.count%control.split),spw=Math.floor(stw/control.split);star.width(spw).find('a').css({'margin-left':'-'+(spi*spw)+'px'})};if(control.readOnly)
star.addClass('star-rating-readonly');else
star.addClass('star-rating-live').mouseover(function(){$(this).rating('fill');$(this).rating('focus');}).mouseout(function(){$(this).rating('draw');$(this).rating('blur');}).click(function(){$(this).rating('select');});if(this.checked)control.current=star;if(this.nodeName=="A"){if($(this).hasClass('selected'))
control.current=star;};input.hide();input.change(function(){});star.data('rating.input',input.data('rating.star',star));control.stars[control.stars.length]=star[0];control.inputs[control.inputs.length]=input[0];control.rater=raters[eid]=rater;control.context=context;input.data('rating',control);rater.data('rating',control);star.data('rating',control);context.data('rating',raters);});$('.rating-to-be-drawn').rating('draw').removeClass('rating-to-be-drawn');var input_name_map={};this.each(function(index,item){var name=$(item).attr('name');if(!input_name_map[name]){$(item).show().css('position','absolute').css('left',($('.star-rating-control:last').position().left+$('.star-rating-control:last').width()-16)+"px").css('opacity',0).css('z-index',-100);input_name_map[name]=true;}});return this;};$.extend($.fn.rating,{calls:0,focus:function(){var control=this.data('rating');if(!control)return this;if(!control.focus)return this;var input=$(this).data('rating.input')||$(this.tagName=='INPUT'?this:null);if(control.focus)control.focus.apply(input[0],[input.val(),$('a',input.data('rating.star'))[0]]);},blur:function(){var control=this.data('rating');if(!control)return this;if(!control.blur)return this;var input=$(this).data('rating.input')||$(this.tagName=='INPUT'?this:null);if(control.blur)control.blur.apply(input[0],[input.val(),$('a',input.data('rating.star'))[0]]);},fill:function(){var control=this.data('rating');if(!control)return this;if(control.readOnly)return;this.rating('drain');this.prevAll().andSelf().filter('.rater-'+control.serial).addClass('star-rating-hover');},drain:function(){var control=this.data('rating');if(!control)return this;if(control.readOnly)return;control.rater.children().filter('.rater-'+control.serial).removeClass('star-rating-on').removeClass('star-rating-hover');},draw:function(){var control=this.data('rating');if(!control)return this;this.rating('drain');if(control.current){control.current.data('rating.input').attr('checked','checked');control.current.prevAll().andSelf().filter('.rater-'+control.serial).addClass('star-rating-on');}
else
$(control.inputs).removeAttr('checked');control.cancel[control.readOnly||control.required?'hide':'show']();this.siblings()[control.readOnly?'addClass':'removeClass']('star-rating-readonly');},select:function(value,wantCallBack){var control=this.data('rating');if(!control)return this;if(control.readOnly)return;control.current=null;if(typeof value!='undefined'){if(typeof value=='number')
return $(control.stars[value]).rating('select',undefined,wantCallBack);if(typeof value=='string')
$.each(control.stars,function(){if($(this).data('rating.input').val()==value)$(this).rating('select',undefined,wantCallBack);});}
else
control.current=this[0].tagName=='INPUT'?this.data('rating.star'):(this.is('.rater-'+control.serial)?this:null);this.data('rating',control);this.rating('draw');var input=$(control.current?control.current.data('rating.input'):null);if((wantCallBack||wantCallBack==undefined)&&control.callback)control.callback.apply(input[0],[input.val(),$('a',control.current)[0]]);},readOnly:function(toggle,disable){var control=this.data('rating');if(!control)return this;control.readOnly=toggle||toggle==undefined?true:false;if(disable)$(control.inputs).attr("disabled","disabled");else $(control.inputs).removeAttr("disabled");this.data('rating',control);this.rating('draw');},disable:function(){this.rating('readOnly',true,true);},enable:function(){this.rating('readOnly',false,false);}});$.fn.rating.options={cancel:'Cancel Rating',cancelValue:'',split:0,starWidth:16};$(function(){});})(jQuery);;;(function(factory){if(typeof define==='function'&&define.amd){if(typeof jQuery!=='undefined'){define(['jquery'],factory);}else{define([],factory);}}else{if(typeof jQuery!=='undefined'){factory(jQuery);}else{factory();}}})(function($,undefined){var tag2attr={a:'href',img:'src',form:'action',base:'href',script:'src',iframe:'src',link:'href'},key=['source','protocol','authority','userInfo','user','password','host','port','relative','path','directory','file','query','fragment'],aliases={'anchor':'fragment'},parser={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},toString=Object.prototype.toString,isint=/^[0-9]+$/;function parseUri(url,strictMode){var str=decodeURI(url),res=parser[strictMode||false?'strict':'loose'].exec(str),uri={attr:{},param:{},seg:{}},i=14;while(i--){uri.attr[key[i]]=res[i]||'';}
uri.param['query']=parseString(uri.attr['query']);uri.param['fragment']=parseString(uri.attr['fragment']);uri.seg['path']=uri.attr.path.replace(/^\/+|\/+$/g,'').split('/');uri.seg['fragment']=uri.attr.fragment.replace(/^\/+|\/+$/g,'').split('/');uri.attr['base']=uri.attr.host?(uri.attr.protocol?uri.attr.protocol+'://'+uri.attr.host:uri.attr.host)+(uri.attr.port?':'+uri.attr.port:''):'';return uri;};function getAttrName(elm){var tn=elm.tagName;if(typeof tn!=='undefined')return tag2attr[tn.toLowerCase()];return tn;}
function promote(parent,key){if(parent[key].length==0)return parent[key]={};var t={};for(var i in parent[key])t[i]=parent[key][i];parent[key]=t;return t;}
function parse(parts,parent,key,val){var part=parts.shift();if(!part){if(isArray(parent[key])){parent[key].push(val);}else if('object'==typeof parent[key]){parent[key]=val;}else if('undefined'==typeof parent[key]){parent[key]=val;}else{parent[key]=[parent[key],val];}}else{var obj=parent[key]=parent[key]||[];if(']'==part){if(isArray(obj)){if(''!=val)obj.push(val);}else if('object'==typeof obj){obj[keys(obj).length]=val;}else{obj=parent[key]=[parent[key],val];}}else if(~part.indexOf(']')){part=part.substr(0,part.length-1);if(!isint.test(part)&&isArray(obj))obj=promote(parent,key);parse(parts,obj,part,val);}else{if(!isint.test(part)&&isArray(obj))obj=promote(parent,key);parse(parts,obj,part,val);}}}
function merge(parent,key,val){if(~key.indexOf(']')){var parts=key.split('['),len=parts.length,last=len-1;parse(parts,parent,'base',val);}else{if(!isint.test(key)&&isArray(parent.base)){var t={};for(var k in parent.base)t[k]=parent.base[k];parent.base=t;}
set(parent.base,key,val);}
return parent;}
function parseString(str){return reduce(String(str).split(/&|;/),function(ret,pair){try{pair=decodeURIComponent(pair.replace(/\+/g,' '));}catch(e){}
var eql=pair.indexOf('='),brace=lastBraceInKey(pair),key=pair.substr(0,brace||eql),val=pair.substr(brace||eql,pair.length),val=val.substr(val.indexOf('=')+1,val.length);if(''==key)key=pair,val='';return merge(ret,key,val);},{base:{}}).base;}
function set(obj,key,val){var v=obj[key];if(undefined===v){obj[key]=val;}else if(isArray(v)){v.push(val);}else{obj[key]=[v,val];}}
function lastBraceInKey(str){var len=str.length,brace,c;for(var i=0;i<len;++i){c=str[i];if(']'==c)brace=false;if('['==c)brace=true;if('='==c&&!brace)return i;}}
function reduce(obj,accumulator){var i=0,l=obj.length>>0,curr=arguments[2];while(i<l){if(i in obj)curr=accumulator.call(undefined,curr,obj[i],i,obj);++i;}
return curr;}
function isArray(vArg){return Object.prototype.toString.call(vArg)==="[object Array]";}
function keys(obj){var keys=[];for(prop in obj){if(obj.hasOwnProperty(prop))keys.push(prop);}
return keys;}
function purl(url,strictMode){if(arguments.length===1&&url===true){strictMode=true;url=undefined;}
strictMode=strictMode||false;url=url||window.location.toString();return{data:parseUri(url,strictMode),attr:function(attr){attr=aliases[attr]||attr;return typeof attr!=='undefined'?this.data.attr[attr]:this.data.attr;},param:function(param){return typeof param!=='undefined'?this.data.param.query[param]:this.data.param.query;},fparam:function(param){return typeof param!=='undefined'?this.data.param.fragment[param]:this.data.param.fragment;},segment:function(seg){if(typeof seg==='undefined'){return this.data.seg.path;}else{seg=seg<0?this.data.seg.path.length+seg:seg-1;return this.data.seg.path[seg];}},fsegment:function(seg){if(typeof seg==='undefined'){return this.data.seg.fragment;}else{seg=seg<0?this.data.seg.fragment.length+seg:seg-1;return this.data.seg.fragment[seg];}}};};if(typeof $!=='undefined'){$.fn.url=function(strictMode){var url='';if(this.length){url=$(this).attr(getAttrName(this[0]))||'';}
return purl(url,strictMode);};$.url=purl;}else{window.purl=purl;}});;(function($){$.fn.dPassword=function(options){var defaults={interval:200,duration:2000,replacement:'%u25CF',prefix:'_dPassword_generated_',debug:false}
var opts=$.extend(defaults,options);var checker=new Array();var timer=new Array();getId=function(id){var pattern=opts.prefix+'(.*)';var regex=new RegExp(pattern);regex.exec(id);id=RegExp.$1;return id;}
setPassword=function(id,str){if(opts.debug)console.log('setPassword: ['+id+']');var tmp='';for(i=0;i<str.length;i++){if(str.charAt(i)==unescape(opts.replacement)){tmp=tmp+$('#'+id).val().charAt(i);}
else{tmp=tmp+str.charAt(i);}}
$('#'+id).val(tmp);}
check=function(id,oldValue,initialCall){if(opts.debug)console.log('check: ['+id+']');var bullets=$('#'+opts.prefix+id).val();if(oldValue!=bullets){setPassword(id,bullets);if(bullets.length>1){var tmp='';for(i=0;i<bullets.length-1;i++){tmp=tmp+unescape(opts.replacement);}
tmp=tmp+bullets.charAt(bullets.length-1);$('#'+opts.prefix+id).val(tmp);}
else{}
if(initialCall){convertString(id);}else{clearTimeout(timer[id]);timer[id]=setTimeout("convertString('"+id+"')",opts.duration);}}
if(opts.debug){$('#debug_'+opts.prefix+id).text($('#'+id).val());}
if(!initialCall){checker[id]=setTimeout("check('"+id+"', '"+$('#'+opts.prefix+id).val()+"', false)",opts.interval);}}
convertString=function(id,keepLastChar){if(typeof keepLastChar=='undefined'){keepLastChar=false;}
var value=$('#'+opts.prefix+id).val();if(value!=''){var tmp='';for(i=0;i<value.length;i++){if(keepLastChar){if(i<value.length-1){tmp+=unescape(opts.replacement);}else{tmp+=value.charAt(i);}}else{tmp+=unescape(opts.replacement);}}
$('#'+opts.prefix+id).val(tmp);}}
$(this).each(function(){if(opts.debug)console.log('init ['+$(this).prop('id')+']');var name=$(this).prop('name');var id=$(this).prop('id');var self=this;if(is_empty_str(id)){alert('Element must have id property to use dPassword.');}
if(opts.debug){$(this).after('<span id="debug_'+opts.prefix+name+'" style="color: #f00;"></span>');}
var display_input=$("<input type='text'>").insertAfter($(this));var copy_attrs=['class','style','size','maxlength','disabled','tabindex','accesskey','value'];$.each(copy_attrs,function(index,item){display_input.attr(item,$(self).attr(item));})
display_input.attr('id',opts.prefix+id);display_input.removeAttr('name');var style_class=display_input.attr('class');if(!is_empty_str(style_class)){var parts=style_class.split(' ');var target_parts=[];$.each(parts,function(){if(this.indexOf('validate[')!=0){target_parts.push(this);}})
var target_style_class=target_parts.join(' ');display_input.attr('class',target_style_class);}
$(this).css('position','absolute').css('z-index',-1);$('label[for='+id+']').prop('for',opts.prefix+id);$(this).attr('tabindex','-1');$(this).removeAttr('accesskey');$('#'+opts.prefix+id).bind('focus',function(event){if(opts.debug)console.log('event: focus ['+getId($(this).prop('id'))+']');clearTimeout(checker[getId($(this).prop('id'))]);checker[getId($(this).prop('id'))]=setTimeout("check('"+getId($(this).prop('id'))+"', '')",opts.interval);});$('#'+opts.prefix+id).bind('blur',function(event){if(opts.debug)console.log('event: blur ['+getId($(this).prop('id'))+']');clearTimeout(checker[getId($(this).prop('id'))]);convertString(id);$(self).trigger('blur');}).bind('keyup',function(event){convertString(id,true);});check(id,'',true);});};})(jQuery);;window.ActiveXObject&&!window.CanvasRenderingContext2D&&function(){function D(a){return((a[C+"Options"]||{}).swfPath||K)+"flashcanvas.swf"}function s(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function i(a){throw new E(a);}function F(a){var b=parseInt(a.width,10),c=parseInt(a.height,10);if(isNaN(b)||0>b)b=300;if(isNaN(c)||0>c)c=150;a.width=b;a.height=c}var G=this.document,t="canvas",C="FlashCanvas",H="onreadystatechange",n;a:{n=this.document.getElementsByTagName("script");var I="",u=n.length;if(u)for(I=n[u-1].src||"";u;){script=n[u-1];if(script.src&&script.src.match("flashcanvas")){n=8<=G.documentMode?script.src:script.getAttribute("src",4);break a}u--}n=I}var K=n.replace(/[^\/]+$/,""),e=new function(a){for(var b=0,c=a.length;b<c;b++)this[a[b]]=b}("toDataURL save restore scale rotate translate transform setTransform globalAlpha globalCompositeOperation strokeStyle fillStyle createLinearGradient createRadialGradient createPattern lineWidth lineCap lineJoin miterLimit shadowOffsetX shadowOffsetY shadowBlur shadowColor clearRect fillRect strokeRect beginPath closePath moveTo lineTo quadraticCurveTo bezierCurveTo arcTo rect arc fill stroke clip isPointInPath font textAlign textBaseline fillText strokeText measureText drawImage createImageData getImageData putImageData addColorStop direction resize".split(" ")),v={},p={},q={},x={},y={},w=function(a,b){this.canvas=a;this._swf=b;this._canvasId=b.id.slice(8);this._initialize();this._gradientPatternId=0;this._font=this._direction="";var c=this;this._executeCommandIntervalID=setInterval(function(){for(var a=c.canvas,b=!1,a=a.parentNode;a&&!b;)b=a.body,a=a.parentNode;b?0===q[c._canvasId]&&c._executeCommand():clearInterval(c._executeCommandIntervalID)},30)};w.prototype={save:function(){this._setCompositing();this._setShadows();this._setStrokeStyle();this._setFillStyle();this._setLineStyles();this._setFontStyles();this._stateStack.push([this._globalAlpha,this._globalCompositeOperation,this._strokeStyle,this._fillStyle,this._lineWidth,this._lineCap,this._lineJoin,this._miterLimit,this._shadowOffsetX,this._shadowOffsetY,this._shadowBlur,this._shadowColor,this._font,this._textAlign,this._textBaseline]);this._queue.push(e.save)},restore:function(){var a=this._stateStack;a.length&&(a=a.pop(),this.globalAlpha=a[0],this.globalCompositeOperation=a[1],this.strokeStyle=a[2],this.fillStyle=a[3],this.lineWidth=a[4],this.lineCap=a[5],this.lineJoin=a[6],this.miterLimit=a[7],this.shadowOffsetX=a[8],this.shadowOffsetY=a[9],this.shadowBlur=a[10],this.shadowColor=a[11],this.font=a[12],this.textAlign=a[13],this.textBaseline=a[14]);this._queue.push(e.restore)},scale:function(a,b){this._queue.push(e.scale,a,b)},rotate:function(a){this._queue.push(e.rotate,a)},translate:function(a,b){this._queue.push(e.translate,a,b)},transform:function(a,b,c,d,f,g){this._queue.push(e.transform,a,b,c,d,f,g)},setTransform:function(a,b,c,d,f,g){this._queue.push(e.setTransform,a,b,c,d,f,g)},_setCompositing:function(){var a=this._queue;this._globalAlpha!==this.globalAlpha&&(this._globalAlpha=this.globalAlpha,a.push(e.globalAlpha,this._globalAlpha));this._globalCompositeOperation!==this.globalCompositeOperation&&(this._globalCompositeOperation=this.globalCompositeOperation,a.push(e.globalCompositeOperation,this._globalCompositeOperation))},_setStrokeStyle:function(){if(this._strokeStyle!==this.strokeStyle){var a=this._strokeStyle=this.strokeStyle;if("string"!==typeof a)if(a instanceof r||a instanceof z)a=a.id;else return;this._queue.push(e.strokeStyle,a)}},_setFillStyle:function(){if(this._fillStyle!==this.fillStyle){var a=this._fillStyle=this.fillStyle;if("string"!==typeof a)if(a instanceof r||a instanceof z)a=a.id;else return;this._queue.push(e.fillStyle,a)}},createLinearGradient:function(a,b,c,d){(!isFinite(a)||!isFinite(b)||!isFinite(c)||!isFinite(d))&&i(9);this._queue.push(e.createLinearGradient,a,b,c,d);return new r(this)},createRadialGradient:function(a,b,c,d,f,g){(!isFinite(a)||!isFinite(b)||!isFinite(c)||!isFinite(d)||!isFinite(f)||!isFinite(g))&&i(9);(0>c||0>g)&&i(1);this._queue.push(e.createRadialGradient,a,b,c,d,f,g);return new r(this)},createPattern:function(a,b){a||i(17);var c=a.tagName,d,f=this._canvasId;if(c)if(c=c.toLowerCase(),"img"===c)d=a.getAttribute("src",2);else{if(c===t||"video"===c)return;i(17)}else a.src?d=a.src:i(17);"repeat"===b||("no-repeat"===b||"repeat-x"===b||"repeat-y"===b||""===b||null===b)||i(12);this._queue.push(e.createPattern,s(d),b);!p[f][d]&&v[f]&&(this._executeCommand(),++q[f],p[f][d]=!0);return new z(this)},_setLineStyles:function(){var a=this._queue;this._lineWidth!==this.lineWidth&&(this._lineWidth=this.lineWidth,a.push(e.lineWidth,this._lineWidth));this._lineCap!==this.lineCap&&(this._lineCap=this.lineCap,a.push(e.lineCap,this._lineCap));this._lineJoin!==this.lineJoin&&(this._lineJoin=this.lineJoin,a.push(e.lineJoin,this._lineJoin));this._miterLimit!==this.miterLimit&&(this._miterLimit=this.miterLimit,a.push(e.miterLimit,this._miterLimit))},_setShadows:function(){var a=this._queue;this._shadowOffsetX!==this.shadowOffsetX&&(this._shadowOffsetX=this.shadowOffsetX,a.push(e.shadowOffsetX,this._shadowOffsetX));this._shadowOffsetY!==this.shadowOffsetY&&(this._shadowOffsetY=this.shadowOffsetY,a.push(e.shadowOffsetY,this._shadowOffsetY));this._shadowBlur!==this.shadowBlur&&(this._shadowBlur=this.shadowBlur,a.push(e.shadowBlur,this._shadowBlur));this._shadowColor!==this.shadowColor&&(this._shadowColor=this.shadowColor,a.push(e.shadowColor,this._shadowColor))},clearRect:function(a,b,c,d){this._queue.push(e.clearRect,a,b,c,d)},fillRect:function(a,b,c,d){this._setCompositing();this._setShadows();this._setFillStyle();this._queue.push(e.fillRect,a,b,c,d)},strokeRect:function(a,b,c,d){this._setCompositing();this._setShadows();this._setStrokeStyle();this._setLineStyles();this._queue.push(e.strokeRect,a,b,c,d)},beginPath:function(){this._queue.push(e.beginPath)},closePath:function(){this._queue.push(e.closePath)},moveTo:function(a,b){this._queue.push(e.moveTo,a,b)},lineTo:function(a,b){this._queue.push(e.lineTo,a,b)},quadraticCurveTo:function(a,b,c,d){this._queue.push(e.quadraticCurveTo,a,b,c,d)},bezierCurveTo:function(a,b,c,d,f,g){this._queue.push(e.bezierCurveTo,a,b,c,d,f,g)},arcTo:function(a,b,c,d,f){0>f&&isFinite(f)&&i(1);this._queue.push(e.arcTo,a,b,c,d,f)},rect:function(a,b,c,d){this._queue.push(e.rect,a,b,c,d)},arc:function(a,b,c,d,f,g){0>c&&isFinite(c)&&i(1);this._queue.push(e.arc,a,b,c,d,f,g?1:0)},fill:function(){this._setCompositing();this._setShadows();this._setFillStyle();this._queue.push(e.fill)},stroke:function(){this._setCompositing();this._setShadows();this._setStrokeStyle();this._setLineStyles();this._queue.push(e.stroke)},clip:function(){this._queue.push(e.clip)},isPointInPath:function(){},_setFontStyles:function(){var a=this._queue;if(this._font!==this.font)try{var b=y[this._canvasId];b.style.font=this._font=this.font;var c=b.currentStyle,d=[c.fontStyle,c.fontWeight,b.offsetHeight,c.fontFamily].join(" ");a.push(e.font,d)}catch(f){}this._textAlign!==this.textAlign&&(this._textAlign=this.textAlign,a.push(e.textAlign,this._textAlign));this._textBaseline!==this.textBaseline&&(this._textBaseline=this.textBaseline,a.push(e.textBaseline,this._textBaseline));this._direction!==this.canvas.currentStyle.direction&&(this._direction=this.canvas.currentStyle.direction,a.push(e.direction,this._direction))},fillText:function(a,b,c,d){this._setCompositing();this._setFillStyle();this._setShadows();this._setFontStyles();this._queue.push(e.fillText,s(a),b,c,void 0===d?Infinity:d)},strokeText:function(a,b,c,d){this._setCompositing();this._setStrokeStyle();this._setShadows();this._setFontStyles();this._queue.push(e.strokeText,s(a),b,c,void 0===d?Infinity:d)},measureText:function(a){var b=y[this._canvasId];try{b.style.font=this.font}catch(c){}b.innerText=a.replace(/[ \n\f\r]/g,"\t");return new L(b.offsetWidth)},drawImage:function(a,b,c,d,f,g,j,M,N){a||i(17);var h=a.tagName,k,l=arguments.length,A=this._canvasId;if(h)if(h=h.toLowerCase(),"img"===h)k=a.getAttribute("src",2);else{if(h===t||"video"===h)return;i(17)}else a.src?k=a.src:i(17);this._setCompositing();this._setShadows();k=s(k);if(3===l)this._queue.push(e.drawImage,l,k,b,c);else if(5===l)this._queue.push(e.drawImage,l,k,b,c,d,f);else if(9===l)(0===d||0===f)&&i(1),this._queue.push(e.drawImage,l,k,b,c,d,f,g,j,M,N);else return;!p[A][k]&&v[A]&&(this._executeCommand(),++q[A],p[A][k]=!0)},createImageData:function(){},getImageData:function(){},putImageData:function(){},loadImage:function(a,b,c){var d=a.tagName,f,g=this._canvasId;d?"img"===d.toLowerCase()&&(f=a.getAttribute("src",2)):a.src&&(f=a.src);if(f&&!p[g][f]){if(b||c)x[g][f]=[a,b,c];this._queue.push(e.drawImage,1,s(f));v[g]&&(this._executeCommand(),++q[g],p[g][f]=!0)}},_initialize:function(){this.globalAlpha=this._globalAlpha=1;this.globalCompositeOperation=this._globalCompositeOperation="source-over";this.fillStyle=this._fillStyle=this.strokeStyle=this._strokeStyle="#000000";this.lineWidth=this._lineWidth=1;this.lineCap=this._lineCap="butt";this.lineJoin=this._lineJoin="miter";this.miterLimit=this._miterLimit=10;this.shadowBlur=this._shadowBlur=this.shadowOffsetY=this._shadowOffsetY=this.shadowOffsetX=this._shadowOffsetX=0;this.shadowColor=this._shadowColor="rgba(0, 0, 0, 0.0)";this.font=this._font="10px sans-serif";this.textAlign=this._textAlign="start";this.textBaseline=this._textBaseline="alphabetic";this._queue=[];this._stateStack=[]},_flush:function(){var a=this._queue;this._queue=[];return a},_executeCommand:function(){var a=this._flush();if(0<a.length)try{return eval(this._swf.CallFunction('<invoke name="executeCommand" returntype="javascript"><arguments><string>'+a.join("&#0;")+"</string></arguments></invoke>"))}catch(b){}},_resize:function(a,b){this._executeCommand();this._initialize();0<a&&(this._swf.width=a);0<b&&(this._swf.height=b);this._queue.push(e.resize,a,b)}};var r=function(a){this._ctx=a;this.id=a._gradientPatternId++};r.prototype={addColorStop:function(a,b){(isNaN(a)||0>a||1<a)&&i(1);this._ctx._queue.push(e.addColorStop,this.id,a,b)}};var z=function(a){this.id=a._gradientPatternId++},L=function(a){this.width=a},E=function(a){this.code=a;this.message={1:"INDEX_SIZE_ERR",9:"NOT_SUPPORTED_ERR",11:"INVALID_STATE_ERR",12:"SYNTAX_ERR",17:"TYPE_MISMATCH_ERR",18:"SECURITY_ERR"}[a]};E.prototype=Error();var J="initElement",m={registeredEvents:{},canvases:{},initWindow:function(a){function b(){if("complete"===a.document.readyState){a.document.detachEvent(H,b);for(var c=a.document.getElementsByTagName(t),d=0,e=c.length;d<e;++d)m[J](c[d])}}var c=a.document;c.createElement(t);c.createStyleSheet().cssText=t+"{display:inline-block;overflow:hidden;width:300px;height:150px}";var d=this.canvases,e=this.registeredEvents,g=function(){a.detachEvent("onunload",g);var b,c,h,k,l,j,B;for(B in d)if(b=d[B],c=b.firstChild,k=b.ownerDocument.defaultView?b.ownerDocument.defaultView:b.ownerDocument.parentWindow,a===k){for(h in c)"function"===typeof c[h]&&(c[h]=null);for(h in b)"function"===typeof b[h]&&(b[h]=null);k=0;for(l=e[B].length;k!==l;k++)j=e[B][k],c.detachEvent(j[0],j[1]),b.detachEvent(j[0],j[1])}a.CanvasRenderingContext2D=null;a.CanvasGradient=null;a.CanvasPattern=null;a[C]=null};a.attachEvent("onunload",g);a.CanvasRenderingContext2D=w;a.CanvasGradient=r;a.CanvasPattern=z;a[C]=m;var j=D(a);0===j.indexOf(a.location.protocol+"//"+a.location.host+"/")&&a.setTimeout(function(){var a=new ActiveXObject("Microsoft.XMLHTTP");a.open("GET",j,!1);a.send(null)},0);"complete"===a.document.readyState?b():a.document.attachEvent(H,b)}};m[J]=function(a){if(a.getContext)return a;var b=a.ownerDocument,c=b.defaultView?b.defaultView:b.parentWindow;c.CanvasRenderingContext2D||this.initWindow(c);var d=Math.random().toString(36).slice(2)||"0",f="external"+d;v[d]=!1;p[d]={};q[d]=1;x[d]={};this.registeredEvents[d]=[];F(a);var g=D(c);a.innerHTML='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+("https:"===c.location.protocol?"https:":"http:")+'//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="100%" height="100%" id="'+
f+'"><param name="allowScriptAccess" value="always"><param name="flashvars" value="id='+f+'"><param name="wmode" value="transparent"></object><span style="margin:0;padding:0;border:0;display:inline-block;position:static;height:1em;overflow:visible;white-space:nowrap"></span>';this.canvases[d]=a;var j=a.firstChild;y[d]=a.lastChild;var i=b.body.contains;if(i(a))j.movie=g;else var m=c.setInterval(function(){i(a)&&(c.clearInterval(m),j.movie=g)},2);if("BackCompat"===b.compatMode||!c.XMLHttpRequest)y[d].style.overflow="hidden";var h=new w(a,j);a.getContext=function(a){return"2d"===a?h:null};a.toDataURL=function(a,b){"image/jpeg"===(""+a).toLowerCase()?h._queue.push(e.toDataURL,a,"number"===typeof b?b:""):h._queue.push(e.toDataURL,a);return h._executeCommand()};b=function(a){var a=a?a.srcElement:c.event.srcElement,b=a.parentNode;a.blur();b.focus()};this.registeredEvents[d].push(["onfocus",b]);j.attachEvent("onfocus",b);return a};m.saveImage=function(a){a.firstChild.saveImage()};m.setOptions=function(){};m.trigger=function(a,b){this.canvases[a].fireEvent("on"+b)};m.unlock=function(a,b,c){try{var d,e,g,j,i,m,h,k,l;if(void 0===b)d=this.canvases[a],e=d.firstChild,k=d.ownerDocument,l=k.defaultView?k.defaultView:k.parentWindow,F(d),g=d.width,j=d.height,d.style.width=g+"px",d.style.height=j+"px",0<g&&(e.width=g),0<j&&(e.height=j),e.resize(g,j),b=function(a){var a=a?a:l.event,b=a.propertyName;if("width"===b||"height"===b){var a=a.srcElement,c=a[b],d=parseInt(c,10);if(isNaN(d)||0>d)d="width"===b?300:150;c===d?(a.style[b]=d+"px",a.getContext("2d")._resize(a.width,a.height)):a[b]=d}},this.registeredEvents[a].push(["onpropertychange",b]),d.attachEvent("onpropertychange",b),v[a]=!0,"function"===typeof d.onload&&l.setTimeout(function(){d.onload()},0);else if(i=x[a][b])m=i[0],h=i[1+c],delete x[a][b],"function"===typeof h&&h.call(m);q[a]&&--q[a]}catch(n){throw console.log("Call to FlashCanvas.unlock had thrown an error: ",n.message),n;}};m.initWindow(this,G);keep=[w.measureText,w.loadImage]}.call(window);;window.onload=function(){prepopulating.init();};var prepopulating={urlResult:null,dataForFill:null,init:function(){this.getUrlParams();this.convertToObject(this.urlResult);if(this.dataForFill){this.fillFields(this.dataForFill);}},getUrlParams:function(){this.urlResult=window.location.search.substring(1);},convertToObject:function(url){if(url.length>0){var result={};var splitedUrl=url.split("&");jQuery.each(splitedUrl,function(ind,part){var item=part.split("=");result[item[0]]=decodeURIComponent(item[1]);});this.dataForFill=result;}},fillFields:function(data){var self=this;var tagName,el,elType;jQuery.each(data,function(index,val){el=jQuery('[name="'+index+'"]');tagName=self.getElementTagName(el);switch(tagName){case"INPUT":elType=self.getInputType(el);if(elType=="text"){var phoneReg=/^\d{3}-\d{3}-\d{4}$/;var priceReg=/^\d{1,15}\.\d{1,2}$/;if(phoneReg.test(val)){var phoneNumbArr=val.split('-');for(var i=0;i<el.length;i++){jQuery(el[i]).val(phoneNumbArr[i]);}}else if(priceReg.test(val)){var priceArr=val.split('.');for(var i=0;i<el.length;i++){jQuery(el[i]).val(priceArr[i]);}}else{el.val(val);}}else if(elType=="radio"){el.filter('[value="'+val+'"]').attr('checked','checked');}else if(elType=="checkbox"){var checked=val.split(",");if(checked.length>0){for(var i=0;i<checked.length;i++){el.filter('[value="'+checked[i]+'"]').attr('checked','checked');}}else{el.filter('[value="'+val+'"]').attr('checked','checked');}}else if(elType=="hidden"){el.val(val);}
break;case"SELECT":if(el.attr("multiple")){var multiChoiseVal=val.split(",");var len=multiChoiseVal.length;if(len>0){for(var i=0;i<len;i++){el.children('option').filter('[value="'+multiChoiseVal[i]+'"]').attr('selected',true);}}else{el.val(val);}}else{el.val(val).change();}
break;case"TEXTAREA":el.val(val);break;default:break;}});},getElementTagName:function(el){return el.prop('tagName');},getInputType:function(el){return el.attr('type');}};;(function(){var apinamespace='jSignature'
var KickTimerClass=function(time,callback){var timer;this.kick=function(){clearTimeout(timer);timer=setTimeout(callback,time);}
this.clear=function(){clearTimeout(timer);}
return this;}
var PubSubClass=function(context){'use strict'
this.topics={};this.context=context?context:this;this.publish=function(topic,arg1,arg2,etc){'use strict'
if(this.topics[topic]){var currentTopic=this.topics[topic],args=Array.prototype.slice.call(arguments,1),toremove=[],torun=[],fn,i,l,pair;for(i=0,l=currentTopic.length;i<l;i++){pair=currentTopic[i];fn=pair[0];if(pair[1]){pair[0]=function(){};toremove.push(i);}
torun.push(fn);}
for(i=0,l=toremove.length;i<l;i++){currentTopic.splice(toremove[i],1);}
for(i=0,l=torun.length;i<l;i++){torun[i].apply(this.context,args);}}}
this.subscribe=function(topic,callback,once){'use strict'
if(!this.topics[topic]){this.topics[topic]=[[callback,once]];}else{this.topics[topic].push([callback,once]);}
return{"topic":topic,"callback":callback};};this.unsubscribe=function(token){if(this.topics[token.topic]){var currentTopic=this.topics[token.topic];for(var i=0,l=currentTopic.length;i<l;i++){if(currentTopic[i]&&currentTopic[i][0]===token.callback){currentTopic.splice(i,1);}}}}}
function getColors($e){var tmp,undef,frontcolor=$e.css('color'),backcolor,e=$e[0];var toOfDOM=false;while(e&&!backcolor&&!toOfDOM){try{tmp=$(e).css('background-color');}catch(ex){tmp='transparent';}
if(tmp!=='transparent'&&tmp!=='rgba(0, 0, 0, 0)'){backcolor=tmp;}
toOfDOM=e.body;e=e.parentNode;}
var rgbaregex=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,hexregex=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,frontcolorcomponents;tmp=undef;tmp=frontcolor.match(rgbaregex);if(tmp){frontcolorcomponents={'r':parseInt(tmp[1],10),'g':parseInt(tmp[2],10),'b':parseInt(tmp[3],10)};}else{tmp=frontcolor.match(hexregex);if(tmp){frontcolorcomponents={'r':parseInt(tmp[1],16),'g':parseInt(tmp[2],16),'b':parseInt(tmp[3],16)};}}
var backcolorcomponents
if(!backcolor){if(frontcolorcomponents){if(Math.max.apply(null,[frontcolorcomponents.r,frontcolorcomponents.g,frontcolorcomponents.b])>127){backcolorcomponents={'r':0,'g':0,'b':0};}else{backcolorcomponents={'r':255,'g':255,'b':255};}}else{backcolorcomponents={'r':255,'g':255,'b':255};}}else{tmp=undef;tmp=backcolor.match(rgbaregex);if(tmp){backcolorcomponents={'r':parseInt(tmp[1],10),'g':parseInt(tmp[2],10),'b':parseInt(tmp[3],10)};}else{tmp=backcolor.match(hexregex);if(tmp){backcolorcomponents={'r':parseInt(tmp[1],16),'g':parseInt(tmp[2],16),'b':parseInt(tmp[3],16)};}}}
var toRGBfn=function(o){return'rgb('+[o.r,o.g,o.b].join(', ')+')'},decorcolorcomponents,frontcolorbrightness,adjusted;if(frontcolorcomponents&&backcolorcomponents){var backcolorbrightness=Math.max.apply(null,[frontcolorcomponents.r,frontcolorcomponents.g,frontcolorcomponents.b]);frontcolorbrightness=Math.max.apply(null,[backcolorcomponents.r,backcolorcomponents.g,backcolorcomponents.b]);adjusted=Math.round(frontcolorbrightness+(-1*(frontcolorbrightness-backcolorbrightness)*0.75));decorcolorcomponents={'r':adjusted,'g':adjusted,'b':adjusted};}else if(frontcolorcomponents){frontcolorbrightness=Math.max.apply(null,[frontcolorcomponents.r,frontcolorcomponents.g,frontcolorcomponents.b]);var polarity=+1;if(frontcolorbrightness>127){polarity=-1;}
adjusted=Math.round(frontcolorbrightness+(polarity*96));decorcolorcomponents={'r':adjusted,'g':adjusted,'b':adjusted};}else{decorcolorcomponents={'r':191,'g':191,'b':191};}
return{'color':frontcolor,'background-color':backcolorcomponents?toRGBfn(backcolorcomponents):backcolor,'decor-color':toRGBfn(decorcolorcomponents)};}
function Vector(x,y){this.x=x;this.y=y;this.reverse=function(){return new this.constructor(this.x*-1,this.y*-1);};this._length=null;this.getLength=function(){if(!this._length){this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));}
return this._length;};var polarity=function(e){return Math.round(e/Math.abs(e));};this.resizeTo=function(length){if(this.x===0&&this.y===0){this._length=0;}else if(this.x===0){this._length=length;this.y=length*polarity(this.y);}else if(this.y===0){this._length=length;this.x=length*polarity(this.x);}else{var proportion=Math.abs(this.y/this.x),x=Math.sqrt(Math.pow(length,2)/(1+Math.pow(proportion,2))),y=proportion*x;this._length=length;this.x=x*polarity(this.x);this.y=y*polarity(this.y);}
return this;};this.angleTo=function(vectorB){var divisor=this.getLength()*vectorB.getLength();if(divisor===0){return 0;}else{return Math.acos(Math.min(Math.max((this.x*vectorB.x+this.y*vectorB.y)/divisor,-1.0),1.0))/Math.PI;}};}
function Point(x,y){this.x=x;this.y=y;this.getVectorToCoordinates=function(x,y){return new Vector(x-this.x,y-this.y);};this.getVectorFromCoordinates=function(x,y){return this.getVectorToCoordinates(x,y).reverse();};this.getVectorToPoint=function(point){return new Vector(point.x-this.x,point.y-this.y);};this.getVectorFromPoint=function(point){return this.getVectorToPoint(point).reverse();};}
function DataEngine(storageObject,context,startStrokeFn,addToStrokeFn,endStrokeFn){this.data=storageObject;this.context=context;if(storageObject.length){var numofstrokes=storageObject.length,stroke,numofpoints;for(var i=0;i<numofstrokes;i++){stroke=storageObject[i];numofpoints=stroke.x.length;startStrokeFn.call(context,stroke);for(var j=1;j<numofpoints;j++){addToStrokeFn.call(context,stroke,j);}
endStrokeFn.call(context,stroke);}}
this.changed=function(){};this.startStrokeFn=startStrokeFn;this.addToStrokeFn=addToStrokeFn;this.endStrokeFn=endStrokeFn;this.inStroke=false;this._lastPoint=null;this._stroke=null;this.startStroke=function(point){if(point&&typeof(point.x)=="number"&&typeof(point.y)=="number"){this._stroke={'x':[point.x],'y':[point.y]};this.data.push(this._stroke);this._lastPoint=point;this.inStroke=true;var stroke=this._stroke,fn=this.startStrokeFn,context=this.context;setTimeout(function(){fn.call(context,stroke)},3);return point;}else{return null;}};this.addToStroke=function(point){if(this.inStroke&&typeof(point.x)==="number"&&typeof(point.y)==="number"&&(Math.abs(point.x-this._lastPoint.x)+Math.abs(point.y-this._lastPoint.y))>4){var positionInStroke=this._stroke.x.length;this._stroke.x.push(point.x);this._stroke.y.push(point.y);this._lastPoint=point;var stroke=this._stroke,fn=this.addToStrokeFn,context=this.context;setTimeout(function(){fn.call(context,stroke,positionInStroke)},3);return point;}else{return null;}};this.endStroke=function(){var c=this.inStroke;this.inStroke=false;this._lastPoint=null;if(c){var stroke=this._stroke,fn=this.endStrokeFn,context=this.context,changedfn=this.changed;setTimeout(function(){fn.call(context,stroke);changedfn.call(context);},3);return true;}else{return null;}};}
var basicDot=function(ctx,x,y,size){var fillStyle=ctx.fillStyle;ctx.fillStyle=ctx.strokeStyle;ctx.fillRect(x+size/-2,y+size/-2,size,size);ctx.fillStyle=fillStyle;},basicLine=function(ctx,startx,starty,endx,endy){ctx.beginPath();ctx.moveTo(startx,starty);ctx.lineTo(endx,endy);ctx.closePath();ctx.stroke();},basicCurve=function(ctx,startx,starty,endx,endy,cp1x,cp1y,cp2x,cp2y){ctx.beginPath();ctx.moveTo(startx,starty);ctx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,endx,endy);ctx.closePath();ctx.stroke();},strokeStartCallback=function(stroke){basicDot(this.canvasContext,stroke.x[0],stroke.y[0],this.settings.lineWidth);},strokeAddCallback=function(stroke,positionInStroke){var Cpoint=new Point(stroke.x[positionInStroke-1],stroke.y[positionInStroke-1]),Dpoint=new Point(stroke.x[positionInStroke],stroke.y[positionInStroke]),CDvector=Cpoint.getVectorToPoint(Dpoint);if(positionInStroke>1){var Bpoint=new Point(stroke.x[positionInStroke-2],stroke.y[positionInStroke-2]),BCvector=Bpoint.getVectorToPoint(Cpoint),ABvector;if(BCvector.getLength()>this.lineCurveThreshold){if(positionInStroke>2){ABvector=(new Point(stroke.x[positionInStroke-3],stroke.y[positionInStroke-3])).getVectorToPoint(Bpoint);}else{ABvector=new Vector(0,0);}
var minlenfraction=0.05,maxlen=BCvector.getLength()*0.35,ABCangle=BCvector.angleTo(ABvector.reverse()),BCDangle=CDvector.angleTo(BCvector.reverse()),BCP1vector=new Vector(ABvector.x+BCvector.x,ABvector.y+BCvector.y).resizeTo(Math.max(minlenfraction,ABCangle)*maxlen),CCP2vector=(new Vector(BCvector.x+CDvector.x,BCvector.y+CDvector.y)).reverse().resizeTo(Math.max(minlenfraction,BCDangle)*maxlen);basicCurve(this.canvasContext,Bpoint.x,Bpoint.y,Cpoint.x,Cpoint.y,Bpoint.x+BCP1vector.x,Bpoint.y+BCP1vector.y,Cpoint.x+CCP2vector.x,Cpoint.y+CCP2vector.y);}}
if(CDvector.getLength()<=this.lineCurveThreshold){basicLine(this.canvasContext,Cpoint.x,Cpoint.y,Dpoint.x,Dpoint.y);}},strokeEndCallback=function(stroke){var positionInStroke=stroke.x.length-1;if(positionInStroke>0){var Cpoint=new Point(stroke.x[positionInStroke],stroke.y[positionInStroke]),Bpoint=new Point(stroke.x[positionInStroke-1],stroke.y[positionInStroke-1]),BCvector=Bpoint.getVectorToPoint(Cpoint),ABvector;if(BCvector.getLength()>this.lineCurveThreshold){if(positionInStroke>1){ABvector=(new Point(stroke.x[positionInStroke-2],stroke.y[positionInStroke-2])).getVectorToPoint(Bpoint);var BCP1vector=new Vector(ABvector.x+BCvector.x,ABvector.y+BCvector.y).resizeTo(BCvector.getLength()/2);basicCurve(this.canvasContext,Bpoint.x,Bpoint.y,Cpoint.x,Cpoint.y,Bpoint.x+BCP1vector.x,Bpoint.y+BCP1vector.y,Cpoint.x,Cpoint.y);}else{basicLine(this.canvasContext,Bpoint.x,Bpoint.y,Cpoint.x,Cpoint.y);}}}}
function conditionallyLinkCanvasResizeToWindowResize(jSignatureInstance,settingsWidth,apinamespace,globalEvents){'use strict'
if(settingsWidth==='ratio'||settingsWidth.split('')[settingsWidth.length-1]==='%'){this.eventTokens[apinamespace+'.parentresized']=globalEvents.subscribe(apinamespace+'.parentresized',(function(eventTokens,$parent,originalParentWidth,sizeRatio){'use strict'
return function(){'use strict'
var w=$parent.width();if(w!==originalParentWidth){for(var key in eventTokens){if(eventTokens.hasOwnProperty(key)){globalEvents.unsubscribe(eventTokens[key]);delete eventTokens[key];}}
var settings=jSignatureInstance.settings;jSignatureInstance.$parent.children().remove();for(var key in jSignatureInstance){if(jSignatureInstance.hasOwnProperty(key)){delete jSignatureInstance[key];}}
settings.data=(function(data,scale){var newData=[];var o,i,l,j,m,stroke;for(i=0,l=data.length;i<l;i++){stroke=data[i];o={'x':[],'y':[]};for(j=0,m=stroke.x.length;j<m;j++){o.x.push(stroke.x[j]*scale);o.y.push(stroke.y[j]*scale);}
newData.push(o);}
return newData;})(settings.data,w*1.0/originalParentWidth)
$parent[apinamespace](settings);}}})(this.eventTokens,this.$parent,this.$parent.width(),this.canvas.width*1.0/this.canvas.height))}};function jSignatureClass(parent,options,instanceExtensions){var $parent=this.$parent=$(parent),eventTokens=this.eventTokens={},events=this.events=new PubSubClass(this),globalEvents=$.fn[apinamespace]('globalEvents'),settings={'width':'ratio','height':'ratio','sizeRatio':4,'color':'#000','background-color':'#fff','decor-color':'#eee','lineWidth':0,'minFatFingerCompensation':-10,'showUndoButton':false,'readOnly':false,'data':[],'signatureLine':false};$.extend(settings,getColors($parent));if(options){$.extend(settings,options);}
this.settings=settings;for(var extensionName in instanceExtensions){if(instanceExtensions.hasOwnProperty(extensionName)){instanceExtensions[extensionName].call(this,extensionName);}}
this.events.publish(apinamespace+'.initializing');this.$controlbarUpper=(function(){var controlbarstyle='padding:0 !important; margin:0 !important;'+'width: 100% !important; height: 0 !important; -ms-touch-action: none; touch-action: none;'+'margin-top:-1em !important; margin-bottom:1em !important;';return $('<div style="'+controlbarstyle+'"></div>').appendTo($parent);})();this.isCanvasEmulator=false;var canvas=this.canvas=this.initializeCanvas(settings),$canvas=$(canvas);this.$controlbarLower=(function(){var controlbarstyle='padding:0 !important; margin:0 !important;'+'width: 100% !important; height: 0 !important; -ms-touch-action: none; touch-action: none;'+'margin-top:-1.5em !important; margin-bottom:1.5em !important; position: relative;';return $('<div style="'+controlbarstyle+'"></div>').appendTo($parent);})();this.canvasContext=canvas.getContext("2d");$canvas.data(apinamespace+'.this',this);settings.lineWidth=(function(defaultLineWidth,canvasWidth){if(!defaultLineWidth){return Math.max(Math.round(canvasWidth/400),2);}else{return defaultLineWidth;}})(settings.lineWidth,canvas.width);this.lineCurveThreshold=settings.lineWidth*3;if(settings.cssclass&&$.trim(settings.cssclass)!=""){$canvas.addClass(settings.cssclass);}
this.fatFingerCompensation=0;var movementHandlers=(function(jSignatureInstance){var shiftX,shiftY,setStartValues=function(){var tos=$(jSignatureInstance.canvas).offset()
shiftX=tos.left*-1
shiftY=tos.top*-1},getPointFromEvent=function(e){var firstEvent=(e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e);return new Point(Math.round(firstEvent.pageX+shiftX),Math.round(firstEvent.pageY+shiftY)+jSignatureInstance.fatFingerCompensation);},timer=new KickTimerClass(750,function(){jSignatureInstance.dataEngine.endStroke();});this.drawEndHandler=function(e){if(!jSignatureInstance.settings.readOnly){try{e.preventDefault();}catch(ex){}
timer.clear();jSignatureInstance.dataEngine.endStroke();}};this.drawStartHandler=function(e){if(!jSignatureInstance.settings.readOnly){e.preventDefault();setStartValues();jSignatureInstance.dataEngine.startStroke(getPointFromEvent(e));timer.kick();}};this.drawMoveHandler=function(e){if(!jSignatureInstance.settings.readOnly){e.preventDefault();if(!jSignatureInstance.dataEngine.inStroke){return;}
jSignatureInstance.dataEngine.addToStroke(getPointFromEvent(e));timer.kick();}};return this;}).call({},this);(function(drawEndHandler,drawStartHandler,drawMoveHandler){var canvas=this.canvas,$canvas=$(canvas),undef;if(this.isCanvasEmulator){$canvas.bind('mousemove.'+apinamespace,drawMoveHandler);$canvas.bind('mouseup.'+apinamespace,drawEndHandler);$canvas.bind('mousedown.'+apinamespace,drawStartHandler);}else{canvas.ontouchstart=function(e){canvas.onmousedown=canvas.onmouseup=canvas.onmousemove=undef;this.fatFingerCompensation=(settings.minFatFingerCompensation&&settings.lineWidth*-3>settings.minFatFingerCompensation)?settings.lineWidth*-3:settings.minFatFingerCompensation;drawStartHandler(e);canvas.ontouchend=drawEndHandler;canvas.ontouchstart=drawStartHandler;canvas.ontouchmove=drawMoveHandler;};canvas.onmousedown=function(e){canvas.ontouchstart=canvas.ontouchend=canvas.ontouchmove=undef;drawStartHandler(e);canvas.onmousedown=drawStartHandler;canvas.onmouseup=drawEndHandler;canvas.onmousemove=drawMoveHandler;}
if(window.navigator.msPointerEnabled){canvas.onmspointerdown=drawStartHandler;canvas.onmspointerup=drawEndHandler;canvas.onmspointermove=drawMoveHandler;}}}).call(this,movementHandlers.drawEndHandler,movementHandlers.drawStartHandler,movementHandlers.drawMoveHandler)
eventTokens[apinamespace+'.windowmouseup']=globalEvents.subscribe(apinamespace+'.windowmouseup',movementHandlers.drawEndHandler);this.events.publish(apinamespace+'.attachingEventHandlers');conditionallyLinkCanvasResizeToWindowResize.call(this,this,settings.width.toString(10),apinamespace,globalEvents);this.resetCanvas(settings.data);this.events.publish(apinamespace+'.initialized');return this;}
jSignatureClass.prototype.resetCanvas=function(data,dontClear){var canvas=this.canvas,settings=this.settings,ctx=this.canvasContext,isCanvasEmulator=this.isCanvasEmulator,cw=canvas.width,ch=canvas.height;if(!dontClear){ctx.clearRect(0,0,cw+30,ch+30);}
ctx.shadowColor=ctx.fillStyle=settings['background-color']
if(isCanvasEmulator){ctx.fillRect(0,0,cw+30,ch+30);}
ctx.lineWidth=Math.ceil(parseInt(settings.lineWidth,10));ctx.lineCap=ctx.lineJoin="round";if(settings.signatureLine){if(null!=settings['decor-color']){ctx.strokeStyle=settings['decor-color'];ctx.shadowOffsetX=0;ctx.shadowOffsetY=0;var lineoffset=Math.round(ch/5);basicLine(ctx,lineoffset*1.5,ch-lineoffset,cw-(lineoffset*1.5),ch-lineoffset);}
ctx.strokeStyle=settings.color;if(!isCanvasEmulator){ctx.shadowColor=ctx.strokeStyle;ctx.shadowOffsetX=ctx.lineWidth*0.5;ctx.shadowOffsetY=ctx.lineWidth*-0.6;ctx.shadowBlur=0;}}
if(!data){data=[];}
var dataEngine=this.dataEngine=new DataEngine(data,this,strokeStartCallback,strokeAddCallback,strokeEndCallback);settings.data=data;$(canvas).data(apinamespace+'.data',data).data(apinamespace+'.settings',settings);dataEngine.changed=(function(target,events,apinamespace){'use strict'
return function(){events.publish(apinamespace+'.change');target.trigger('change');}})(this.$parent,this.events,apinamespace);dataEngine.changed();return true;};function initializeCanvasEmulator(canvas){if(canvas.getContext){return false;}else{var window=canvas.ownerDocument.parentWindow;var FC=window.FlashCanvas?canvas.ownerDocument.parentWindow.FlashCanvas:(typeof FlashCanvas==="undefined"?undefined:FlashCanvas);if(FC){canvas=FC.initElement(canvas);var zoom=1;if(window&&window.screen&&window.screen.deviceXDPI&&window.screen.logicalXDPI){zoom=window.screen.deviceXDPI*1.0/window.screen.logicalXDPI;}
if(zoom!==1){try{$(canvas).children('object').get(0).resize(Math.ceil(canvas.width*zoom),Math.ceil(canvas.height*zoom));canvas.getContext('2d').scale(zoom,zoom);}catch(ex){}}
return true;}else{throw new Error("Canvas element does not support 2d context. jSignature cannot proceed.");}}}
jSignatureClass.prototype.initializeCanvas=function(settings){var canvas=document.createElement('canvas'),$canvas=$(canvas);if(settings.width===settings.height&&settings.height==='ratio'){settings.width='100%';}
$canvas.css('margin',0).css('padding',0).css('border','none').css('height',settings.height==='ratio'||!settings.height?1:settings.height.toString(10)).css('width',settings.width==='ratio'||!settings.width?1:settings.width.toString(10)).css('-ms-touch-action','none').css('touch-action','none').css('background-color',settings['background-color']);$canvas.appendTo(this.$parent);if(settings.height==='ratio'){$canvas.css('height',Math.round($canvas.width()/settings.sizeRatio));}else if(settings.width==='ratio'){$canvas.css('width',Math.round($canvas.height()*settings.sizeRatio));}
$canvas.addClass(apinamespace);canvas.width=$canvas.width();canvas.height=$canvas.height();this.isCanvasEmulator=initializeCanvasEmulator(canvas);canvas.onselectstart=function(e){if(e&&e.preventDefault){e.preventDefault()};if(e&&e.stopPropagation){e.stopPropagation()};return false;};return canvas;}
var GlobalJSignatureObjectInitializer=function(window){var globalEvents=new PubSubClass();;(function(globalEvents,apinamespace,$,window){'use strict'
var resizetimer,runner=function(){globalEvents.publish(apinamespace+'.parentresized')};$(window).bind('resize.'+apinamespace,function(){if(resizetimer){clearTimeout(resizetimer);}
resizetimer=setTimeout(runner,500);}).bind('mouseup.'+apinamespace,function(e){globalEvents.publish(apinamespace+'.windowmouseup')});})(globalEvents,apinamespace,$,window)
var jSignatureInstanceExtensions={};var exportplugins={'default':function(data){return this.toDataURL()},'native':function(data){return data},'image':function(data){var imagestring=this.toDataURL();if(typeof imagestring==='string'&&imagestring.length>4&&imagestring.slice(0,5)==='data:'&&imagestring.indexOf(',')!==-1){var splitterpos=imagestring.indexOf(',');return[imagestring.slice(5,splitterpos),imagestring.substr(splitterpos+1)];}
return[];}};function _renderImageOnCanvas(data,formattype,rerendercallable){'use strict'
var img=new Image(),c=this;img.onload=function(){var ctx=c.getContext("2d");var oldShadowColor=ctx.shadowColor;ctx.shadowColor="transparent";ctx.drawImage(img,0,0,(img.width<c.width)?img.width:c.width,(img.height<c.height)?img.height:c.height);ctx.shadowColor=oldShadowColor;};img.src='data:'+formattype+','+data;}
var importplugins={'native':function(data,formattype,rerendercallable){rerendercallable(data);},'image':_renderImageOnCanvas,'image/png;base64':_renderImageOnCanvas,'image/jpeg;base64':_renderImageOnCanvas,'image/jpg;base64':_renderImageOnCanvas};function _clearDrawingArea(data,dontClear){this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace)).data(apinamespace+'.this').resetCanvas(data,dontClear);return this;}
function _setDrawingData(data,formattype){var undef;if(formattype===undef&&typeof data==='string'&&data.substr(0,5)==='data:'){formattype=data.slice(5).split(',')[0];data=data.slice(6+formattype.length);if(formattype===data){return;}}
var $canvas=this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace));if(!importplugins.hasOwnProperty(formattype)){throw new Error(apinamespace+" is unable to find import plugin with for format '"+String(formattype)+"'");}else if($canvas.length!==0){importplugins[formattype].call($canvas[0],data,formattype,(function(jSignatureInstance){return function(){return jSignatureInstance.resetCanvas.apply(jSignatureInstance,arguments)}})($canvas.data(apinamespace+'.this')));}
return this;}
var elementIsOrphan=function(e){var topOfDOM=false;e=e.parentNode;while(e&&!topOfDOM){topOfDOM=e.body;e=e.parentNode;}
return!topOfDOM;}
var plugins={'export':exportplugins,'import':importplugins,'instance':jSignatureInstanceExtensions},methods={'init':function(options){return this.each(function(){if(!elementIsOrphan(this)){new jSignatureClass(this,options,jSignatureInstanceExtensions);}})},'destroy':function(){return this.each(function(){if(!elementIsOrphan(this)){var sig=$(this).find('canvas').data(apinamespace+'.this');if(sig){sig.$controlbarLower.remove();sig.$controlbarUpper.remove();$(sig.canvas).remove();}}});},'getSettings':function(){return this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace)).data(apinamespace+'.this').settings;},'isModified':function(){return this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace)).data(apinamespace+'.this').dataEngine._stroke!==null;},'updateSetting':function(param,val,forFuture){var $canvas=this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace)).data(apinamespace+'.this');$canvas.settings[param]=val;$canvas.resetCanvas((forFuture?null:$canvas.settings.data),true);return $canvas.settings[param];},'clear':_clearDrawingArea,'reset':_clearDrawingArea,'addPlugin':function(pluginType,pluginName,callable){if(plugins.hasOwnProperty(pluginType)){plugins[pluginType][pluginName]=callable;}
return this;},'listPlugins':function(pluginType){var answer=[];if(plugins.hasOwnProperty(pluginType)){var o=plugins[pluginType];for(var k in o){if(o.hasOwnProperty(k)){answer.push(k);}}}
return answer;},'getData':function(formattype){var undef,$canvas=this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace));if(formattype===undef){formattype='default';}
if($canvas.length!==0&&exportplugins.hasOwnProperty(formattype)){return exportplugins[formattype].call($canvas.get(0),$canvas.data(apinamespace+'.data'),$canvas.data(apinamespace+'.settings'));}},'importData':_setDrawingData,'setData':_setDrawingData,'globalEvents':function(){return globalEvents},'disable':function(){this.find("input").attr("disabled",1);this.find('canvas.'+apinamespace).addClass("disabled").data(apinamespace+'.this').settings.readOnly=true;},'enable':function(){this.find("input").removeAttr("disabled");this.find('canvas.'+apinamespace).removeClass("disabled").data(apinamespace+'.this').settings.readOnly=false;},'events':function(){return this.find('canvas.'+apinamespace).add(this.filter('canvas.'+apinamespace)).data(apinamespace+'.this').events;}}
$.fn[apinamespace]=function(method){'use strict'
if(!method||typeof method==='object'){return methods.init.apply(this,arguments);}else if(typeof method==='string'&&methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else{$.error('Method '+String(method)+' does not exist on jQuery.'+apinamespace);}}}
GlobalJSignatureObjectInitializer(window)})();;var g_emf_resources={"js_currency_\u0e3f,Baht,Satang":"\u0e3f,Baht,Satang","js_currency_CHF,Francs,Rappen":"CHF,Francs,Rappen","js_currency_$,Dollars,Cents":"$,Dollars,Cents","js_currency_\u20ac,Euros,Cents":"\u20ac,Euros,Cents","js_currency_Ft,Forint,Filler":"Ft,Forint,Filler","js_currency_K\u010d,Koruna,Hal\u00e9\u0159\u016f":"K\u010d,Koruna,Hal\u00e9\u0159\u016f","js_currency_Kr,Krona,Ore":"Kr,Krona,Ore","js_currency_$,Pesos,Centavos":"$,Pesos,Centavos","js_currency_\u20b1,Pesos,Centavos":"\u20b1,Pesos,Centavos","js_currency_\u00a3,Pounds,Pence":"\u00a3,Pounds,Pence","js_currency_R,Rand,Cents":"R,Rand,Cents","js_currency_R$,Reais,Centavos":"R$,Reais,Centavos","js_currency_RM,Ringgit,Sen":"RM,Ringgit,Sen","js_currency_Rp,Rupiahs,Sen":"Rp,Rupiahs,Sen","js_currency_\u20aa,Shekel,Agora":"\u20aa,Shekel,Agora","js_currency_\u00a5,Yen":"\u00a5,Yen","js_currency_z\u0142,Z\u0142oty,Grosz":"z\u0142,Z\u0142oty,Grosz","js_validation_required":"This field is required","js_validation_required_select_multiple":"Please select an option","js_validation_required_checkbox":"This checkbox is required","js_validation_length_unit_character":"characters","js_validation_length_unit_word":"words","js_validation_length_range_min_max":"Must be between {min} and {max} {length_unit}, currently: {current}.","js_validation_length_range_min":"A minimum of {min} {length_unit} is allowed, currently: {current}.","js_validation_length_range_max":"A maximum of {max} {length_unit} is allowed, currently: {current}.","js_validation_number_range_min_max":"Must be between {min} and {max}.","js_validation_number_range_min":"A minimum of {min} is allowed.","js_validation_number_range_max":"A maximum of {max} is allowed.","js_validation_max_checkbox":"Please select up to {max} option(s)","js_validation_min_checkbox":"Please select at least {min} option(s)","js_validation_confirm":"Your field is not matching","js_validation_confirm2":"The password entered does not match. Please try again.","js_validation_confirm3":"The email does not match. Please try again.","js_validation_telephone":"Invalid phone number","js_validation_email":"Invalid email address","js_validation_url":"Invalid website address","js_validation_general_letter_number":"Only letters, numbers, underscores and dashes allowed","js_validation_date":"Invalid date, must be in YYYY-MM-DD format","js_validation_number_only":"Numbers only","js_validation_ext_number":"Numbers only","js_validation_number_with_sign":"Numbers and negative\/postive sign only","js_validation_number_percent_sign":"Numbers and percent sign only","js_validation_no_special_chars":"No special characters allowed","js_validation_no_special_chars_ex":"No special characters allowed","js_validation_letter_only":"Letters only","js_validation_captcha":"This captcha is wrong","js_validation_url_ex":"Invalid website address","js_validation_check_file_error":"File type invalid or file size is too large","js_validation_check_sum":"The values should add up to {target_sum}, currently: {current_sum}","js_validation_not_applicable":"N\/A","js_validation_ext_filename":"Invalid file type, \"{allowed_types}\" allowed.","js_validation_max_filesize":"File size is too large, maximum {max} allowed.","js_validation_ext_filename2":"The type of file \"{filename}\" is invalid, \"{allowed_types}\" allowed.","js_validation_max_filesize2":"The size of file \"{filename}\" is too large, maximum {max} allowed.","js_file_upload_delete":"Delete","js_file_upload_cancel":"Cancel","js_file_upload_close":"Close","js_score":"Score","js_calendar_close":"Close","js_calendar_prev":"Prev","js_calendar_next":"Next","js_calendar_current":"Today","js_calendar_month1":"January","js_calendar_month2":"February","js_calendar_month3":"March","js_calendar_month4":"April","js_calendar_month5":"May","js_calendar_month6":"June","js_calendar_month7":"July","js_calendar_month8":"August","js_calendar_month9":"September","js_calendar_month10":"October","js_calendar_month11":"November","js_calendar_month12":"December","js_calendar_month1_short":"Jan","js_calendar_month2_short":"Feb","js_calendar_month3_short":"Mar","js_calendar_month4_short":"Apr","js_calendar_month5_short":"May","js_calendar_month6_short":"Jun","js_calendar_month7_short":"July","js_calendar_month8_short":"Aug","js_calendar_month9_short":"Sep","js_calendar_month10_short":"Oct","js_calendar_month11_short":"Nov","js_calendar_month12_short":"Dec","js_calendar_weekday1":"Sunday","js_calendar_weekday2":"Monday","js_calendar_weekday3":"Tuesday","js_calendar_weekday4":"Wednesday","js_calendar_weekday5":"Thursday","js_calendar_weekday6":"Friday","js_calendar_weekday7":"Saturday","js_calendar_weekday1_short":"Sun","js_calendar_weekday2_short":"Mon","js_calendar_weekday3_short":"Tue","js_calendar_weekday4_short":"Wed","js_calendar_weekday5_short":"Thu","js_calendar_weekday6_short":"Fri","js_calendar_weekday7_short":"Sat","js_calendar_weekday1_min":"Su","js_calendar_weekday2_min":"Mo","js_calendar_weekday3_min":"Tu","js_calendar_weekday4_min":"We","js_calendar_weekday5_min":"Th","js_calendar_weekday6_min":"Fr","js_calendar_weekday7_min":"Sa","js_calendar_week":"Week","js_calendar_year":"Year"};
